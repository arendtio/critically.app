var M=(a,e,t)=>{if(!e.has(a))throw TypeError("Cannot "+t)};var c=(a,e,t)=>(M(a,e,"read from private field"),t?t.call(a):e.get(a)),h=(a,e,t)=>{if(e.has(a))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(a):e.set(a,t)},m=(a,e,t,s)=>(M(a,e,"write to private field"),s?s.call(a,t):e.set(a,t),t);var p=(a,e,t)=>(M(a,e,"access private method"),t);import{w as L}from"./index.2391f01a.js";var o,u,d,S,E,O,f,v,P,F,C,T;class R{constructor(){h(this,E);h(this,f);h(this,P);h(this,C);h(this,o,void 0);h(this,u,[]);h(this,d,[]);h(this,S,void 0);m(this,o,new Map),m(this,S,new Map)}addTask(e,t,s,i,r,l,n,N){s=y(s),i=y(i),r=y(r),l=l.split(",").map(g=>g.split("&").map(J=>J.trim())),n=n.split(",").map(g=>g.trim()).filter(g=>g!=="");let A=Math.round((s+i*4+r)/6),G={id:e,name:t,min:s,likely:i,max:r,res:l,resIdList:[],predecessors:new Set(n),successors:new Set,progress:N,earlyCol:0,es:0,ef:0,ls:0,lf:0,slack:-1,expected:A};c(this,o).set(e,G)}getTask(e){return c(this,o).get(e)}calc(){return p(this,E,O).call(this),p(this,P,F).call(this),p(this,C,T).call(this),{starts:c(this,u),map:Object.fromEntries(c(this,o)),ends:c(this,d)}}}o=new WeakMap,u=new WeakMap,d=new WeakMap,S=new WeakMap,E=new WeakSet,O=function(){c(this,o).forEach(e=>{e.predecessors.forEach(t=>{c(this,o).get(t).successors.add(e.id)})}),m(this,u,[...c(this,o).values()].filter(e=>e.predecessors.size===0).map(e=>e.id)),m(this,d,[...c(this,o).values()].filter(e=>e.successors.size===0).map(e=>e.id))},f=new WeakSet,v=function(e,t,s,i){if(s.has(e))return;s.add(e);let r=c(this,o).get(e);r[t].forEach(l=>{p(this,f,v).call(this,l,t,s,i)}),r=i(r),c(this,o).set(r.id,r)},P=new WeakSet,F=function(){let e=new Set;c(this,d).forEach(t=>{p(this,f,v).call(this,t,"predecessors",e,s=>{let i=[...s.predecessors].map(l=>c(this,o).get(l)).reduce((l,n)=>l<n.ef?n.ef:l,-1),r=[...s.predecessors].map(l=>c(this,o).get(l)).reduce((l,n)=>l<n.earlyCol?n.earlyCol:l,-1);return s.earlyCol=r+1,s.es=i+1,s.ef=s.es+s.expected-1,s})})},C=new WeakSet,T=function(){let e=Math.max(...c(this,d).map(s=>c(this,o).get(s).ef)),t=new Set;c(this,u).forEach(s=>{p(this,f,v).call(this,s,"successors",t,i=>{let r=[...i.predecessors].reduce((l,n)=>l>n.ls?n.ls:l,e);return i.lf=r-1,i.ls=i.lf-i.expected+1,i})})};const b=[["Id","Task","Min","Likely","Max","Resources","Predecessors","Progress"]],z=[["Date","Dev 1","Dev 2","Dev 3"]],D=L(b),x=L(z),w=L({}),j=L(void 0);function y(a,e){e===void 0&&(e=navigator.languages&&navigator.languages.length?navigator.languages[0]:navigator.language);let[,t,,,,s]=1111.1.toLocaleString(e);return a=Array.from(""+a,i=>i===t?"":i===s?".":i).join(""),parseFloat(a)}D.reset=()=>D.set(b);x.reset=()=>x.set(z);w.reset=()=>w.set({});j.reset=()=>j.set(void 0);w.calculate=function(){j.set(void 0);let a;D.update(r=>(a=r,r));let e=new R;a.slice(1).forEach(r=>{e.addTask(...r)}),console.log("Starting calculation");let t=e.calc(),s=new Map;for(var i in t.map)if(Object.prototype.hasOwnProperty.call(t.map,i)){let r=t.map[i];r.predecessors=[...r.predecessors],s.set(r.id,r)}t.map=Object.fromEntries(s),console.log("Finished calculation: ",JSON.stringify(t)),w.set(t)};export{w as c,j as d,y as l,x as r,D as t};
