import{s as st,f as R,a as oe,g as D,h as N,B as Ae,c as ae,d as b,j as u,i as me,r as m,v as J,w as Oe,x as He,y as Ee,z as fe,o as ot,l as at,m as it,n as ct,e as Me,u as Ne,p as dt,D as Se}from"./scheduler.427c93e9.js";import{e as we}from"./each.5e3737eb.js";import{S as ut,i as ft}from"./index.d4e4d1b7.js";import{g as ht,T as Ce}from"./tables.store.11ebb287.js";import{w as pe}from"./index.113f7b86.js";const gt=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;const{window:_t}=gt;function Fe(e,l,r){const s=e.slice();return s[67]=l[r],s[68]=l,s[69]=r,s}function Be(e,l,r){const s=e.slice();return s[70]=l[r],s}function qe(e,l,r){const s=e.slice();return s[67]=l[r],s[73]=l,s[74]=r,s}function Ue(e,l,r){const s=e.slice();return s[75]=l[r],s}function Ye(e){let l,r=e[75]+"",s;return{c(){l=R("th"),s=at(r)},l(i){l=D(i,"TH",{});var n=N(l);s=it(n,r),n.forEach(b)},m(i,n){me(i,l,n),m(l,s)},p(i,n){n[0]&4&&r!==(r=i[75]+"")&&ct(s,r)},d(i){i&&b(l)}}}function Xe(e){var ie,ge;let l,r,s,i,n,v,I,k,E,y,L,q,re,H;function T(w,S){return S[0]&4&&(i=null),i==null&&(i=!!w[22](w[70])),i?mt:pt}let Q=T(e,[-1,-1,-1]),W=Q(e);function Z(w,S){return w[7]?wt:vt}let x=Z(e),A=x(e),K=we(((ge=(ie=e[2])==null?void 0:ie.getRow)==null?void 0:ge.call(ie,e[70]))??[]),F=[];for(let w=0;w<K.length;w+=1)F[w]=Ke(qe(e,K,w));function te(){return e[53](e[70])}function ee(...w){return e[54](e[70],...w)}function he(...w){return e[55](e[70],...w)}return{c(){l=R("tr"),r=R("td"),s=R("div"),W.c(),n=oe(),v=R("td"),I=R("div"),A.c(),k=oe();for(let w=0;w<F.length;w+=1)F[w].c();E=oe(),y=R("td"),L=R("div"),q=R("span"),this.h()},l(w){l=D(w,"TR",{});var S=N(l);r=D(S,"TD",{class:!0});var G=N(r);s=D(G,"DIV",{class:!0});var ce=N(s);W.l(ce),ce.forEach(b),G.forEach(b),n=ae(S),v=D(S,"TD",{class:!0});var O=N(v);I=D(O,"DIV",{class:!0});var P=N(I);A.l(P),P.forEach(b),O.forEach(b),k=ae(S);for(let ne=0;ne<F.length;ne+=1)F[ne].l(S);E=ae(S),y=D(S,"TD",{class:!0});var ue=N(y);L=D(ue,"DIV",{class:!0});var U=N(L);q=D(U,"SPAN",{class:!0,role:!0,"aria-label":!0,title:!0}),N(q).forEach(b),U.forEach(b),ue.forEach(b),S.forEach(b),this.h()},h(){u(s,"class","hierarchy-controls svelte-1rmcdss"),u(r,"class","tree-column svelte-1rmcdss"),u(I,"class","hierarchy-controls svelte-1rmcdss"),u(v,"class","control-column svelte-1rmcdss"),u(q,"class","delete-button mif-cross-light svelte-1rmcdss"),u(q,"role","button"),u(q,"aria-label","Delete row"),u(q,"title","Delete row"),u(L,"class","hierarchy-controls svelte-1rmcdss"),u(y,"class","control-column svelte-1rmcdss")},m(w,S){me(w,l,S),m(l,r),m(r,s),W.m(s,null),m(l,n),m(l,v),m(v,I),A.m(I,null),m(l,k);for(let G=0;G<F.length;G+=1)F[G]&&F[G].m(l,null);m(l,E),m(l,y),m(y,L),m(L,q),re||(H=[J(q,"click",te),J(l,"dragover",ee),J(l,"keydown",he)],re=!0)},p(w,S){var G,ce;if(e=w,Q===(Q=T(e,S))&&W?W.p(e,S):(W.d(1),W=Q(e),W&&(W.c(),W.m(s,null))),x===(x=Z(e))&&A?A.p(e,S):(A.d(1),A=x(e),A&&(A.c(),A.m(I,null))),S[0]&2021654588|S[1]&25){K=we(((ce=(G=e[2])==null?void 0:G.getRow)==null?void 0:ce.call(G,e[70]))??[]);let O;for(O=0;O<K.length;O+=1){const P=qe(e,K,O);F[O]?F[O].p(P,S):(F[O]=Ke(P),F[O].c(),F[O].m(l,E))}for(;O<F.length;O+=1)F[O].d(1);F.length=K.length}},d(w){w&&b(l),W.d(),A.d(),He(F,w),re=!1,Ee(H)}}}function pt(e){let l;return{c(){l=R("span"),this.h()},l(r){l=D(r,"SPAN",{class:!0}),N(l).forEach(b),this.h()},h(){u(l,"class","hierarchy-spacer svelte-1rmcdss")},m(r,s){me(r,l,s)},p:Oe,d(r){r&&b(l)}}}function mt(e){let l,r,s,i,n,v,I;function k(){return e[43](e[70])}return{c(){l=R("span"),r=R("span"),this.h()},l(E){l=D(E,"SPAN",{class:!0,role:!0,"aria-label":!0,title:!0});var y=N(l);r=D(y,"SPAN",{class:!0}),N(r).forEach(b),y.forEach(b),this.h()},h(){u(r,"class",s=e[8][e[70]]?"mif-plus":"mif-minus"),u(l,"class","hierarchy-toggle svelte-1rmcdss"),u(l,"role","button"),u(l,"aria-label",i=e[8][e[70]]?"Expand":"Collapse"),u(l,"title",n=e[8][e[70]]?"Expand":"Collapse")},m(E,y){me(E,l,y),m(l,r),v||(I=J(l,"click",k),v=!0)},p(E,y){e=E,y[0]&260&&s!==(s=e[8][e[70]]?"mif-plus":"mif-minus")&&u(r,"class",s),y[0]&260&&i!==(i=e[8][e[70]]?"Expand":"Collapse")&&u(l,"aria-label",i),y[0]&260&&n!==(n=e[8][e[70]]?"Expand":"Collapse")&&u(l,"title",n)},d(E){E&&b(l),v=!1,I()}}}function vt(e){let l,r,s,i,n,v;function I(){return e[45](e[70])}function k(){return e[46](e[70])}return{c(){l=R("div"),r=R("span"),s=oe(),i=R("span"),this.h()},l(E){l=D(E,"DIV",{});var y=N(l);r=D(y,"SPAN",{class:!0,role:!0,"aria-label":!0,title:!0}),N(r).forEach(b),s=ae(y),i=D(y,"SPAN",{class:!0,role:!0,"aria-label":!0,title:!0}),N(i).forEach(b),y.forEach(b),this.h()},h(){u(r,"class","level-control mif-arrow-left svelte-1rmcdss"),u(r,"role","button"),u(r,"aria-label","Decrease indentation level"),u(r,"title","Decrease indentation level (Shift+Tab)"),u(i,"class","level-control mif-arrow-right svelte-1rmcdss"),u(i,"role","button"),u(i,"aria-label","Increase indentation level"),u(i,"title","Increase indentation level (Tab)")},m(E,y){me(E,l,y),m(l,r),m(l,s),m(l,i),n||(v=[J(r,"click",I),J(i,"click",k)],n=!0)},p(E,y){e=E},d(E){E&&b(l),n=!1,Ee(v)}}}function wt(e){let l,r,s;function i(...n){return e[44](e[70],...n)}return{c(){l=R("span"),this.h()},l(n){l=D(n,"SPAN",{class:!0,role:!0,"aria-label":!0,title:!0,draggable:!0}),N(l).forEach(b),this.h()},h(){u(l,"class","reorder-handle mif-unfold-more svelte-1rmcdss"),u(l,"role","button"),u(l,"aria-label","Drag to reorder"),u(l,"title","Drag to reorder"),u(l,"draggable",!0)},m(n,v){me(n,l,v),r||(s=[J(l,"dragstart",i),J(l,"dragend",e[40])],r=!0)},p(n,v){e=n},d(n){n&&b(l),r=!1,Ee(s)}}}function Ke(e){let l,r,s,i,n,v,I;function k(){e[47].call(r,e[73],e[74])}function E(){return e[48](e[70])}function y(...H){return e[49](e[70],e[74],...H)}function L(...H){return e[50](e[70],e[74],...H)}function q(...H){return e[51](e[70],e[74],...H)}function re(...H){return e[52](e[70],e[74],...H)}return{c(){l=R("td"),r=R("input"),s=oe(),this.h()},l(H){l=D(H,"TD",{class:!0,style:!0,"data-row-id":!0,"data-col-index":!0});var T=N(l);r=D(T,"INPUT",{type:!0,class:!0}),s=ae(T),T.forEach(b),this.h()},h(){u(r,"type","text"),u(r,"class","metro-input svelte-1rmcdss"),u(l,"class","data-cell svelte-1rmcdss"),u(l,"style",i=e[74]===0&&e[23](e[70])>0?`padding-left: ${e[23](e[70])*16}px;`:""),u(l,"data-row-id",n=e[70]),u(l,"data-col-index",e[74]),Se(l,"selected-cell",e[3]&&e[3].rowId===e[70]&&e[3].colIndex===e[74]),Se(l,"highlight",e[5]&&e[4]&&e[4].colIndex===e[74]&&e[30](e[70],e[74]))},m(H,T){me(H,l,T),m(l,r),Ne(r,e[67]),m(l,s),v||(I=[J(r,"input",k),J(r,"paste",e[31]),J(r,"blur",E),J(r,"keydown",y),J(l,"pointerdown",L),J(l,"click",q),J(l,"keydown",re)],v=!0)},p(H,T){e=H,T[0]&4&&r.value!==e[67]&&Ne(r,e[67]),T[0]&4&&i!==(i=e[74]===0&&e[23](e[70])>0?`padding-left: ${e[23](e[70])*16}px;`:"")&&u(l,"style",i),T[0]&4&&n!==(n=e[70])&&u(l,"data-row-id",n),T[0]&12&&Se(l,"selected-cell",e[3]&&e[3].rowId===e[70]&&e[3].colIndex===e[74]),T[0]&1073741876&&Se(l,"highlight",e[5]&&e[4]&&e[4].colIndex===e[74]&&e[30](e[70],e[74]))},d(H){H&&b(l),v=!1,Ee(I)}}}function Ve(e){let l=e[21](e[70]),r,s=l&&Xe(e);return{c(){s&&s.c(),r=Me()},l(i){s&&s.l(i),r=Me()},m(i,n){s&&s.m(i,n),me(i,r,n)},p(i,n){n[0]&4&&(l=i[21](i[70])),l?s?s.p(i,n):(s=Xe(i),s.c(),s.m(r.parentNode,r)):s&&(s.d(1),s=null)},d(i){i&&b(r),s&&s.d(i)}}}function Je(e){let l,r,s,i;function n(){e[56].call(r,e[68],e[69])}return{c(){l=R("td"),r=R("input"),this.h()},l(v){l=D(v,"TD",{class:!0});var I=N(l);r=D(I,"INPUT",{type:!0,class:!0}),I.forEach(b),this.h()},h(){u(r,"type","text"),u(r,"class","metro-input svelte-1rmcdss"),u(l,"class","svelte-1rmcdss")},m(v,I){me(v,l,I),m(l,r),Ne(r,e[67]),s||(i=[J(r,"input",n),J(r,"paste",e[31]),J(r,"blur",e[32])],s=!0)},p(v,I){e=v,I[0]&512&&r.value!==e[67]&&Ne(r,e[67])},d(v){v&&b(l),s=!1,Ee(i)}}}function bt(e){var Te,ke,be,Le;let l,r,s,i,n='<span class="hierarchy-toggle mif-tree svelte-1rmcdss" title="Hierarchy"></span>',v,I,k,E,y,L,q,re,H,T,Q='<span class="delete-button mif-bin svelte-1rmcdss" title="Delete row"></span>',W,Z,x,A,K,F='<div class="hierarchy-controls svelte-1rmcdss"><span class="hierarchy-spacer svelte-1rmcdss"></span></div>',te,ee,he='<div class="hierarchy-controls svelte-1rmcdss"><span class="mif-chevron-thin-right"></span></div>',ie,ge,w,S,G,ce,O=we(((ke=(Te=e[2])==null?void 0:Te.getHeader)==null?void 0:ke.call(Te))??[]),P=[];for(let h=0;h<O.length;h+=1)P[h]=Ye(Ue(e,O,h));let ue=we(((Le=(be=e[2])==null?void 0:be.getAllIds)==null?void 0:Le.call(be))??[]),U=[];for(let h=0;h<ue.length;h+=1)U[h]=Ve(Be(e,ue,h));let ne=we(e[9]),V=[];for(let h=0;h<ne.length;h+=1)V[h]=Je(Fe(e,ne,h));return{c(){l=R("table"),r=R("thead"),s=R("tr"),i=R("th"),i.innerHTML=n,v=oe(),I=R("th"),k=R("span"),E=R("span"),re=oe();for(let h=0;h<P.length;h+=1)P[h].c();H=oe(),T=R("th"),T.innerHTML=Q,W=oe(),Z=R("tbody");for(let h=0;h<U.length;h+=1)U[h].c();x=oe(),A=R("tr"),K=R("td"),K.innerHTML=F,te=oe(),ee=R("td"),ee.innerHTML=he,ie=oe();for(let h=0;h<V.length;h+=1)V[h].c();ge=oe(),w=R("td"),this.h()},l(h){l=D(h,"TABLE",{class:!0,id:!0});var Y=N(l);r=D(Y,"THEAD",{});var B=N(r);s=D(B,"TR",{});var le=N(s);i=D(le,"TH",{class:!0,"data-svelte-h":!0}),Ae(i)!=="svelte-1focd0m"&&(i.innerHTML=n),v=ae(le),I=D(le,"TH",{class:!0});var _e=N(I);k=D(_e,"SPAN",{class:!0,role:!0,"aria-label":!0,title:!0});var ye=N(k);E=D(ye,"SPAN",{class:!0}),N(E).forEach(b),ye.forEach(b),_e.forEach(b),re=ae(le);for(let se=0;se<P.length;se+=1)P[se].l(le);H=ae(le),T=D(le,"TH",{class:!0,"data-svelte-h":!0}),Ae(T)!=="svelte-89kh84"&&(T.innerHTML=Q),le.forEach(b),B.forEach(b),W=ae(Y),Z=D(Y,"TBODY",{});var p=N(Z);for(let se=0;se<U.length;se+=1)U[se].l(p);x=ae(p),A=D(p,"TR",{});var j=N(A);K=D(j,"TD",{class:!0,"data-svelte-h":!0}),Ae(K)!=="svelte-1r09gtc"&&(K.innerHTML=F),te=ae(j),ee=D(j,"TD",{class:!0,"data-svelte-h":!0}),Ae(ee)!=="svelte-18l50by"&&(ee.innerHTML=he),ie=ae(j);for(let se=0;se<V.length;se+=1)V[se].l(j);ge=ae(j),w=D(j,"TD",{class:!0}),N(w).forEach(b),j.forEach(b),p.forEach(b),Y.forEach(b),this.h()},h(){u(i,"class","tree-column svelte-1rmcdss"),u(E,"class",y=e[7]?"mif-tab":"mif-indent-increase"),u(k,"class","mode-toggle svelte-1rmcdss"),u(k,"role","button"),u(k,"aria-label",L=e[7]?"Switch to level mode":"Switch to reorder mode"),u(k,"title",q=e[7]?"Switch to level mode":"Switch to reorder mode"),u(I,"class","control-column svelte-1rmcdss"),u(T,"class","control-column svelte-1rmcdss"),u(K,"class","tree-column svelte-1rmcdss"),u(ee,"class","control-column svelte-1rmcdss"),u(w,"class","control-column svelte-1rmcdss"),u(l,"class","table subcompact table-border cell-border striped svelte-1rmcdss"),u(l,"id",S=e[0]+"-table")},m(h,Y){me(h,l,Y),m(l,r),m(r,s),m(s,i),m(s,v),m(s,I),m(I,k),m(k,E),m(s,re);for(let B=0;B<P.length;B+=1)P[B]&&P[B].m(s,null);m(s,H),m(s,T),m(l,W),m(l,Z);for(let B=0;B<U.length;B+=1)U[B]&&U[B].m(Z,null);m(Z,x),m(Z,A),m(A,K),m(A,te),m(A,ee),m(A,ie);for(let B=0;B<V.length;B+=1)V[B]&&V[B].m(A,null);m(A,ge),m(A,w),e[57](l),G||(ce=[J(_t,"drop",e[39]),J(k,"click",e[36])],G=!0)},p(h,Y){var B,le,_e,ye;if(Y[0]&128&&y!==(y=h[7]?"mif-tab":"mif-indent-increase")&&u(E,"class",y),Y[0]&128&&L!==(L=h[7]?"Switch to level mode":"Switch to reorder mode")&&u(k,"aria-label",L),Y[0]&128&&q!==(q=h[7]?"Switch to level mode":"Switch to reorder mode")&&u(k,"title",q),Y[0]&4){O=we(((le=(B=h[2])==null?void 0:B.getHeader)==null?void 0:le.call(B))??[]);let p;for(p=0;p<O.length;p+=1){const j=Ue(h,O,p);P[p]?P[p].p(j,Y):(P[p]=Ye(j),P[p].c(),P[p].m(s,H))}for(;p<P.length;p+=1)P[p].d(1);P.length=O.length}if(Y[0]&2146435516|Y[1]&733){ue=we(((ye=(_e=h[2])==null?void 0:_e.getAllIds)==null?void 0:ye.call(_e))??[]);let p;for(p=0;p<ue.length;p+=1){const j=Be(h,ue,p);U[p]?U[p].p(j,Y):(U[p]=Ve(j),U[p].c(),U[p].m(Z,x))}for(;p<U.length;p+=1)U[p].d(1);U.length=ue.length}if(Y[0]&512|Y[1]&3){ne=we(h[9]);let p;for(p=0;p<ne.length;p+=1){const j=Fe(h,ne,p);V[p]?V[p].p(j,Y):(V[p]=Je(j),V[p].c(),V[p].m(A,ge))}for(;p<V.length;p+=1)V[p].d(1);V.length=ne.length}Y[0]&1&&S!==(S=h[0]+"-table")&&u(l,"id",S)},i:Oe,o:Oe,d(h){h&&b(l),He(P,h),He(U,h),He(V,h),e[57](null),G=!1,Ee(ce)}}}function yt(e,l,r){let s,i,n,v,I,k,E,y,L,q,re,{name:H}=l,T=ht(H);fe(e,T,t=>r(2,n=t));let Q=pe([]);fe(e,Q,t=>r(9,k=t));let W=pe(!0);fe(e,W,t=>r(7,s=t)),Q.reset=()=>Q.update(t=>{var o;return(o=n==null?void 0:n.getHeader())!=null&&o.length?Array(n.getHeader().length).fill(""):[]});let Z=pe(null);fe(e,Z,t=>r(4,L=t));let x=pe(null);fe(e,x,t=>r(41,y=t));let A=pe(!1);fe(e,A,t=>r(5,q=t));let K=pe(null);fe(e,K,t=>r(42,re=t));let F,te=pe(null);fe(e,te,t=>r(3,E=t));let ee=pe(null);fe(e,ee,t=>r(63,i=t));let he=pe(null);fe(e,he,t=>r(64,I=t));let ie=pe({});fe(e,ie,t=>r(8,v=t));function ge(t){ie.update(o=>{const a={...o};return a[t]=!a[t],a}),T.update(o=>o)}function w(t){const o=v,a=n.getAllIds(),c=a.indexOf(t);if(c===-1)return!1;const f=n.getRowLevel(t);if(f<=1)return!0;for(let d=c-1;d>=0;d--){const g=a[d],_=n.getRowLevel(g);if(_<f){if(_===f-1)return o[g]?!1:w(g);continue}}return!0}function S(t){return n.getChildren(t).length>0}function G(t){const o=n.getRowLevel(t);return Math.max(0,o-1)}function ce(t){const o=n.getAllIds(),a=o.indexOf(t);if(a<=0)return;const c=n.getRowLevel(t),f=o[a-1],d=n.getRowLevel(f),g=Math.min(d+1,c+1);if(g===c)return;const _=n.getAllDescendants(t);T.update(M=>{M.setRowLevel(t,g);const X=g-c;return _.forEach($=>{const C=M.getRowLevel($);M.setRowLevel($,C+X)}),M})}function O(t){const o=n.getRowLevel(t);if(o<=1)return;const a=n.getAllDescendants(t);T.update(c=>(c.setRowLevel(t,o-1),a.forEach(f=>{const d=c.getRowLevel(f);c.setRowLevel(f,Math.max(1,d-1))}),c))}function P(t,o){o.key==="Tab"&&document.activeElement.tagName!=="INPUT"&&(o.preventDefault(),o.shiftKey?O(t):ce(t))}ot(()=>{console.log("Testing new table creation:");const t=new Ce(["ID","Test1","Test2"]);console.log("Test Table Headers:",t.getHeader()),console.log("Test Table Full Headers:",t.getFullHeader()),console.log("Test Table Data:",t.toJSON());const o=c=>{if(!q||!L)return;const f=document.elementFromPoint(c.clientX,c.clientY);if(!f)return;const d=f.closest("td.data-cell");if(!d)return;const g=d.getAttribute("data-row-id"),_=parseInt(d.getAttribute("data-col-index"));if(!re){const de=Math.abs(c.clientX-L.startX),ve=Math.abs(c.clientY-L.startY);(de>5||ve>5)&&K.set("rectangular")}x.set({rowId:g,colIndex:_}),document.querySelectorAll("td.data-cell").forEach(de=>{de.classList.remove("highlight")});const M=n.getAllIds(),X=M.indexOf(L.rowId),$=M.indexOf(g),[C,z]=X<$?[X,$]:[$,X],[Ie,Re]=L.colIndex<_?[L.colIndex,_]:[_,L.colIndex];document.querySelectorAll("td.data-cell").forEach(de=>{const ve=de.getAttribute("data-row-id"),De=parseInt(de.getAttribute("data-col-index")),Pe=M.indexOf(ve);Pe>=C&&Pe<=z&&De>=Ie&&De<=Re&&de.classList.add("highlight")})},a=c=>{if(q&&L&&y){const f=document.elementFromPoint(c.clientX,c.clientY);if(f){const d=f.closest("td.data-cell");if(d){const g=d.getAttribute("data-row-id"),_=parseInt(d.getAttribute("data-col-index")),M=n.getRow(L.rowId);if(M){const X=M[L.colIndex];ue(L.rowId,g,L.colIndex,_,X)}}}}document.querySelectorAll("td.data-cell").forEach(f=>{f.classList.remove("highlight")}),A.set(!1),Z.set(null),x.set(null),te.set(null),K.set(null)};return document.addEventListener("pointermove",o),document.addEventListener("pointerup",a),()=>{document.removeEventListener("pointermove",o),document.removeEventListener("pointerup",a)}});function ue(t,o,a,c,f){const d=n.getAllIds(),g=d.indexOf(t),_=d.indexOf(o);if(g===-1||_===-1)return;const[M,X]=g<_?[g,_]:[_,g],[$,C]=a<c?[a,c]:[c,a],z=new Ce(n.getHeader());d.forEach((Ie,Re)=>{const de=n.getRow(Ie);if(de){const ve=[...de];if(Re>=M&&Re<=X)for(let De=$;De<=C;De++)ve[De]=f;z.add_or_replace_row(Ie,ve)}}),T.set(z)}function U(t,o,a){const c=a.currentTarget.getBoundingClientRect(),f=a.clientX-c.left,d=a.clientY-c.top;f>c.width-8&&d>c.height-8&&(A.set(!0),Z.set({rowId:t,colIndex:o,startX:a.clientX,startY:a.clientY}),x.set({rowId:t,colIndex:o}),te.set({rowId:t,colIndex:o}),K.set(null),a.preventDefault(),a.stopPropagation())}function ne(t,o,a){const c=a.currentTarget.getBoundingClientRect(),f=a.clientX-c.left,d=a.clientY-c.top;f>c.width-8&&d>c.height-8||(te.set({rowId:t,colIndex:o}),a.stopPropagation())}function V(){setTimeout(()=>{var t;!q&&((t=document.activeElement)==null?void 0:t.tagName)!=="INPUT"&&te.set(null)},0)}function Te(t,o){if(!q||!L||!y||L.colIndex!==o)return!1;const a=n.getAllIds(),c=a.indexOf(L.rowId),f=a.indexOf(t),d=a.indexOf(y.rowId);if(c===-1||f===-1||d===-1)return!1;const[g,_]=c<d?[c,d]:[d,c];return f>=g&&f<=_}function ke(t){let o=(t.clipboardData||window.clipboardData).getData("text");const a=o.includes(`
`),c=o.includes("	");if(a&&c){t.preventDefault();let f=o.split(/\n|\r/).filter(d=>d.length).map(d=>d.split(/\t/));T.update(d=>{if(f[0][0]!=="ID"){f[0].unshift("ID");for(let _=1;_<f.length;_++)f[_].unshift(String(_))}let g=new Ce(f[0]);return f.slice(1).forEach(_=>{_.length>0&&g.add_or_replace_row(_[0],_)}),g}),Q.reset()}else{const f=t.target.closest("tr")===t.target.closest("table").querySelector("tbody tr:last-child");setTimeout(f?()=>{Array.from(t.target.closest("tr").querySelectorAll("input")).some(g=>g.value.trim()!=="")&&be()}:()=>{const d=t.target.closest("td");if(d){const g=d.getAttribute("data-row-id");g?h(g):console.warn("No row ID found for paste target:",d)}else console.warn("No td element found for paste target:",t.target)},0)}}function be(){k.join("")!==""&&(T.update(t=>(t.add_or_replace_row(k[0],k),t)),Q.reset())}function Le(t){T.update(o=>(o.delete_row(t),o))}function h(t){if(!t){console.warn("onCellBlur called with invalid rowId:",t);return}const o=Array.from(document.querySelectorAll(`td.data-cell[data-row-id="${t}"] input`));if(!o||o.length===0){console.warn("onCellBlur: No input fields found for rowId:",t);return}const a=o.map(f=>f.value),c=n.getRowLevel(t);console.log(`onCellBlur for row ${t} (updated values):`,a);try{T.update(f=>(String(a[0])!==String(t)&&(a[0]=t),f.add_or_replace_row(t,a),f.setRowLevel(t,c),f))}catch(f){console.error("Error updating row:",f);try{const d=n.getRow(t);if(d&&d.length>0){const g=d.map((_,M)=>M<a.length?a[M]:d[M]);g[0]=t,T.update(_=>(_.add_or_replace_row(t,g),_.setRowLevel(t,c),_))}}catch(d){console.error("Error in fallback update:",d)}}}function Y(t,o,a){if(a.key==="Enter"||a.key==="ArrowDown"||a.key==="ArrowUp"){a.preventDefault();const c=n.getAllIds(),f=c.indexOf(t);let d;if(a.key==="ArrowUp"?d=f>0?f-1:f:d=f<c.length-1?f+1:f,d!==f){const g=c[d];te.set({rowId:g,colIndex:o})}}else if(a.key==="Tab"&&!a.ctrlKey&&!a.altKey&&!a.metaKey&&a.target.tagName==="INPUT"){const f=n.getAllIds().filter(X=>w(X)),d=f.indexOf(t),g=n.getHeader().length;let _=o,M=d;if(a.shiftKey)_--,_<0&&(M--,M<0?(M=0,_=0):_=g-1);else if(_++,_>=g)if(M++,M>=f.length){setTimeout(()=>{const X=document.querySelectorAll("tbody tr:last-child input");X.length>0&&X[0].focus()},0),a.preventDefault();return}else _=0;if(M!==d||_!==o){a.preventDefault();const X=f[M];te.set({rowId:X,colIndex:_}),setTimeout(()=>{const $=document.querySelector(`td.data-cell[data-row-id="${X}"][data-col-index="${_}"] input`);$&&$.focus()},0)}}}function B(){W.update(t=>!t)}function le(t,o){if(!s)return;o.dataTransfer.effectAllowed="move",ee.set(t);const a=o.target.closest("tr");if(a){a.classList.add("dragging");try{const c=a.cloneNode(!0);c.style.width=`${a.offsetWidth}px`,c.style.backgroundColor="#f5f5f5",c.style.opacity="0.8",c.style.position="absolute",c.style.top="-1000px",c.style.border="1px solid #0078A6",c.style.boxShadow="0 2px 5px rgba(0,0,0,0.2)",document.body.appendChild(c),o.dataTransfer.setDragImage(c,20,10),setTimeout(()=>{document.body.removeChild(c)},0)}catch(c){console.warn("Failed to create custom drag image:",c)}}}function _e(t,o){s&&(o.preventDefault(),o.dataTransfer.dropEffect="move",he.set(t),document.querySelectorAll("tr").forEach(a=>{a.classList.remove("drag-over")}),o.currentTarget.closest("tr").classList.add("drag-over"))}function ye(t){if(s){if(t.preventDefault(),i&&I&&i!==I){const o=n.getAllIds(),a=o.indexOf(i),c=o.indexOf(I);if(a!==-1&&c!==-1){const f=n.getAllDescendants(i),d=new Ce(n.getHeader()),g=[...o],_=[g[a],...f];_.map(C=>g.indexOf(C)).sort((C,z)=>z-C).forEach(C=>{g.splice(C,1)});let X=g.indexOf(I);X===-1&&(X=g.length),g.splice(X,0,..._);let $=1;if(X>0){let C=X-1,z=g[C];for(;C>0&&!w(z);)C--,z=g[C];$=n.getRowLevel(z),S(z)&&v[z]&&($=n.getRowLevel(z))}g.forEach(C=>{const z=n.getRow(C),Ie=n.getRowLevel(C);if(C===i)d.add_or_replace_row(C,z),d.setRowLevel(C,$);else if(f.includes(C)){const Re=n.getRowLevel(C),de=n.getRowLevel(i),ve=Re-de;d.add_or_replace_row(C,z),d.setRowLevel(C,$+ve)}else d.add_or_replace_row(C,z),d.setRowLevel(C,Ie)}),T.set(d)}}ee.set(null),he.set(null),document.querySelectorAll("tr").forEach(o=>{o.classList.remove("dragging","drag-over")})}}function p(){s&&(ee.set(null),he.set(null),document.querySelectorAll("tr").forEach(t=>{t.classList.remove("dragging","drag-over")}))}const j=t=>ge(t),se=(t,o)=>le(t,o),We=t=>O(t),je=t=>ce(t);function Ge(t,o){t[o]=this.value}const ze=t=>{h(t),V()},Qe=(t,o,a)=>Y(t,o,a),Ze=(t,o,a)=>U(t,o,a),$e=(t,o,a)=>ne(t,o,a),xe=(t,o,a)=>Y(t,o,a),et=t=>Le(t),tt=(t,o)=>_e(t,o),lt=(t,o)=>P(t,o);function rt(t,o){t[o]=this.value,Q.set(k)}function nt(t){dt[t?"unshift":"push"](()=>{F=t,r(6,F)})}return e.$$set=t=>{"name"in t&&r(0,H=t.name)},e.$$.update=()=>{if(e.$$.dirty[0]&8,e.$$.dirty[0]&16,e.$$.dirty[1]&1024,e.$$.dirty[0]&32,e.$$.dirty[1]&2048,e.$$.dirty[0]&6&&n!=null&&n.getHeader()&&(Q.set(Array(n.getHeader().length).fill("")),console.log("Table Headers:",n.getHeader()),console.log("Table Full Headers:",n.getFullHeader()),console.log("Table Data:",n.toJSON()),console.log("Table IDs:",n.getAllIds()),console.log("Raw Table Structure:",JSON.stringify(n)),n.getAllIds().length>0)){const t=n.getAllIds()[0];console.log("First Row:",n.getRow(t)),console.log("First Full Row:",n.getFullRow(t))}},[H,Q,n,E,L,q,F,s,v,k,T,W,Z,x,A,K,te,ee,he,ie,ge,w,S,G,ce,O,P,U,ne,V,Te,ke,be,Le,h,Y,B,le,_e,ye,p,y,re,j,se,We,je,Ge,ze,Qe,Ze,$e,xe,et,tt,lt,rt,nt]}class Lt extends ut{constructor(l){super(),ft(this,l,yt,bt,st,{name:0},null,[-1,-1,-1])}}export{Lt as T,gt as g};
