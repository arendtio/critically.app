import{s as at,f as y,a as se,g as D,h as M,B as Ae,c as ie,d as m,j as c,i as ve,r as _,v as X,w as Oe,x as He,y as ke,z as he,o as st,l as it,m as ct,n as dt,e as Pe,u as Me,p as ut,D as Se}from"./scheduler.427c93e9.js";import{e as be}from"./each.5e3737eb.js";import{S as ft,i as ht}from"./index.d4e4d1b7.js";import{g as gt,T as Ce}from"./tables.store.11ebb287.js";import{w as _e}from"./index.113f7b86.js";const pt=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;const{window:_t}=pt;function Fe(e,l,n){const r=e.slice();return r[67]=l[n],r[68]=l,r[69]=n,r}function Be(e,l,n){const r=e.slice();return r[70]=l[n],r}function qe(e,l,n){const r=e.slice();return r[67]=l[n],r[73]=l,r[74]=n,r}function Ye(e,l,n){const r=e.slice();return r[75]=l[n],r}function Ue(e){let l,n=e[75]+"",r;return{c(){l=y("th"),r=it(n)},l(s){l=D(s,"TH",{});var o=M(l);r=ct(o,n),o.forEach(m)},m(s,o){ve(s,l,o),_(l,r)},p(s,o){o[0]&4&&n!==(n=s[75]+"")&&dt(r,n)},d(s){s&&m(l)}}}function Xe(e){var ne,fe;let l,n,r,s,o,R,I,A,E,b,k,B,te,O;function T(v,C){return C[0]&4&&(s=null),s==null&&(s=!!v[22](v[70])),s?wt:vt}let G=T(e,[-1,-1,-1]),V=G(e);function W(v,C){return v[7]?bt:mt}let Q=W(e),S=Q(e),U=be(((fe=(ne=e[2])==null?void 0:ne.getRow)==null?void 0:fe.call(ne,e[70]))??[]),P=[];for(let v=0;v<U.length;v+=1)P[v]=Ve(qe(e,U,v));function le(){return e[53](e[70])}function Z(...v){return e[54](e[70],...v)}function ge(...v){return e[55](e[70],...v)}function ue(...v){return e[56](e[70],...v)}return{c(){l=y("tr"),n=y("td"),r=y("div"),V.c(),o=se(),R=y("td"),I=y("div"),S.c(),A=se();for(let v=0;v<P.length;v+=1)P[v].c();E=se(),b=y("td"),k=y("div"),B=y("span"),this.h()},l(v){l=D(v,"TR",{draggable:!0});var C=M(l);n=D(C,"TD",{class:!0});var K=M(n);r=D(K,"DIV",{class:!0});var z=M(r);V.l(z),z.forEach(m),K.forEach(m),o=ie(C),R=D(C,"TD",{class:!0});var w=M(R);I=D(w,"DIV",{class:!0});var $=M(I);S.l($),$.forEach(m),w.forEach(m),A=ie(C);for(let F=0;F<P.length;F+=1)P[F].l(C);E=ie(C),b=D(C,"TD",{class:!0});var Y=M(b);k=D(Y,"DIV",{class:!0});var ce=M(k);B=D(ce,"SPAN",{class:!0,role:!0,"aria-label":!0,title:!0}),M(B).forEach(m),ce.forEach(m),Y.forEach(m),C.forEach(m),this.h()},h(){c(r,"class","hierarchy-controls svelte-1pcbvw8"),c(n,"class","tree-column svelte-1pcbvw8"),c(I,"class","hierarchy-controls svelte-1pcbvw8"),c(R,"class","control-column svelte-1pcbvw8"),c(B,"class","delete-button mif-cross-light svelte-1pcbvw8"),c(B,"role","button"),c(B,"aria-label","Delete row"),c(B,"title","Delete row"),c(k,"class","hierarchy-controls svelte-1pcbvw8"),c(b,"class","control-column svelte-1pcbvw8"),c(l,"draggable",e[7])},m(v,C){ve(v,l,C),_(l,n),_(n,r),V.m(r,null),_(l,o),_(l,R),_(R,I),S.m(I,null),_(l,A);for(let K=0;K<P.length;K+=1)P[K]&&P[K].m(l,null);_(l,E),_(l,b),_(b,k),_(k,B),te||(O=[X(B,"click",le),X(l,"dragstart",Z),X(l,"dragover",ge),X(l,"dragend",e[40]),X(l,"keydown",ue)],te=!0)},p(v,C){var K,z;if(e=v,G===(G=T(e,C))&&V?V.p(e,C):(V.d(1),V=G(e),V&&(V.c(),V.m(r,null))),Q===(Q=W(e))&&S?S.p(e,C):(S.d(1),S=Q(e),S&&(S.c(),S.m(I,null))),C[0]&2021654588|C[1]&25){U=be(((z=(K=e[2])==null?void 0:K.getRow)==null?void 0:z.call(K,e[70]))??[]);let w;for(w=0;w<U.length;w+=1){const $=qe(e,U,w);P[w]?P[w].p($,C):(P[w]=Ve($),P[w].c(),P[w].m(l,E))}for(;w<P.length;w+=1)P[w].d(1);P.length=U.length}C[0]&128&&c(l,"draggable",e[7])},d(v){v&&m(l),V.d(),S.d(),He(P,v),te=!1,ke(O)}}}function vt(e){let l;return{c(){l=y("span"),this.h()},l(n){l=D(n,"SPAN",{class:!0}),M(l).forEach(m),this.h()},h(){c(l,"class","hierarchy-spacer svelte-1pcbvw8")},m(n,r){ve(n,l,r)},p:Oe,d(n){n&&m(l)}}}function wt(e){let l,n,r,s,o,R,I;function A(){return e[44](e[70])}return{c(){l=y("span"),n=y("span"),this.h()},l(E){l=D(E,"SPAN",{class:!0,role:!0,"aria-label":!0,title:!0});var b=M(l);n=D(b,"SPAN",{class:!0}),M(n).forEach(m),b.forEach(m),this.h()},h(){c(n,"class",r=e[8][e[70]]?"mif-plus":"mif-minus"),c(l,"class","hierarchy-toggle svelte-1pcbvw8"),c(l,"role","button"),c(l,"aria-label",s=e[8][e[70]]?"Expand":"Collapse"),c(l,"title",o=e[8][e[70]]?"Expand":"Collapse")},m(E,b){ve(E,l,b),_(l,n),R||(I=X(l,"click",A),R=!0)},p(E,b){e=E,b[0]&260&&r!==(r=e[8][e[70]]?"mif-plus":"mif-minus")&&c(n,"class",r),b[0]&260&&s!==(s=e[8][e[70]]?"Expand":"Collapse")&&c(l,"aria-label",s),b[0]&260&&o!==(o=e[8][e[70]]?"Expand":"Collapse")&&c(l,"title",o)},d(E){E&&m(l),R=!1,I()}}}function mt(e){let l,n,r,s,o,R;function I(){return e[45](e[70])}function A(){return e[46](e[70])}return{c(){l=y("div"),n=y("span"),r=se(),s=y("span"),this.h()},l(E){l=D(E,"DIV",{});var b=M(l);n=D(b,"SPAN",{class:!0,role:!0,"aria-label":!0,title:!0}),M(n).forEach(m),r=ie(b),s=D(b,"SPAN",{class:!0,role:!0,"aria-label":!0,title:!0}),M(s).forEach(m),b.forEach(m),this.h()},h(){c(n,"class","level-control mif-arrow-left svelte-1pcbvw8"),c(n,"role","button"),c(n,"aria-label","Decrease indentation level"),c(n,"title","Decrease indentation level (Shift+Tab)"),c(s,"class","level-control mif-arrow-right svelte-1pcbvw8"),c(s,"role","button"),c(s,"aria-label","Increase indentation level"),c(s,"title","Increase indentation level (Tab)")},m(E,b){ve(E,l,b),_(l,n),_(l,r),_(l,s),o||(R=[X(n,"click",I),X(s,"click",A)],o=!0)},p(E,b){e=E},d(E){E&&m(l),o=!1,ke(R)}}}function bt(e){let l;return{c(){l=y("span"),this.h()},l(n){l=D(n,"SPAN",{class:!0,role:!0,"aria-label":!0,title:!0}),M(l).forEach(m),this.h()},h(){c(l,"class","reorder-handle mif-unfold-more svelte-1pcbvw8"),c(l,"role","button"),c(l,"aria-label","Drag to reorder"),c(l,"title","Drag to reorder")},m(n,r){ve(n,l,r)},p:Oe,d(n){n&&m(l)}}}function Ve(e){let l,n,r,s,o,R,I;function A(){e[47].call(n,e[73],e[74])}function E(){return e[48](e[70])}function b(...O){return e[49](e[70],e[74],...O)}function k(...O){return e[50](e[70],e[74],...O)}function B(...O){return e[51](e[70],e[74],...O)}function te(...O){return e[52](e[70],e[74],...O)}return{c(){l=y("td"),n=y("input"),r=se(),this.h()},l(O){l=D(O,"TD",{class:!0,style:!0,"data-row-id":!0,"data-col-index":!0});var T=M(l);n=D(T,"INPUT",{type:!0,class:!0}),r=ie(T),T.forEach(m),this.h()},h(){c(n,"type","text"),c(n,"class","metro-input svelte-1pcbvw8"),c(l,"class","data-cell svelte-1pcbvw8"),c(l,"style",s=e[74]===0&&e[23](e[70])>0?`padding-left: ${e[23](e[70])*16}px;`:""),c(l,"data-row-id",o=e[70]),c(l,"data-col-index",e[74]),Se(l,"selected-cell",e[3]&&e[3].rowId===e[70]&&e[3].colIndex===e[74]),Se(l,"highlight",e[5]&&e[4]&&e[4].colIndex===e[74]&&e[30](e[70],e[74]))},m(O,T){ve(O,l,T),_(l,n),Me(n,e[67]),_(l,r),R||(I=[X(n,"input",A),X(n,"paste",e[31]),X(n,"blur",E),X(n,"keydown",b),X(l,"pointerdown",k),X(l,"click",B),X(l,"keydown",te)],R=!0)},p(O,T){e=O,T[0]&4&&n.value!==e[67]&&Me(n,e[67]),T[0]&4&&s!==(s=e[74]===0&&e[23](e[70])>0?`padding-left: ${e[23](e[70])*16}px;`:"")&&c(l,"style",s),T[0]&4&&o!==(o=e[70])&&c(l,"data-row-id",o),T[0]&12&&Se(l,"selected-cell",e[3]&&e[3].rowId===e[70]&&e[3].colIndex===e[74]),T[0]&1073741876&&Se(l,"highlight",e[5]&&e[4]&&e[4].colIndex===e[74]&&e[30](e[70],e[74]))},d(O){O&&m(l),R=!1,ke(I)}}}function Je(e){let l=e[21](e[70]),n,r=l&&Xe(e);return{c(){r&&r.c(),n=Pe()},l(s){r&&r.l(s),n=Pe()},m(s,o){r&&r.m(s,o),ve(s,n,o)},p(s,o){o[0]&4&&(l=s[21](s[70])),l?r?r.p(s,o):(r=Xe(s),r.c(),r.m(n.parentNode,n)):r&&(r.d(1),r=null)},d(s){s&&m(n),r&&r.d(s)}}}function Ke(e){let l,n,r,s;function o(){e[57].call(n,e[68],e[69])}return{c(){l=y("td"),n=y("input"),this.h()},l(R){l=D(R,"TD",{class:!0});var I=M(l);n=D(I,"INPUT",{type:!0,class:!0}),I.forEach(m),this.h()},h(){c(n,"type","text"),c(n,"class","metro-input svelte-1pcbvw8"),c(l,"class","svelte-1pcbvw8")},m(R,I){ve(R,l,I),_(l,n),Me(n,e[67]),r||(s=[X(n,"input",o),X(n,"paste",e[31]),X(n,"blur",e[32])],r=!0)},p(R,I){e=R,I[0]&512&&n.value!==e[67]&&Me(n,e[67])},d(R){R&&m(l),r=!1,ke(s)}}}function It(e){var Ie,Le,Re,De;let l,n,r,s,o='<span class="hierarchy-toggle mif-tree svelte-1pcbvw8" title="Hierarchy"></span>',R,I,A,E,b,k,B,te,O,T,G='<span class="delete-button mif-bin svelte-1pcbvw8" title="Delete row"></span>',V,W,Q,S,U,P='<div class="hierarchy-controls svelte-1pcbvw8"><span class="hierarchy-spacer svelte-1pcbvw8"></span></div>',le,Z,ge='<div class="hierarchy-controls svelte-1pcbvw8"><span class="mif-chevron-thin-right"></span></div>',ue,ne,fe,v,C,K,z=be(((Le=(Ie=e[2])==null?void 0:Ie.getHeader)==null?void 0:Le.call(Ie))??[]),w=[];for(let h=0;h<z.length;h+=1)w[h]=Ue(Ye(e,z,h));let $=be(((De=(Re=e[2])==null?void 0:Re.getAllIds)==null?void 0:De.call(Re))??[]),Y=[];for(let h=0;h<$.length;h+=1)Y[h]=Je(Be(e,$,h));let ce=be(e[9]),F=[];for(let h=0;h<ce.length;h+=1)F[h]=Ke(Fe(e,ce,h));return{c(){l=y("table"),n=y("thead"),r=y("tr"),s=y("th"),s.innerHTML=o,R=se(),I=y("th"),A=y("span"),E=y("span"),te=se();for(let h=0;h<w.length;h+=1)w[h].c();O=se(),T=y("th"),T.innerHTML=G,V=se(),W=y("tbody");for(let h=0;h<Y.length;h+=1)Y[h].c();Q=se(),S=y("tr"),U=y("td"),U.innerHTML=P,le=se(),Z=y("td"),Z.innerHTML=ge,ue=se();for(let h=0;h<F.length;h+=1)F[h].c();ne=se(),fe=y("td"),this.h()},l(h){l=D(h,"TABLE",{class:!0,id:!0});var q=M(l);n=D(q,"THEAD",{});var N=M(n);r=D(N,"TR",{});var re=M(r);s=D(re,"TH",{class:!0,"data-svelte-h":!0}),Ae(s)!=="svelte-1focd0m"&&(s.innerHTML=o),R=ie(re),I=D(re,"TH",{class:!0});var pe=M(I);A=D(pe,"SPAN",{class:!0,role:!0,"aria-label":!0,title:!0});var we=M(A);E=D(we,"SPAN",{class:!0}),M(E).forEach(m),we.forEach(m),pe.forEach(m),te=ie(re);for(let oe=0;oe<w.length;oe+=1)w[oe].l(re);O=ie(re),T=D(re,"TH",{class:!0,"data-svelte-h":!0}),Ae(T)!=="svelte-89kh84"&&(T.innerHTML=G),re.forEach(m),N.forEach(m),V=ie(q),W=D(q,"TBODY",{});var g=M(W);for(let oe=0;oe<Y.length;oe+=1)Y[oe].l(g);Q=ie(g),S=D(g,"TR",{});var J=M(S);U=D(J,"TD",{class:!0,"data-svelte-h":!0}),Ae(U)!=="svelte-1r09gtc"&&(U.innerHTML=P),le=ie(J),Z=D(J,"TD",{class:!0,"data-svelte-h":!0}),Ae(Z)!=="svelte-18l50by"&&(Z.innerHTML=ge),ue=ie(J);for(let oe=0;oe<F.length;oe+=1)F[oe].l(J);ne=ie(J),fe=D(J,"TD",{class:!0}),M(fe).forEach(m),J.forEach(m),g.forEach(m),q.forEach(m),this.h()},h(){c(s,"class","tree-column svelte-1pcbvw8"),c(E,"class",b=e[7]?"mif-tab":"mif-indent-increase"),c(A,"class","mode-toggle svelte-1pcbvw8"),c(A,"role","button"),c(A,"aria-label",k=e[7]?"Switch to level mode":"Switch to reorder mode"),c(A,"title",B=e[7]?"Switch to level mode":"Switch to reorder mode"),c(I,"class","control-column svelte-1pcbvw8"),c(T,"class","control-column svelte-1pcbvw8"),c(U,"class","tree-column svelte-1pcbvw8"),c(Z,"class","control-column svelte-1pcbvw8"),c(fe,"class","control-column svelte-1pcbvw8"),c(l,"class","table subcompact table-border cell-border striped"),c(l,"id",v=e[0]+"-table")},m(h,q){ve(h,l,q),_(l,n),_(n,r),_(r,s),_(r,R),_(r,I),_(I,A),_(A,E),_(r,te);for(let N=0;N<w.length;N+=1)w[N]&&w[N].m(r,null);_(r,O),_(r,T),_(l,V),_(l,W);for(let N=0;N<Y.length;N+=1)Y[N]&&Y[N].m(W,null);_(W,Q),_(W,S),_(S,U),_(S,le),_(S,Z),_(S,ue);for(let N=0;N<F.length;N+=1)F[N]&&F[N].m(S,null);_(S,ne),_(S,fe),e[58](l),C||(K=[X(_t,"drop",e[39]),X(A,"click",e[36])],C=!0)},p(h,q){var N,re,pe,we;if(q[0]&128&&b!==(b=h[7]?"mif-tab":"mif-indent-increase")&&c(E,"class",b),q[0]&128&&k!==(k=h[7]?"Switch to level mode":"Switch to reorder mode")&&c(A,"aria-label",k),q[0]&128&&B!==(B=h[7]?"Switch to level mode":"Switch to reorder mode")&&c(A,"title",B),q[0]&4){z=be(((re=(N=h[2])==null?void 0:N.getHeader)==null?void 0:re.call(N))??[]);let g;for(g=0;g<z.length;g+=1){const J=Ye(h,z,g);w[g]?w[g].p(J,q):(w[g]=Ue(J),w[g].c(),w[g].m(r,O))}for(;g<w.length;g+=1)w[g].d(1);w.length=z.length}if(q[0]&2146435516|q[1]&733){$=be(((we=(pe=h[2])==null?void 0:pe.getAllIds)==null?void 0:we.call(pe))??[]);let g;for(g=0;g<$.length;g+=1){const J=Be(h,$,g);Y[g]?Y[g].p(J,q):(Y[g]=Je(J),Y[g].c(),Y[g].m(W,Q))}for(;g<Y.length;g+=1)Y[g].d(1);Y.length=$.length}if(q[0]&512|q[1]&3){ce=be(h[9]);let g;for(g=0;g<ce.length;g+=1){const J=Fe(h,ce,g);F[g]?F[g].p(J,q):(F[g]=Ke(J),F[g].c(),F[g].m(S,ne))}for(;g<F.length;g+=1)F[g].d(1);F.length=ce.length}q[0]&1&&v!==(v=h[0]+"-table")&&c(l,"id",v)},i:Oe,o:Oe,d(h){h&&m(l),He(w,h),He(Y,h),He(F,h),e[58](null),C=!1,ke(K)}}}function Tt(e,l,n){let r,s,o,R,I,A,E,b,k,B,te,{name:O}=l,T=gt(O);he(e,T,t=>n(2,o=t));let G=_e([]);he(e,G,t=>n(9,A=t));let V=_e(!0);he(e,V,t=>n(7,r=t)),G.reset=()=>G.update(t=>{var a;return(a=o==null?void 0:o.getHeader())!=null&&a.length?Array(o.getHeader().length).fill(""):[]});let W=_e(null);he(e,W,t=>n(4,k=t));let Q=_e(null);he(e,Q,t=>n(42,b=t));let S=_e(!1);he(e,S,t=>n(5,B=t));let U=_e(null);he(e,U,t=>n(43,te=t));let P,le=_e(null);he(e,le,t=>n(3,E=t));let Z=_e(null);he(e,Z,t=>n(63,s=t));let ge=_e(null);he(e,ge,t=>n(64,I=t));let ue=null,ne=_e({});he(e,ne,t=>n(8,R=t));function fe(t){ne.update(a=>{const i={...a};return i[t]=!i[t],i}),T.update(a=>a)}function v(t){const a=R,i=o.getAllIds(),f=i.indexOf(t);if(f===-1)return!1;const u=o.getRowLevel(t);if(u<=1)return!0;for(let d=f-1;d>=0;d--){const p=i[d],L=o.getRowLevel(p);if(L<u){if(L===u-1)return a[p]?!1:v(p);continue}}return!0}function C(t){return o.getChildren(t).length>0}function K(t){const a=o.getRowLevel(t);return Math.max(0,a-1)}function z(t){const a=o.getAllIds(),i=a.indexOf(t);if(i<=0)return;const f=o.getRowLevel(t),u=a[i-1],d=o.getRowLevel(u),p=Math.min(d+1,f+1);if(p===f)return;const L=o.getAllDescendants(t);T.update(ee=>{ee.setRowLevel(t,p);const x=p-f;return L.forEach(ae=>{const H=ee.getRowLevel(ae);ee.setRowLevel(ae,H+x)}),ee})}function w(t){const a=o.getRowLevel(t);if(a<=1)return;const i=o.getAllDescendants(t);T.update(f=>(f.setRowLevel(t,a-1),i.forEach(u=>{const d=f.getRowLevel(u);f.setRowLevel(u,Math.max(1,d-1))}),f))}function $(t,a){a.key==="Tab"&&(a.preventDefault(),a.shiftKey?w(t):z(t))}st(()=>{console.log("Testing new table creation:");const t=new Ce(["ID","Test1","Test2"]);console.log("Test Table Headers:",t.getHeader()),console.log("Test Table Full Headers:",t.getFullHeader()),console.log("Test Table Data:",t.toJSON());const a=f=>{if(!B||!k)return;const u=document.elementFromPoint(f.clientX,f.clientY);if(!u)return;const d=u.closest("td.data-cell");if(!d)return;const p=d.getAttribute("data-row-id"),L=parseInt(d.getAttribute("data-col-index"));if(!te){const de=Math.abs(f.clientX-k.startX),me=Math.abs(f.clientY-k.startY);(de>5||me>5)&&U.set("rectangular")}Q.set({rowId:p,colIndex:L}),document.querySelectorAll("td.data-cell").forEach(de=>{de.classList.remove("highlight")});const ee=o.getAllIds(),x=ee.indexOf(k.rowId),ae=ee.indexOf(p),[H,j]=x<ae?[x,ae]:[ae,x],[Te,Ee]=k.colIndex<L?[k.colIndex,L]:[L,k.colIndex];document.querySelectorAll("td.data-cell").forEach(de=>{const me=de.getAttribute("data-row-id"),ye=parseInt(de.getAttribute("data-col-index")),Ne=ee.indexOf(me);Ne>=H&&Ne<=j&&ye>=Te&&ye<=Ee&&de.classList.add("highlight")})},i=f=>{if(B&&k&&b){const u=document.elementFromPoint(f.clientX,f.clientY);if(u){const d=u.closest("td.data-cell");if(d){const p=d.getAttribute("data-row-id"),L=parseInt(d.getAttribute("data-col-index")),ee=o.getRow(k.rowId);if(ee){const x=ee[k.colIndex];Y(k.rowId,p,k.colIndex,L,x)}}}}document.querySelectorAll("td.data-cell").forEach(u=>{u.classList.remove("highlight")}),S.set(!1),W.set(null),Q.set(null),le.set(null),U.set(null)};return document.addEventListener("pointermove",a),document.addEventListener("pointerup",i),()=>{document.removeEventListener("pointermove",a),document.removeEventListener("pointerup",i)}});function Y(t,a,i,f,u){const d=o.getAllIds(),p=d.indexOf(t),L=d.indexOf(a);if(p===-1||L===-1)return;const[ee,x]=p<L?[p,L]:[L,p],[ae,H]=i<f?[i,f]:[f,i],j=new Ce(o.getHeader());d.forEach((Te,Ee)=>{const de=o.getRow(Te);if(de){const me=[...de];if(Ee>=ee&&Ee<=x)for(let ye=ae;ye<=H;ye++)me[ye]=u;j.add_or_replace_row(Te,me)}}),T.set(j)}function ce(t,a,i){const f=i.currentTarget.getBoundingClientRect(),u=i.clientX-f.left,d=i.clientY-f.top;u>f.width-8&&d>f.height-8&&(S.set(!0),W.set({rowId:t,colIndex:a,startX:i.clientX,startY:i.clientY}),Q.set({rowId:t,colIndex:a}),le.set({rowId:t,colIndex:a}),U.set(null),i.preventDefault(),i.stopPropagation())}function F(t,a,i){const f=i.currentTarget.getBoundingClientRect(),u=i.clientX-f.left,d=i.clientY-f.top;u>f.width-8&&d>f.height-8||(le.set({rowId:t,colIndex:a}),i.stopPropagation())}function Ie(){setTimeout(()=>{var t;!B&&((t=document.activeElement)==null?void 0:t.tagName)!=="INPUT"&&le.set(null)},0)}function Le(t,a){if(!B||!k||!b||k.colIndex!==a)return!1;const i=o.getAllIds(),f=i.indexOf(k.rowId),u=i.indexOf(t),d=i.indexOf(b.rowId);if(f===-1||u===-1||d===-1)return!1;const[p,L]=f<d?[f,d]:[d,f];return u>=p&&u<=L}function Re(t){let a=(t.clipboardData||window.clipboardData).getData("text");const i=a.includes(`
`),f=a.includes("	");if(i&&f){t.preventDefault();let u=a.split(/\n|\r/).filter(d=>d.length).map(d=>d.split(/\t/));T.update(d=>{if(u[0][0]!=="ID"){u[0].unshift("ID");for(let L=1;L<u.length;L++)u[L].unshift(String(L))}let p=new Ce(u[0]);return u.slice(1).forEach(L=>{L.length>0&&p.add_or_replace_row(L[0],L)}),p}),G.reset()}else{const u=t.target.closest("tr")===t.target.closest("table").querySelector("tbody tr:last-child");setTimeout(u?()=>{Array.from(t.target.closest("tr").querySelectorAll("input")).some(p=>p.value.trim()!=="")&&De()}:()=>{const d=t.target.closest("td");if(d){const p=d.getAttribute("data-row-id");p?q(p):console.warn("No row ID found for paste target:",d)}else console.warn("No td element found for paste target:",t.target)},0)}}function De(){A.join("")!==""&&(T.update(t=>(t.add_or_replace_row(A[0],A),t)),G.reset())}function h(t){T.update(a=>(a.delete_row(t),a))}function q(t){if(!t){console.warn("onCellBlur called with invalid rowId:",t);return}const a=o.getRow(t);if(!a||!Array.isArray(a)||a.length===0){console.warn("onCellBlur: Invalid row data for rowId:",t);return}console.log(`onCellBlur for row ${t}:`,a);const i=[...a];String(i[0])!==String(t)&&(console.log(`Fixing row data for ${t} - first element was ${i[0]}`),i.unshift(t));try{T.update(f=>(f.add_or_replace_row(t,i),f))}catch(f){console.error("Error updating row:",f);try{const u=o.getFullRow(t);u&&u.length>0&&T.update(d=>(d.add_or_replace_rows([u]),d))}catch(u){console.error("Error in fallback update:",u)}}}function N(t,a,i){if(i.key==="Enter"||i.key==="ArrowDown"||i.key==="ArrowUp"){i.preventDefault();const f=o.getAllIds(),u=f.indexOf(t);let d;if(i.key==="ArrowUp"?d=u>0?u-1:u:d=u<f.length-1?u+1:u,d!==u){const p=f[d];le.set({rowId:p,colIndex:a})}}}function re(){V.update(t=>!t)}function pe(t,a){r&&(a.dataTransfer.effectAllowed="move",Z.set(t),a.currentTarget.classList.add("dragging"))}function we(t,a){r&&(a.preventDefault(),a.dataTransfer.dropEffect="move",ge.set(t),document.querySelectorAll("tr").forEach(i=>{i.classList.remove("drag-over")}),a.currentTarget.closest("tr").classList.add("drag-over"))}function g(t){if(r){if(t.preventDefault(),s&&I&&s!==I){const a=o.getAllIds(),i=a.indexOf(s),f=a.indexOf(I);if(i!==-1&&f!==-1){const u=o.getAllDescendants(s),d=new Ce(o.getHeader()),p=[...a],L=[p[i],...u];L.map(H=>p.indexOf(H)).sort((H,j)=>j-H).forEach(H=>{p.splice(H,1)});let x=p.indexOf(I);x===-1&&(x=p.length),p.splice(x,0,...L);let ae=1;if(x>0){let H=x-1,j=p[H];for(;H>0&&!v(j);)H--,j=p[H];ae=o.getRowLevel(j),C(j)&&R[j]&&(ae=o.getRowLevel(j))}p.forEach(H=>{const j=o.getRow(H),Te=o.getRowLevel(H);if(H===s)d.add_or_replace_row(H,j),d.setRowLevel(H,ae);else if(u.includes(H)){const Ee=o.getRowLevel(H),de=o.getRowLevel(s),me=Ee-de;d.add_or_replace_row(H,j),d.setRowLevel(H,ae+me)}else d.add_or_replace_row(H,j),d.setRowLevel(H,Te)}),T.set(d)}}Z.set(null),ge.set(null),document.querySelectorAll("tr").forEach(a=>{a.classList.remove("dragging","drag-over")})}}function J(){r&&(Z.set(null),ge.set(null),document.querySelectorAll("tr").forEach(t=>{t.classList.remove("dragging","drag-over")}))}const oe=t=>fe(t),je=t=>w(t),Ge=t=>z(t);function We(t,a){t[a]=this.value}const ze=t=>{q(t),Ie()},Qe=(t,a,i)=>N(t,a,i),Ze=(t,a,i)=>ce(t,a,i),$e=(t,a,i)=>F(t,a,i),xe=(t,a,i)=>N(t,a,i),et=t=>h(t),tt=(t,a)=>pe(t,a),lt=(t,a)=>we(t,a),nt=(t,a)=>$(t,a);function rt(t,a){t[a]=this.value,G.set(A)}function ot(t){ut[t?"unshift":"push"](()=>{P=t,n(6,P)})}return e.$$set=t=>{"name"in t&&n(0,O=t.name)},e.$$.update=()=>{if(e.$$.dirty[0]&8|e.$$.dirty[1]&1024&&(n(41,ue=E),ue)){const t=document.querySelector(`td.data-cell[data-row-id="${ue.rowId}"][data-col-index="${ue.colIndex}"] input`);t&&document.activeElement!==t&&t.focus()}if(e.$$.dirty[0]&16,e.$$.dirty[1]&2048,e.$$.dirty[0]&32,e.$$.dirty[1]&4096,e.$$.dirty[0]&6&&o!=null&&o.getHeader()&&(G.set(Array(o.getHeader().length).fill("")),console.log("Table Headers:",o.getHeader()),console.log("Table Full Headers:",o.getFullHeader()),console.log("Table Data:",o.toJSON()),console.log("Table IDs:",o.getAllIds()),console.log("Raw Table Structure:",JSON.stringify(o)),o.getAllIds().length>0)){const t=o.getAllIds()[0];console.log("First Row:",o.getRow(t)),console.log("First Full Row:",o.getFullRow(t))}},[O,G,o,E,k,B,P,r,R,A,T,V,W,Q,S,U,le,Z,ge,ne,fe,v,C,K,z,w,$,ce,F,Ie,Le,Re,De,h,q,N,re,pe,we,g,J,ue,b,te,oe,je,Ge,We,ze,Qe,Ze,$e,xe,et,tt,lt,nt,rt,ot]}class Lt extends ft{constructor(l){super(),ht(this,l,Tt,It,at,{name:0},null,[-1,-1,-1])}}export{Lt as T,pt as g};
