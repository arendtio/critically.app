import{s as ot,f as R,a as se,g as D,h as z,B as Se,c as ae,d as w,j as u,i as me,r as m,v as V,w as Oe,x as ze,y as De,z as fe,o as st,l as at,m as it,n as ct,e as Pe,u as Ne,p as dt,D as Ce}from"./scheduler.427c93e9.js";import{e as be}from"./each.5e3737eb.js";import{S as ut,i as ft}from"./index.d4e4d1b7.js";import{g as ht,T as He}from"./tables.store.e0a4b897.js";import{w as _e}from"./index.113f7b86.js";const gt=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;const{window:pt}=gt;function Me(e,l,n){const o=e.slice();return o[67]=l[n],o[68]=l,o[69]=n,o}function Fe(e,l,n){const o=e.slice();return o[70]=l[n],o}function qe(e,l,n){const o=e.slice();return o[67]=l[n],o[73]=l,o[74]=n,o}function Be(e,l,n){const o=e.slice();return o[75]=l[n],o}function Ue(e){let l,n=e[75]+"",o;return{c(){l=R("th"),o=at(n)},l(i){l=D(i,"TH",{});var r=z(l);o=it(r,n),r.forEach(w)},m(i,r){me(i,l,r),m(l,o)},p(i,r){r[0]&4&&n!==(n=i[75]+"")&&ct(o,n)},d(i){i&&w(l)}}}function Ye(e){var ie,ge;let l,n,o,i,r,v,k,H,T,y,E,q,ne,L;function I(b,S){return S[0]&4&&(i=null),i==null&&(i=!!b[22](b[70])),i?mt:_t}let Q=I(e,[-1,-1,-1]),W=Q(e);function Z(b,S){return b[7]?bt:vt}let x=Z(e),A=x(e),X=be(((ge=(ie=e[2])==null?void 0:ie.getRow)==null?void 0:ge.call(ie,e[70]))??[]),M=[];for(let b=0;b<X.length;b+=1)M[b]=Xe(qe(e,X,b));function te(){return e[53](e[70])}function ee(...b){return e[54](e[70],...b)}function he(...b){return e[55](e[70],...b)}return{c(){l=R("tr"),n=R("td"),o=R("div"),W.c(),r=se(),v=R("td"),k=R("div"),A.c(),H=se();for(let b=0;b<M.length;b+=1)M[b].c();T=se(),y=R("td"),E=R("div"),q=R("span"),this.h()},l(b){l=D(b,"TR",{});var S=z(l);n=D(S,"TD",{class:!0});var j=z(n);o=D(j,"DIV",{class:!0});var ce=z(o);W.l(ce),ce.forEach(w),j.forEach(w),r=ae(S),v=D(S,"TD",{class:!0});var N=z(v);k=D(N,"DIV",{class:!0});var O=z(k);A.l(O),O.forEach(w),N.forEach(w),H=ae(S);for(let re=0;re<M.length;re+=1)M[re].l(S);T=ae(S),y=D(S,"TD",{class:!0});var ue=z(y);E=D(ue,"DIV",{class:!0});var B=z(E);q=D(B,"SPAN",{class:!0,role:!0,"aria-label":!0,title:!0}),z(q).forEach(w),B.forEach(w),ue.forEach(w),S.forEach(w),this.h()},h(){u(o,"class","hierarchy-controls svelte-kcybzh"),u(n,"class","tree-column svelte-kcybzh"),u(k,"class","hierarchy-controls svelte-kcybzh"),u(v,"class","control-column svelte-kcybzh"),u(q,"class","delete-button mif-cross-light svelte-kcybzh"),u(q,"role","button"),u(q,"aria-label","Delete row"),u(q,"title","Delete row"),u(E,"class","hierarchy-controls svelte-kcybzh"),u(y,"class","control-column svelte-kcybzh")},m(b,S){me(b,l,S),m(l,n),m(n,o),W.m(o,null),m(l,r),m(l,v),m(v,k),A.m(k,null),m(l,H);for(let j=0;j<M.length;j+=1)M[j]&&M[j].m(l,null);m(l,T),m(l,y),m(y,E),m(E,q),ne||(L=[V(q,"click",te),V(l,"dragover",ee),V(l,"keydown",he)],ne=!0)},p(b,S){var j,ce;if(e=b,Q===(Q=I(e,S))&&W?W.p(e,S):(W.d(1),W=Q(e),W&&(W.c(),W.m(o,null))),x===(x=Z(e))&&A?A.p(e,S):(A.d(1),A=x(e),A&&(A.c(),A.m(k,null))),S[0]&2021654588|S[1]&25){X=be(((ce=(j=e[2])==null?void 0:j.getRow)==null?void 0:ce.call(j,e[70]))??[]);let N;for(N=0;N<X.length;N+=1){const O=qe(e,X,N);M[N]?M[N].p(O,S):(M[N]=Xe(O),M[N].c(),M[N].m(l,T))}for(;N<M.length;N+=1)M[N].d(1);M.length=X.length}},d(b){b&&w(l),W.d(),A.d(),ze(M,b),ne=!1,De(L)}}}function _t(e){let l;return{c(){l=R("span"),this.h()},l(n){l=D(n,"SPAN",{class:!0}),z(l).forEach(w),this.h()},h(){u(l,"class","hierarchy-spacer svelte-kcybzh")},m(n,o){me(n,l,o)},p:Oe,d(n){n&&w(l)}}}function mt(e){let l,n,o,i,r,v,k;function H(){return e[43](e[70])}return{c(){l=R("span"),n=R("span"),this.h()},l(T){l=D(T,"SPAN",{class:!0,role:!0,"aria-label":!0,title:!0});var y=z(l);n=D(y,"SPAN",{class:!0}),z(n).forEach(w),y.forEach(w),this.h()},h(){u(n,"class",o=e[8][e[70]]?"mif-plus":"mif-minus"),u(l,"class","hierarchy-toggle svelte-kcybzh"),u(l,"role","button"),u(l,"aria-label",i=e[8][e[70]]?"Expand":"Collapse"),u(l,"title",r=e[8][e[70]]?"Expand":"Collapse")},m(T,y){me(T,l,y),m(l,n),v||(k=V(l,"click",H),v=!0)},p(T,y){e=T,y[0]&260&&o!==(o=e[8][e[70]]?"mif-plus":"mif-minus")&&u(n,"class",o),y[0]&260&&i!==(i=e[8][e[70]]?"Expand":"Collapse")&&u(l,"aria-label",i),y[0]&260&&r!==(r=e[8][e[70]]?"Expand":"Collapse")&&u(l,"title",r)},d(T){T&&w(l),v=!1,k()}}}function vt(e){let l,n,o,i,r,v;function k(){return e[45](e[70])}function H(){return e[46](e[70])}return{c(){l=R("div"),n=R("span"),o=se(),i=R("span"),this.h()},l(T){l=D(T,"DIV",{});var y=z(l);n=D(y,"SPAN",{class:!0,role:!0,"aria-label":!0,title:!0}),z(n).forEach(w),o=ae(y),i=D(y,"SPAN",{class:!0,role:!0,"aria-label":!0,title:!0}),z(i).forEach(w),y.forEach(w),this.h()},h(){u(n,"class","level-control mif-arrow-left svelte-kcybzh"),u(n,"role","button"),u(n,"aria-label","Decrease indentation level"),u(n,"title","Decrease indentation level (Shift+Tab)"),u(i,"class","level-control mif-arrow-right svelte-kcybzh"),u(i,"role","button"),u(i,"aria-label","Increase indentation level"),u(i,"title","Increase indentation level (Tab)")},m(T,y){me(T,l,y),m(l,n),m(l,o),m(l,i),r||(v=[V(n,"click",k),V(i,"click",H)],r=!0)},p(T,y){e=T},d(T){T&&w(l),r=!1,De(v)}}}function bt(e){let l,n,o;function i(...r){return e[44](e[70],...r)}return{c(){l=R("span"),this.h()},l(r){l=D(r,"SPAN",{class:!0,role:!0,"aria-label":!0,title:!0,draggable:!0}),z(l).forEach(w),this.h()},h(){u(l,"class","reorder-handle mif-unfold-more svelte-kcybzh"),u(l,"role","button"),u(l,"aria-label","Drag to reorder"),u(l,"title","Drag to reorder"),u(l,"draggable",!0)},m(r,v){me(r,l,v),n||(o=[V(l,"dragstart",i),V(l,"dragend",e[40])],n=!0)},p(r,v){e=r},d(r){r&&w(l),n=!1,De(o)}}}function Xe(e){let l,n,o,i,r,v,k;function H(){e[47].call(n,e[73],e[74])}function T(...L){return e[48](e[70],...L)}function y(...L){return e[49](e[70],e[74],...L)}function E(...L){return e[50](e[70],e[74],...L)}function q(...L){return e[51](e[70],e[74],...L)}function ne(...L){return e[52](e[70],e[74],...L)}return{c(){l=R("td"),n=R("input"),o=se(),this.h()},l(L){l=D(L,"TD",{class:!0,style:!0,"data-row-id":!0,"data-col-index":!0});var I=z(l);n=D(I,"INPUT",{type:!0,class:!0}),o=ae(I),I.forEach(w),this.h()},h(){u(n,"type","text"),u(n,"class","metro-input svelte-kcybzh"),u(l,"class","data-cell svelte-kcybzh"),u(l,"style",i=e[74]===0&&e[23](e[70])>0?`padding-left: ${e[23](e[70])*16}px;`:""),u(l,"data-row-id",r=e[70]),u(l,"data-col-index",e[74]),Ce(l,"selected-cell",e[3]&&e[3].rowId===e[70]&&e[3].colIndex===e[74]),Ce(l,"highlight",e[5]&&e[4]&&e[4].colIndex===e[74]&&e[30](e[70],e[74]))},m(L,I){me(L,l,I),m(l,n),Ne(n,e[67]),m(l,o),v||(k=[V(n,"input",H),V(n,"paste",e[31]),V(n,"blur",T),V(n,"keydown",y),V(l,"pointerdown",E),V(l,"click",q),V(l,"keydown",ne)],v=!0)},p(L,I){e=L,I[0]&4&&n.value!==e[67]&&Ne(n,e[67]),I[0]&4&&i!==(i=e[74]===0&&e[23](e[70])>0?`padding-left: ${e[23](e[70])*16}px;`:"")&&u(l,"style",i),I[0]&4&&r!==(r=e[70])&&u(l,"data-row-id",r),I[0]&12&&Ce(l,"selected-cell",e[3]&&e[3].rowId===e[70]&&e[3].colIndex===e[74]),I[0]&1073741876&&Ce(l,"highlight",e[5]&&e[4]&&e[4].colIndex===e[74]&&e[30](e[70],e[74]))},d(L){L&&w(l),v=!1,De(k)}}}function Ke(e){let l=e[21](e[70]),n,o=l&&Ye(e);return{c(){o&&o.c(),n=Pe()},l(i){o&&o.l(i),n=Pe()},m(i,r){o&&o.m(i,r),me(i,n,r)},p(i,r){r[0]&4&&(l=i[21](i[70])),l?o?o.p(i,r):(o=Ye(i),o.c(),o.m(n.parentNode,n)):o&&(o.d(1),o=null)},d(i){i&&w(n),o&&o.d(i)}}}function Ve(e){let l,n,o,i;function r(){e[56].call(n,e[68],e[69])}return{c(){l=R("td"),n=R("input"),this.h()},l(v){l=D(v,"TD",{class:!0});var k=z(l);n=D(k,"INPUT",{type:!0,class:!0}),k.forEach(w),this.h()},h(){u(n,"type","text"),u(n,"class","metro-input svelte-kcybzh"),u(l,"class","svelte-kcybzh")},m(v,k){me(v,l,k),m(l,n),Ne(n,e[67]),o||(i=[V(n,"input",r),V(n,"paste",e[31]),V(n,"blur",e[32])],o=!0)},p(v,k){e=v,k[0]&512&&n.value!==e[67]&&Ne(n,e[67])},d(v){v&&w(l),o=!1,De(i)}}}function wt(e){var Te,Ae,we,Ee;let l,n,o,i,r='<span class="hierarchy-toggle mif-tree svelte-kcybzh" title="Hierarchy"></span>',v,k,H,T,y,E,q,ne,L,I,Q='<span class="delete-button mif-bin svelte-kcybzh" title="Delete row"></span>',W,Z,x,A,X,M='<div class="hierarchy-controls svelte-kcybzh"><span class="hierarchy-spacer svelte-kcybzh"></span></div>',te,ee,he='<div class="hierarchy-controls svelte-kcybzh"><span class="mif-chevron-thin-right"></span></div>',ie,ge,b,S,j,ce,N=be(((Ae=(Te=e[2])==null?void 0:Te.getHeader)==null?void 0:Ae.call(Te))??[]),O=[];for(let h=0;h<N.length;h+=1)O[h]=Ue(Be(e,N,h));let ue=be(((Ee=(we=e[2])==null?void 0:we.getAllIds)==null?void 0:Ee.call(we))??[]),B=[];for(let h=0;h<ue.length;h+=1)B[h]=Ke(Fe(e,ue,h));let re=be(e[9]),K=[];for(let h=0;h<re.length;h+=1)K[h]=Ve(Me(e,re,h));return{c(){l=R("table"),n=R("thead"),o=R("tr"),i=R("th"),i.innerHTML=r,v=se(),k=R("th"),H=R("span"),T=R("span"),ne=se();for(let h=0;h<O.length;h+=1)O[h].c();L=se(),I=R("th"),I.innerHTML=Q,W=se(),Z=R("tbody");for(let h=0;h<B.length;h+=1)B[h].c();x=se(),A=R("tr"),X=R("td"),X.innerHTML=M,te=se(),ee=R("td"),ee.innerHTML=he,ie=se();for(let h=0;h<K.length;h+=1)K[h].c();ge=se(),b=R("td"),this.h()},l(h){l=D(h,"TABLE",{class:!0,id:!0});var U=z(l);n=D(U,"THEAD",{});var F=z(n);o=D(F,"TR",{});var le=z(o);i=D(le,"TH",{class:!0,"data-svelte-h":!0}),Se(i)!=="svelte-1focd0m"&&(i.innerHTML=r),v=ae(le),k=D(le,"TH",{class:!0});var pe=z(k);H=D(pe,"SPAN",{class:!0,role:!0,"aria-label":!0,title:!0});var ye=z(H);T=D(ye,"SPAN",{class:!0}),z(T).forEach(w),ye.forEach(w),pe.forEach(w),ne=ae(le);for(let oe=0;oe<O.length;oe+=1)O[oe].l(le);L=ae(le),I=D(le,"TH",{class:!0,"data-svelte-h":!0}),Se(I)!=="svelte-89kh84"&&(I.innerHTML=Q),le.forEach(w),F.forEach(w),W=ae(U),Z=D(U,"TBODY",{});var _=z(Z);for(let oe=0;oe<B.length;oe+=1)B[oe].l(_);x=ae(_),A=D(_,"TR",{});var J=z(A);X=D(J,"TD",{class:!0,"data-svelte-h":!0}),Se(X)!=="svelte-1r09gtc"&&(X.innerHTML=M),te=ae(J),ee=D(J,"TD",{class:!0,"data-svelte-h":!0}),Se(ee)!=="svelte-18l50by"&&(ee.innerHTML=he),ie=ae(J);for(let oe=0;oe<K.length;oe+=1)K[oe].l(J);ge=ae(J),b=D(J,"TD",{class:!0}),z(b).forEach(w),J.forEach(w),_.forEach(w),U.forEach(w),this.h()},h(){u(i,"class","tree-column svelte-kcybzh"),u(T,"class",y=e[7]?"mif-tab":"mif-indent-increase"),u(H,"class","mode-toggle svelte-kcybzh"),u(H,"role","button"),u(H,"aria-label",E=e[7]?"Switch to level mode":"Switch to reorder mode"),u(H,"title",q=e[7]?"Switch to level mode":"Switch to reorder mode"),u(k,"class","control-column svelte-kcybzh"),u(I,"class","control-column svelte-kcybzh"),u(X,"class","tree-column svelte-kcybzh"),u(ee,"class","control-column svelte-kcybzh"),u(b,"class","control-column svelte-kcybzh"),u(l,"class","table subcompact table-border cell-border striped svelte-kcybzh"),u(l,"id",S=e[0]+"-table")},m(h,U){me(h,l,U),m(l,n),m(n,o),m(o,i),m(o,v),m(o,k),m(k,H),m(H,T),m(o,ne);for(let F=0;F<O.length;F+=1)O[F]&&O[F].m(o,null);m(o,L),m(o,I),m(l,W),m(l,Z);for(let F=0;F<B.length;F+=1)B[F]&&B[F].m(Z,null);m(Z,x),m(Z,A),m(A,X),m(A,te),m(A,ee),m(A,ie);for(let F=0;F<K.length;F+=1)K[F]&&K[F].m(A,null);m(A,ge),m(A,b),e[57](l),j||(ce=[V(pt,"drop",e[39]),V(H,"click",e[36])],j=!0)},p(h,U){var F,le,pe,ye;if(U[0]&128&&y!==(y=h[7]?"mif-tab":"mif-indent-increase")&&u(T,"class",y),U[0]&128&&E!==(E=h[7]?"Switch to level mode":"Switch to reorder mode")&&u(H,"aria-label",E),U[0]&128&&q!==(q=h[7]?"Switch to level mode":"Switch to reorder mode")&&u(H,"title",q),U[0]&4){N=be(((le=(F=h[2])==null?void 0:F.getHeader)==null?void 0:le.call(F))??[]);let _;for(_=0;_<N.length;_+=1){const J=Be(h,N,_);O[_]?O[_].p(J,U):(O[_]=Ue(J),O[_].c(),O[_].m(o,L))}for(;_<O.length;_+=1)O[_].d(1);O.length=N.length}if(U[0]&2146435516|U[1]&733){ue=be(((ye=(pe=h[2])==null?void 0:pe.getAllIds)==null?void 0:ye.call(pe))??[]);let _;for(_=0;_<ue.length;_+=1){const J=Fe(h,ue,_);B[_]?B[_].p(J,U):(B[_]=Ke(J),B[_].c(),B[_].m(Z,x))}for(;_<B.length;_+=1)B[_].d(1);B.length=ue.length}if(U[0]&512|U[1]&3){re=be(h[9]);let _;for(_=0;_<re.length;_+=1){const J=Me(h,re,_);K[_]?K[_].p(J,U):(K[_]=Ve(J),K[_].c(),K[_].m(A,ge))}for(;_<K.length;_+=1)K[_].d(1);K.length=re.length}U[0]&1&&S!==(S=h[0]+"-table")&&u(l,"id",S)},i:Oe,o:Oe,d(h){h&&w(l),ze(O,h),ze(B,h),ze(K,h),e[57](null),j=!1,De(ce)}}}function yt(e,l,n){let o,i,r,v,k,H,T,y,E,q,ne,{name:L}=l,I=ht(L);fe(e,I,t=>n(2,r=t));let Q=_e([]);fe(e,Q,t=>n(9,H=t));let W=_e(!0);fe(e,W,t=>n(7,o=t)),Q.reset=()=>Q.update(t=>{var s;return(s=r==null?void 0:r.getHeader())!=null&&s.length?Array(r.getHeader().length).fill(""):[]});let Z=_e(null);fe(e,Z,t=>n(4,E=t));let x=_e(null);fe(e,x,t=>n(41,y=t));let A=_e(!1);fe(e,A,t=>n(5,q=t));let X=_e(null);fe(e,X,t=>n(42,ne=t));let M,te=_e(null);fe(e,te,t=>n(3,T=t));let ee=_e(null);fe(e,ee,t=>n(63,i=t));let he=_e(null);fe(e,he,t=>n(64,k=t));let ie=_e({});fe(e,ie,t=>n(8,v=t));function ge(t){ie.update(s=>{const a={...s};return a[t]=!a[t],a}),I.update(s=>s)}function b(t){const s=v,a=r.getAllIds(),c=a.indexOf(t);if(c===-1)return!1;const f=r.getRowLevel(t);if(f<=1)return!0;for(let d=c-1;d>=0;d--){const p=a[d],g=r.getRowLevel(p);if(g<f){if(g===f-1)return s[p]?!1:b(p);continue}}return!0}function S(t){return r.getChildren(t).length>0}function j(t){const s=r.getRowLevel(t);return Math.max(0,s-1)}function ce(t){const s=r.getAllIds(),a=s.indexOf(t);if(a<=0)return;const c=r.getRowLevel(t),f=s[a-1],d=r.getRowLevel(f),p=Math.min(d+1,c+1);if(p===c)return;const g=r.getAllDescendants(t);I.update(P=>{P.setRowLevel(t,p);const Y=p-c;return g.forEach($=>{const C=P.getRowLevel($);P.setRowLevel($,C+Y)}),P})}function N(t){const s=r.getRowLevel(t);if(s<=1)return;const a=r.getAllDescendants(t);I.update(c=>(c.setRowLevel(t,s-1),a.forEach(f=>{const d=c.getRowLevel(f);c.setRowLevel(f,Math.max(1,d-1))}),c))}function O(t,s){s.key==="Tab"&&document.activeElement.tagName!=="INPUT"&&(s.preventDefault(),s.shiftKey?N(t):ce(t))}st(()=>{console.log("Testing new table creation:");const t=new He(["ID","Test1","Test2"]);console.log("Test Table Headers:",t.getHeader()),console.log("Test Table Full Headers:",t.getFullHeader()),console.log("Test Table Data:",t.toJSON());const s=c=>{if(!q||!E)return;const f=document.elementFromPoint(c.clientX,c.clientY);if(!f)return;const d=f.closest("td.data-cell");if(!d)return;const p=d.getAttribute("data-row-id"),g=parseInt(d.getAttribute("data-col-index"));if(!ne){const de=Math.abs(c.clientX-E.startX),ke=Math.abs(c.clientY-E.startY);(de>5||ke>5)&&X.set("rectangular")}x.set({rowId:p,colIndex:g}),document.querySelectorAll("td.data-cell").forEach(de=>{de.classList.remove("highlight")});const P=r.getAllIds(),Y=P.indexOf(E.rowId),$=P.indexOf(p),[C,G]=Y<$?[Y,$]:[$,Y],[ve,Ie]=E.colIndex<g?[E.colIndex,g]:[g,E.colIndex];document.querySelectorAll("td.data-cell").forEach(de=>{const ke=de.getAttribute("data-row-id"),Le=parseInt(de.getAttribute("data-col-index")),Re=P.indexOf(ke);Re>=C&&Re<=G&&Le>=ve&&Le<=Ie&&de.classList.add("highlight")})},a=c=>{if(q&&E&&y){const f=document.elementFromPoint(c.clientX,c.clientY);if(f){const d=f.closest("td.data-cell");if(d){const p=d.getAttribute("data-row-id"),g=parseInt(d.getAttribute("data-col-index")),P=r.getRow(E.rowId);if(P){const Y=P[E.colIndex];ue(E.rowId,p,E.colIndex,g,Y)}}}}document.querySelectorAll("td.data-cell").forEach(f=>{f.classList.remove("highlight")}),A.set(!1),Z.set(null),x.set(null),te.set(null),X.set(null)};return document.addEventListener("pointermove",s),document.addEventListener("pointerup",a),()=>{document.removeEventListener("pointermove",s),document.removeEventListener("pointerup",a)}});function ue(t,s,a,c,f){const d=r.getAllIds(),p=d.indexOf(t),g=d.indexOf(s);if(p===-1||g===-1)return;const[P,Y]=p<g?[p,g]:[g,p],[$,C]=a<c?[a,c]:[c,a],G=new He(r.getHeader());d.forEach((ve,Ie)=>{const de=r.getRow(ve),ke=r.getRowLevel(ve);if(de){const Le=[...de];if(Ie>=P&&Ie<=Y)for(let Re=$;Re<=C;Re++)Le[Re]=f;G.add_rows([[ve,...Le]]),G.setRowLevel(ve,ke)}}),I.set(G)}function B(t,s,a){const c=a.currentTarget.getBoundingClientRect(),f=a.clientX-c.left,d=a.clientY-c.top;f>c.width-8&&d>c.height-8&&(A.set(!0),Z.set({rowId:t,colIndex:s,startX:a.clientX,startY:a.clientY}),x.set({rowId:t,colIndex:s}),te.set({rowId:t,colIndex:s}),X.set(null),a.preventDefault(),a.stopPropagation())}function re(t,s,a){const c=a.currentTarget.getBoundingClientRect(),f=a.clientX-c.left,d=a.clientY-c.top;f>c.width-8&&d>c.height-8||((!T||T.rowId!==t||T.colIndex!==s)&&te.set({rowId:t,colIndex:s}),a.stopPropagation())}function K(){setTimeout(()=>{var t;!q&&((t=document.activeElement)==null?void 0:t.tagName)!=="INPUT"&&!document.querySelector(".data-cell:active")&&te.set(null)},50)}function Te(t,s){if(!q||!E||!y||E.colIndex!==s)return!1;const a=r.getAllIds(),c=a.indexOf(E.rowId),f=a.indexOf(t),d=a.indexOf(y.rowId);if(c===-1||f===-1||d===-1)return!1;const[p,g]=c<d?[c,d]:[d,c];return f>=p&&f<=g}function Ae(t){let s=(t.clipboardData||window.clipboardData).getData("text");const a=s.includes(`
`),c=s.includes("	");if(a&&c){t.preventDefault();let f=s.split(/\n|\r/).filter(d=>d.length).map(d=>d.split(/\t/));I.update(d=>{if(f[0][0]!=="ID"){f[0].unshift("ID");for(let g=1;g<f.length;g++)f[g].unshift(String(g))}let p=new He(f[0]);return f.slice(1).forEach(g=>{g.length>0&&p.replace_rows([[g[0],...g]])}),p}),Q.reset()}else{const f=t.target.closest("tr")===t.target.closest("table").querySelector("tbody tr:last-child");setTimeout(f?()=>{Array.from(t.target.closest("tr").querySelectorAll("input")).some(p=>p.value.trim()!=="")&&we()}:()=>{const d=t.target.closest("td");if(d){const p=d.getAttribute("data-row-id");p?h(p):console.warn("No row ID found for paste target:",d)}else console.warn("No td element found for paste target:",t.target)},0)}}function we(){H.join("")!==""&&(I.update(t=>(t.replace_rows([[rowId,...updatedRow]]),t)),Q.reset())}function Ee(t){I.update(s=>(s.delete_row(t),s))}function h(t){if(!t){console.warn("onCellBlur called with invalid rowId:",t);return}const s=Array.from(document.querySelectorAll(`td.data-cell[data-row-id="${t}"] input`));if(!s||s.length===0){console.warn("onCellBlur: No input fields found for rowId:",t);return}const a=s.map(f=>f.value),c=r.getRowLevel(t);console.log(`onCellBlur for row ${t} (updated values):`,a);try{I.update(f=>(String(a[0])!==String(t)&&(a[0]=t),f.replace_rows([[t,...a]]),f.setRowLevel(t,c),f))}catch(f){console.error("Error updating row:",f);try{const d=r.getRow(t);if(d&&d.length>0){const p=d.map((g,P)=>P<a.length?a[P]:d[P]);p[0]=t,I.update(g=>(g.replace_rows([[t,...p]]),g.setRowLevel(t,c),g))}}catch(d){console.error("Error in fallback update:",d)}}}function U(t,s,a){if(a.key==="Enter"||a.key==="ArrowDown"||a.key==="ArrowUp"){a.preventDefault();const c=r.getAllIds(),f=c.indexOf(t);let d;if(a.key==="ArrowUp"?d=f>0?f-1:f:d=f<c.length-1?f+1:f,d!==f){const p=c[d];te.set({rowId:p,colIndex:s}),setTimeout(function(){const g=document.querySelector(`td.data-cell[data-row-id="${p}"][data-col-index="${s}"] input`);g&&g.focus()},0)}}else if(a.key==="Tab"&&!a.ctrlKey&&!a.altKey&&!a.metaKey&&a.target.tagName==="INPUT"){const f=r.getAllIds().filter(Y=>b(Y)),d=f.indexOf(t),p=r.getHeader().length;let g=s,P=d;if(a.shiftKey)g--,g<0&&(P--,P<0?(P=0,g=0):g=p-1);else if(g++,g>=p)if(P++,P>=f.length){setTimeout(()=>{const Y=document.querySelectorAll("tbody tr:last-child input");Y.length>0&&Y[0].focus()},0),a.preventDefault();return}else g=0;if(P!==d||g!==s){a.preventDefault();const Y=f[P];te.set({rowId:Y,colIndex:g}),setTimeout(()=>{const $=document.querySelector(`td.data-cell[data-row-id="${Y}"][data-col-index="${g}"] input`);$&&$.focus()},0)}}}function F(){W.update(t=>!t)}function le(t,s){if(!o)return;s.dataTransfer.effectAllowed="move",ee.set(t);const a=s.target.closest("tr");if(a){a.classList.add("dragging");try{const c=a.cloneNode(!0);c.style.width=`${a.offsetWidth}px`,c.style.backgroundColor="#f5f5f5",c.style.opacity="0.8",c.style.position="absolute",c.style.top="-1000px",c.style.border="1px solid #0078A6",c.style.boxShadow="0 2px 5px rgba(0,0,0,0.2)",document.body.appendChild(c),s.dataTransfer.setDragImage(c,20,10),setTimeout(()=>{document.body.removeChild(c)},0)}catch(c){console.warn("Failed to create custom drag image:",c)}}}function pe(t,s){o&&(s.preventDefault(),s.dataTransfer.dropEffect="move",he.set(t),document.querySelectorAll("tr").forEach(a=>{a.classList.remove("drag-over")}),s.currentTarget.closest("tr").classList.add("drag-over"))}function ye(t){if(o){if(t.preventDefault(),i&&k&&i!==k){const s=r.getAllIds(),a=s.indexOf(i),c=s.indexOf(k);if(a!==-1&&c!==-1){const f=r.getAllDescendants(i),d=new He(r.getHeader()),p=[...s],g=[p[a],...f];g.map(C=>p.indexOf(C)).sort((C,G)=>G-C).forEach(C=>{p.splice(C,1)});let Y=p.indexOf(k);Y===-1&&(Y=p.length),p.splice(Y,0,...g);let $=1;if(Y>0){let C=Y-1,G=p[C];for(;C>0&&!b(G);)C--,G=p[C];$=r.getRowLevel(G),S(G)&&v[G]&&($=r.getRowLevel(G))}p.forEach(C=>{const G=r.getRow(C),ve=r.getRowLevel(C);if(C===i)d.add_rows([[C,...G]]),d.setRowLevel(C,$);else if(f.includes(C)){const Ie=r.getRowLevel(C),de=r.getRowLevel(i),ke=Ie-de;d.add_rows([[C,...G]]),d.setRowLevel(C,$+ke)}else d.add_rows([[C,...G]]),d.setRowLevel(C,ve)}),I.set(d)}}ee.set(null),he.set(null),document.querySelectorAll("tr").forEach(s=>{s.classList.remove("dragging","drag-over")})}}function _(){o&&(ee.set(null),he.set(null),document.querySelectorAll("tr").forEach(t=>{t.classList.remove("dragging","drag-over")}))}const J=t=>ge(t),oe=(t,s)=>le(t,s),We=t=>N(t),Je=t=>ce(t);function je(t,s){t[s]=this.value}const Ge=(t,s)=>{h(t);const a=s.relatedTarget,c=s.target.closest("td.data-cell");a&&c&&c.contains(a)||K()},Qe=(t,s,a)=>U(t,s,a),Ze=(t,s,a)=>B(t,s,a),$e=(t,s,a)=>re(t,s,a),xe=(t,s,a)=>U(t,s,a),et=t=>Ee(t),tt=(t,s)=>pe(t,s),lt=(t,s)=>O(t,s);function nt(t,s){t[s]=this.value,Q.set(H)}function rt(t){dt[t?"unshift":"push"](()=>{M=t,n(6,M)})}return e.$$set=t=>{"name"in t&&n(0,L=t.name)},e.$$.update=()=>{if(e.$$.dirty[0]&8,e.$$.dirty[0]&16,e.$$.dirty[1]&1024,e.$$.dirty[0]&32,e.$$.dirty[1]&2048,e.$$.dirty[0]&6&&r!=null&&r.getHeader()&&(Q.set(Array(r.getHeader().length).fill("")),console.log("Table Headers:",r.getHeader()),console.log("Table Full Headers:",r.getFullHeader()),console.log("Table Data:",r.toJSON()),console.log("Table IDs:",r.getAllIds()),console.log("Raw Table Structure:",JSON.stringify(r)),r.getAllIds().length>0)){const t=r.getAllIds()[0];console.log("First Row:",r.getRow(t)),console.log("First Full Row:",r.getFullRow(t))}},[L,Q,r,T,E,q,M,o,v,H,I,W,Z,x,A,X,te,ee,he,ie,ge,b,S,j,ce,N,O,B,re,K,Te,Ae,we,Ee,h,U,F,le,pe,ye,_,y,ne,J,oe,We,Je,je,Ge,Qe,Ze,$e,xe,et,tt,lt,nt,rt]}class Et extends ut{constructor(l){super(),ft(this,l,yt,wt,ot,{name:0},null,[-1,-1,-1])}}export{Et as T,gt as g};
