import{s as bt,n as ot,e as Ct,o as Pt,f as dt,b as Vt,r as Rt}from"../chunks/scheduler.72a81396.js";import{S as Et,i as xt,g as S,h as N,j as A,f as B,k,a as G,s as U,c as X,x as ft,y as x,A as at,m as ht,n as ut,o as pt,B as ct,z as lt,e as Bt,r as _t,u as mt,v as gt,d as vt,t as wt,w as yt}from"../chunks/index.45de7edf.js";import{c as Ut,g as Xt,z as Jt}from"../chunks/drawflow.store.aa0a6cb1.js";import{d as Lt,c as Yt}from"../chunks/criticalPath.store.1c85e9a0.js";import{e as et}from"../chunks/each.e59479a4.js";import{g as Gt,T as Kt}from"../chunks/tables.store.42dbbbd7.js";import{w as Qt}from"../chunks/index.2391f01a.js";import{c as rt}from"../chunks/assistant.store.3f7e3d58.js";var Ft={exports:{}};(function(w,l){(function(r,c){w.exports=c()})(typeof self<"u"?self:Ut,function(){return function(r){var c={};function y(_){if(c[_])return c[_].exports;var u=c[_]={i:_,l:!1,exports:{}};return r[_].call(u.exports,u,u.exports,y),u.l=!0,u.exports}return y.m=r,y.c=c,y.d=function(_,u,t){y.o(_,u)||Object.defineProperty(_,u,{enumerable:!0,get:t})},y.r=function(_){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(_,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(_,"__esModule",{value:!0})},y.t=function(_,u){if(1&u&&(_=y(_)),8&u||4&u&&typeof _=="object"&&_&&_.__esModule)return _;var t=Object.create(null);if(y.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:_}),2&u&&typeof _!="string")for(var s in _)y.d(t,s,(function(e){return _[e]}).bind(null,s));return t},y.n=function(_){var u=_&&_.__esModule?function(){return _.default}:function(){return _};return y.d(u,"a",u),u},y.o=function(_,u){return Object.prototype.hasOwnProperty.call(_,u)},y.p="",y(y.s=0)}([function(r,c,y){y.r(c),y.d(c,"default",function(){return _});class _{constructor(t,s=null,e=null){this.events={},this.container=t,this.precanvas=null,this.nodeId=1,this.ele_selected=null,this.node_selected=null,this.drag=!1,this.reroute=!1,this.reroute_fix_curvature=!1,this.curvature=.5,this.reroute_curvature_start_end=.5,this.reroute_curvature=.5,this.reroute_width=6,this.drag_point=!1,this.editor_selected=!1,this.connection=!1,this.connection_ele=null,this.connection_selected=null,this.canvas_x=0,this.canvas_y=0,this.pos_x=0,this.pos_x_start=0,this.pos_y=0,this.pos_y_start=0,this.mouse_x=0,this.mouse_y=0,this.line_path=5,this.first_click=null,this.force_first_input=!1,this.draggable_inputs=!0,this.useuuid=!1,this.parent=e,this.noderegister={},this.render=s,this.drawflow={drawflow:{Home:{data:{}}}},this.module="Home",this.editor_mode="edit",this.zoom=1,this.zoom_max=1.6,this.zoom_min=.5,this.zoom_value=.1,this.zoom_last_value=1,this.evCache=new Array,this.prevDiff=-1}start(){this.container.classList.add("parent-drawflow"),this.container.tabIndex=0,this.precanvas=document.createElement("div"),this.precanvas.classList.add("drawflow"),this.container.appendChild(this.precanvas),this.container.addEventListener("mouseup",this.dragEnd.bind(this)),this.container.addEventListener("mousemove",this.position.bind(this)),this.container.addEventListener("mousedown",this.click.bind(this)),this.container.addEventListener("touchend",this.dragEnd.bind(this)),this.container.addEventListener("touchmove",this.position.bind(this)),this.container.addEventListener("touchstart",this.click.bind(this)),this.container.addEventListener("contextmenu",this.contextmenu.bind(this)),this.container.addEventListener("keydown",this.key.bind(this)),this.container.addEventListener("wheel",this.zoom_enter.bind(this)),this.container.addEventListener("input",this.updateNodeValue.bind(this)),this.container.addEventListener("dblclick",this.dblclick.bind(this)),this.container.onpointerdown=this.pointerdown_handler.bind(this),this.container.onpointermove=this.pointermove_handler.bind(this),this.container.onpointerup=this.pointerup_handler.bind(this),this.container.onpointercancel=this.pointerup_handler.bind(this),this.container.onpointerout=this.pointerup_handler.bind(this),this.container.onpointerleave=this.pointerup_handler.bind(this),this.load()}pointerdown_handler(t){this.evCache.push(t)}pointermove_handler(t){for(var s=0;s<this.evCache.length;s++)if(t.pointerId==this.evCache[s].pointerId){this.evCache[s]=t;break}if(this.evCache.length==2){var e=Math.abs(this.evCache[0].clientX-this.evCache[1].clientX);this.prevDiff>100&&(e>this.prevDiff&&this.zoom_in(),e<this.prevDiff&&this.zoom_out()),this.prevDiff=e}}pointerup_handler(t){this.remove_event(t),this.evCache.length<2&&(this.prevDiff=-1)}remove_event(t){for(var s=0;s<this.evCache.length;s++)if(this.evCache[s].pointerId==t.pointerId){this.evCache.splice(s,1);break}}load(){for(var t in this.drawflow.drawflow[this.module].data)this.addNodeImport(this.drawflow.drawflow[this.module].data[t],this.precanvas);if(this.reroute)for(var t in this.drawflow.drawflow[this.module].data)this.addRerouteImport(this.drawflow.drawflow[this.module].data[t]);for(var t in this.drawflow.drawflow[this.module].data)this.updateConnectionNodes("node-"+t);const s=this.drawflow.drawflow;let e=1;Object.keys(s).map(function(i,n){Object.keys(s[i].data).map(function(d,f){parseInt(d)>=e&&(e=parseInt(d)+1)})}),this.nodeId=e}removeReouteConnectionSelected(){this.dispatch("connectionUnselected",!0),this.reroute_fix_curvature&&this.connection_selected.parentElement.querySelectorAll(".main-path").forEach((t,s)=>{t.classList.remove("selected")})}click(t){if(this.dispatch("click",t),this.editor_mode==="fixed"){if(t.preventDefault(),t.target.classList[0]!=="parent-drawflow"&&t.target.classList[0]!=="drawflow")return!1;this.ele_selected=t.target.closest(".parent-drawflow")}else this.editor_mode==="view"?(t.target.closest(".drawflow")!=null||t.target.matches(".parent-drawflow"))&&(this.ele_selected=t.target.closest(".parent-drawflow"),t.preventDefault()):(this.first_click=t.target,this.ele_selected=t.target,t.button===0&&this.contextmenuDel(),t.target.closest(".drawflow_content_node")!=null&&(this.ele_selected=t.target.closest(".drawflow_content_node").parentElement));switch(this.ele_selected.classList[0]){case"drawflow-node":this.node_selected!=null&&(this.node_selected.classList.remove("selected"),this.node_selected!=this.ele_selected&&this.dispatch("nodeUnselected",!0)),this.connection_selected!=null&&(this.connection_selected.classList.remove("selected"),this.removeReouteConnectionSelected(),this.connection_selected=null),this.node_selected!=this.ele_selected&&this.dispatch("nodeSelected",this.ele_selected.id.slice(5)),this.node_selected=this.ele_selected,this.node_selected.classList.add("selected"),this.draggable_inputs?t.target.tagName!=="SELECT"&&(this.drag=!0):t.target.tagName!=="INPUT"&&t.target.tagName!=="TEXTAREA"&&t.target.tagName!=="SELECT"&&t.target.hasAttribute("contenteditable")!==!0&&(this.drag=!0);break;case"output":this.connection=!0,this.node_selected!=null&&(this.node_selected.classList.remove("selected"),this.node_selected=null,this.dispatch("nodeUnselected",!0)),this.connection_selected!=null&&(this.connection_selected.classList.remove("selected"),this.removeReouteConnectionSelected(),this.connection_selected=null),this.drawConnection(t.target);break;case"parent-drawflow":case"drawflow":this.node_selected!=null&&(this.node_selected.classList.remove("selected"),this.node_selected=null,this.dispatch("nodeUnselected",!0)),this.connection_selected!=null&&(this.connection_selected.classList.remove("selected"),this.removeReouteConnectionSelected(),this.connection_selected=null),this.editor_selected=!0;break;case"main-path":this.node_selected!=null&&(this.node_selected.classList.remove("selected"),this.node_selected=null,this.dispatch("nodeUnselected",!0)),this.connection_selected!=null&&(this.connection_selected.classList.remove("selected"),this.removeReouteConnectionSelected(),this.connection_selected=null),this.connection_selected=this.ele_selected,this.connection_selected.classList.add("selected");const s=this.connection_selected.parentElement.classList;s.length>1&&(this.dispatch("connectionSelected",{output_id:s[2].slice(14),input_id:s[1].slice(13),output_class:s[3],input_class:s[4]}),this.reroute_fix_curvature&&this.connection_selected.parentElement.querySelectorAll(".main-path").forEach((e,i)=>{e.classList.add("selected")}));break;case"point":this.drag_point=!0,this.ele_selected.classList.add("selected");break;case"drawflow-delete":this.node_selected&&this.removeNodeId(this.node_selected.id),this.connection_selected&&this.removeConnection(),this.node_selected!=null&&(this.node_selected.classList.remove("selected"),this.node_selected=null,this.dispatch("nodeUnselected",!0)),this.connection_selected!=null&&(this.connection_selected.classList.remove("selected"),this.removeReouteConnectionSelected(),this.connection_selected=null)}t.type==="touchstart"?(this.pos_x=t.touches[0].clientX,this.pos_x_start=t.touches[0].clientX,this.pos_y=t.touches[0].clientY,this.pos_y_start=t.touches[0].clientY,this.mouse_x=t.touches[0].clientX,this.mouse_y=t.touches[0].clientY):(this.pos_x=t.clientX,this.pos_x_start=t.clientX,this.pos_y=t.clientY,this.pos_y_start=t.clientY),["input","output","main-path"].includes(this.ele_selected.classList[0])&&t.preventDefault(),this.dispatch("clickEnd",t)}position(t){if(t.type==="touchmove")var s=t.touches[0].clientX,e=t.touches[0].clientY;else s=t.clientX,e=t.clientY;if(this.connection&&this.updateConnection(s,e),this.editor_selected&&(i=this.canvas_x+-(this.pos_x-s),n=this.canvas_y+-(this.pos_y-e),this.dispatch("translate",{x:i,y:n}),this.precanvas.style.transform="translate("+i+"px, "+n+"px) scale("+this.zoom+")"),this.drag){t.preventDefault();var i=(this.pos_x-s)*this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom),n=(this.pos_y-e)*this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom);this.pos_x=s,this.pos_y=e,this.ele_selected.style.top=this.ele_selected.offsetTop-n+"px",this.ele_selected.style.left=this.ele_selected.offsetLeft-i+"px",this.drawflow.drawflow[this.module].data[this.ele_selected.id.slice(5)].pos_x=this.ele_selected.offsetLeft-i,this.drawflow.drawflow[this.module].data[this.ele_selected.id.slice(5)].pos_y=this.ele_selected.offsetTop-n,this.updateConnectionNodes(this.ele_selected.id)}if(this.drag_point){i=(this.pos_x-s)*this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom),n=(this.pos_y-e)*this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom),this.pos_x=s,this.pos_y=e;var d=this.pos_x*(this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom))-this.precanvas.getBoundingClientRect().x*(this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom)),f=this.pos_y*(this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom))-this.precanvas.getBoundingClientRect().y*(this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom));this.ele_selected.setAttributeNS(null,"cx",d),this.ele_selected.setAttributeNS(null,"cy",f);const g=this.ele_selected.parentElement.classList[2].slice(9),h=this.ele_selected.parentElement.classList[1].slice(13),o=this.ele_selected.parentElement.classList[3],p=this.ele_selected.parentElement.classList[4];let v=Array.from(this.ele_selected.parentElement.children).indexOf(this.ele_selected)-1;this.reroute_fix_curvature&&(v-=this.ele_selected.parentElement.querySelectorAll(".main-path").length-1,v<0&&(v=0));const a=g.slice(5),C=this.drawflow.drawflow[this.module].data[a].outputs[o].connections.findIndex(function(b,E){return b.node===h&&b.output===p});this.drawflow.drawflow[this.module].data[a].outputs[o].connections[C].points[v]={pos_x:d,pos_y:f};const m=this.ele_selected.parentElement.classList[2].slice(9);this.updateConnectionNodes(m)}t.type==="touchmove"&&(this.mouse_x=s,this.mouse_y=e),this.dispatch("mouseMove",{x:s,y:e})}dragEnd(t){if(t.type==="touchend")var s=this.mouse_x,e=this.mouse_y,i=document.elementFromPoint(s,e);else s=t.clientX,e=t.clientY,i=t.target;if(this.drag&&(this.pos_x_start==s&&this.pos_y_start==e||this.dispatch("nodeMoved",this.ele_selected.id.slice(5))),this.drag_point&&(this.ele_selected.classList.remove("selected"),this.pos_x_start==s&&this.pos_y_start==e||this.dispatch("rerouteMoved",this.ele_selected.parentElement.classList[2].slice(14))),this.editor_selected&&(this.canvas_x=this.canvas_x+-(this.pos_x-s),this.canvas_y=this.canvas_y+-(this.pos_y-e),this.editor_selected=!1),this.connection===!0)if(i.classList[0]==="input"||this.force_first_input&&(i.closest(".drawflow_content_node")!=null||i.classList[0]==="drawflow-node")){if(!this.force_first_input||i.closest(".drawflow_content_node")==null&&i.classList[0]!=="drawflow-node")n=i.parentElement.parentElement.id,d=i.classList[1];else{if(i.closest(".drawflow_content_node")!=null)var n=i.closest(".drawflow_content_node").parentElement.id;else var n=i.id;if(Object.keys(this.getNodeFromId(n.slice(5)).inputs).length===0)var d=!1;else var d="input_1"}var f=this.ele_selected.parentElement.parentElement.id,g=this.ele_selected.classList[1];if(f!==n&&d!==!1){if(this.container.querySelectorAll(".connection.node_in_"+n+".node_out_"+f+"."+g+"."+d).length===0){this.connection_ele.classList.add("node_in_"+n),this.connection_ele.classList.add("node_out_"+f),this.connection_ele.classList.add(g),this.connection_ele.classList.add(d);var h=n.slice(5),o=f.slice(5);this.drawflow.drawflow[this.module].data[o].outputs[g].connections.push({node:h,output:d}),this.drawflow.drawflow[this.module].data[h].inputs[d].connections.push({node:o,input:g}),this.updateConnectionNodes("node-"+o),this.updateConnectionNodes("node-"+h),this.dispatch("connectionCreated",{output_id:o,input_id:h,output_class:g,input_class:d})}else this.dispatch("connectionCancel",!0),this.connection_ele.remove();this.connection_ele=null}else this.dispatch("connectionCancel",!0),this.connection_ele.remove(),this.connection_ele=null}else this.dispatch("connectionCancel",!0),this.connection_ele.remove(),this.connection_ele=null;this.drag=!1,this.drag_point=!1,this.connection=!1,this.ele_selected=null,this.editor_selected=!1,this.dispatch("mouseUp",t)}contextmenu(t){if(this.dispatch("contextmenu",t),t.preventDefault(),this.editor_mode==="fixed"||this.editor_mode==="view")return!1;if(this.precanvas.getElementsByClassName("drawflow-delete").length&&this.precanvas.getElementsByClassName("drawflow-delete")[0].remove(),this.node_selected||this.connection_selected){var s=document.createElement("div");s.classList.add("drawflow-delete"),s.innerHTML="x",this.node_selected&&this.node_selected.appendChild(s),this.connection_selected&&this.connection_selected.parentElement.classList.length>1&&(s.style.top=t.clientY*(this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom))-this.precanvas.getBoundingClientRect().y*(this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom))+"px",s.style.left=t.clientX*(this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom))-this.precanvas.getBoundingClientRect().x*(this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom))+"px",this.precanvas.appendChild(s))}}contextmenuDel(){this.precanvas.getElementsByClassName("drawflow-delete").length&&this.precanvas.getElementsByClassName("drawflow-delete")[0].remove()}key(t){if(this.dispatch("keydown",t),this.editor_mode==="fixed"||this.editor_mode==="view")return!1;(t.key==="Delete"||t.key==="Backspace"&&t.metaKey)&&(this.node_selected!=null&&this.first_click.tagName!=="INPUT"&&this.first_click.tagName!=="TEXTAREA"&&this.first_click.hasAttribute("contenteditable")!==!0&&this.removeNodeId(this.node_selected.id),this.connection_selected!=null&&this.removeConnection())}zoom_enter(t,s){t.ctrlKey&&(t.preventDefault(),t.deltaY>0?this.zoom_out():this.zoom_in())}zoom_refresh(){this.dispatch("zoom",this.zoom),this.canvas_x=this.canvas_x/this.zoom_last_value*this.zoom,this.canvas_y=this.canvas_y/this.zoom_last_value*this.zoom,this.zoom_last_value=this.zoom,this.precanvas.style.transform="translate("+this.canvas_x+"px, "+this.canvas_y+"px) scale("+this.zoom+")"}zoom_in(){this.zoom<this.zoom_max&&(this.zoom+=this.zoom_value,this.zoom_refresh())}zoom_out(){this.zoom>this.zoom_min&&(this.zoom-=this.zoom_value,this.zoom_refresh())}zoom_reset(){this.zoom!=1&&(this.zoom=1,this.zoom_refresh())}createCurvature(t,s,e,i,n,d){var f=t,g=s,h=e,o=i,p=n;switch(d){case"open":if(t>=e)var v=f+Math.abs(h-f)*p,a=h-Math.abs(h-f)*(-1*p);else v=f+Math.abs(h-f)*p,a=h-Math.abs(h-f)*p;return" M "+f+" "+g+" C "+v+" "+g+" "+a+" "+o+" "+h+"  "+o;case"close":return t>=e?(v=f+Math.abs(h-f)*(-1*p),a=h-Math.abs(h-f)*p):(v=f+Math.abs(h-f)*p,a=h-Math.abs(h-f)*p)," M "+f+" "+g+" C "+v+" "+g+" "+a+" "+o+" "+h+"  "+o;case"other":return t>=e?(v=f+Math.abs(h-f)*(-1*p),a=h-Math.abs(h-f)*(-1*p)):(v=f+Math.abs(h-f)*p,a=h-Math.abs(h-f)*p)," M "+f+" "+g+" C "+v+" "+g+" "+a+" "+o+" "+h+"  "+o;default:return" M "+f+" "+g+" C "+(v=f+Math.abs(h-f)*p)+" "+g+" "+(a=h-Math.abs(h-f)*p)+" "+o+" "+h+"  "+o}}drawConnection(t){var s=document.createElementNS("http://www.w3.org/2000/svg","svg");this.connection_ele=s;var e=document.createElementNS("http://www.w3.org/2000/svg","path");e.classList.add("main-path"),e.setAttributeNS(null,"d",""),s.classList.add("connection"),s.appendChild(e),this.precanvas.appendChild(s);var i=t.parentElement.parentElement.id.slice(5),n=t.classList[1];this.dispatch("connectionStart",{output_id:i,output_class:n})}updateConnection(t,s){const e=this.precanvas,i=this.zoom;let n=e.clientWidth/(e.clientWidth*i);n=n||0;let d=e.clientHeight/(e.clientHeight*i);d=d||0;var f=this.connection_ele.children[0],g=this.ele_selected.offsetWidth/2+(this.ele_selected.getBoundingClientRect().x-e.getBoundingClientRect().x)*n,h=this.ele_selected.offsetHeight/2+(this.ele_selected.getBoundingClientRect().y-e.getBoundingClientRect().y)*d,o=t*(this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom))-this.precanvas.getBoundingClientRect().x*(this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom)),p=s*(this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom))-this.precanvas.getBoundingClientRect().y*(this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom)),v=this.curvature,a=this.createCurvature(g,h,o,p,v,"openclose");f.setAttributeNS(null,"d",a)}addConnection(t,s,e,i){var n=this.getModuleFromNodeId(t);if(n===this.getModuleFromNodeId(s)){var d=this.getNodeFromId(t),f=!1;for(var g in d.outputs[e].connections){var h=d.outputs[e].connections[g];h.node==s&&h.output==i&&(f=!0)}if(f===!1){if(this.drawflow.drawflow[n].data[t].outputs[e].connections.push({node:s.toString(),output:i}),this.drawflow.drawflow[n].data[s].inputs[i].connections.push({node:t.toString(),input:e}),this.module===n){var o=document.createElementNS("http://www.w3.org/2000/svg","svg"),p=document.createElementNS("http://www.w3.org/2000/svg","path");p.classList.add("main-path"),p.setAttributeNS(null,"d",""),o.classList.add("connection"),o.classList.add("node_in_node-"+s),o.classList.add("node_out_node-"+t),o.classList.add(e),o.classList.add(i),o.appendChild(p),this.precanvas.appendChild(o),this.updateConnectionNodes("node-"+t),this.updateConnectionNodes("node-"+s)}this.dispatch("connectionCreated",{output_id:t,input_id:s,output_class:e,input_class:i})}}}updateConnectionNodes(t){const s="node_in_"+t,e="node_out_"+t;this.line_path;const i=this.container,n=this.precanvas,d=this.curvature,f=this.createCurvature,g=this.reroute_curvature,h=this.reroute_curvature_start_end,o=this.reroute_fix_curvature,p=this.reroute_width,v=this.zoom;let a=n.clientWidth/(n.clientWidth*v);a=a||0;let C=n.clientHeight/(n.clientHeight*v);C=C||0;const m=i.querySelectorAll("."+e);Object.keys(m).map(function(E,q){if(m[E].querySelector(".point")===null){var L=i.querySelector("#"+t),R=m[E].classList[1].replace("node_in_",""),F=i.querySelector("#"+R).querySelectorAll("."+m[E].classList[4])[0],K=F.offsetWidth/2+(F.getBoundingClientRect().x-n.getBoundingClientRect().x)*a,Y=F.offsetHeight/2+(F.getBoundingClientRect().y-n.getBoundingClientRect().y)*C,st=L.querySelectorAll("."+m[E].classList[3])[0],nt=st.offsetWidth/2+(st.getBoundingClientRect().x-n.getBoundingClientRect().x)*a,Z=st.offsetHeight/2+(st.getBoundingClientRect().y-n.getBoundingClientRect().y)*C;const P=f(nt,Z,K,Y,d,"openclose");m[E].children[0].setAttributeNS(null,"d",P)}else{const P=m[E].querySelectorAll(".point");let $="";const H=[];P.forEach((M,I)=>{if(I===0&&P.length-1==0){var T=i.querySelector("#"+t),j=((V=M).getBoundingClientRect().x-n.getBoundingClientRect().x)*a+p,O=(V.getBoundingClientRect().y-n.getBoundingClientRect().y)*C+p,D=(J=T.querySelectorAll("."+M.parentElement.classList[3])[0]).offsetWidth/2+(J.getBoundingClientRect().x-n.getBoundingClientRect().x)*a,z=J.offsetHeight/2+(J.getBoundingClientRect().y-n.getBoundingClientRect().y)*C,W=f(D,z,j,O,h,"open");$+=W,H.push(W),T=M;var tt=M.parentElement.classList[1].replace("node_in_",""),V=(Q=i.querySelector("#"+tt)).querySelectorAll("."+M.parentElement.classList[4])[0];j=(it=Q.querySelectorAll("."+M.parentElement.classList[4])[0]).offsetWidth/2+(it.getBoundingClientRect().x-n.getBoundingClientRect().x)*a,O=it.offsetHeight/2+(it.getBoundingClientRect().y-n.getBoundingClientRect().y)*C,D=(T.getBoundingClientRect().x-n.getBoundingClientRect().x)*a+p,z=(T.getBoundingClientRect().y-n.getBoundingClientRect().y)*C+p,W=f(D,z,j,O,h,"close"),$+=W,H.push(W)}else if(I===0){var J;T=i.querySelector("#"+t),j=((V=M).getBoundingClientRect().x-n.getBoundingClientRect().x)*a+p,O=(V.getBoundingClientRect().y-n.getBoundingClientRect().y)*C+p,D=(J=T.querySelectorAll("."+M.parentElement.classList[3])[0]).offsetWidth/2+(J.getBoundingClientRect().x-n.getBoundingClientRect().x)*a,z=J.offsetHeight/2+(J.getBoundingClientRect().y-n.getBoundingClientRect().y)*C,W=f(D,z,j,O,h,"open"),$+=W,H.push(W),T=M,j=((V=P[I+1]).getBoundingClientRect().x-n.getBoundingClientRect().x)*a+p,O=(V.getBoundingClientRect().y-n.getBoundingClientRect().y)*C+p,D=(T.getBoundingClientRect().x-n.getBoundingClientRect().x)*a+p,z=(T.getBoundingClientRect().y-n.getBoundingClientRect().y)*C+p,W=f(D,z,j,O,g,"other"),$+=W,H.push(W)}else if(I===P.length-1){var Q,it;T=M,tt=M.parentElement.classList[1].replace("node_in_",""),V=(Q=i.querySelector("#"+tt)).querySelectorAll("."+M.parentElement.classList[4])[0],j=(it=Q.querySelectorAll("."+M.parentElement.classList[4])[0]).offsetWidth/2+(it.getBoundingClientRect().x-n.getBoundingClientRect().x)*a,O=it.offsetHeight/2+(it.getBoundingClientRect().y-n.getBoundingClientRect().y)*C,D=(T.getBoundingClientRect().x-n.getBoundingClientRect().x)*(n.clientWidth/(n.clientWidth*v))+p,z=(T.getBoundingClientRect().y-n.getBoundingClientRect().y)*(n.clientHeight/(n.clientHeight*v))+p,W=f(D,z,j,O,h,"close"),$+=W,H.push(W)}else T=M,j=((V=P[I+1]).getBoundingClientRect().x-n.getBoundingClientRect().x)*(n.clientWidth/(n.clientWidth*v))+p,O=(V.getBoundingClientRect().y-n.getBoundingClientRect().y)*(n.clientHeight/(n.clientHeight*v))+p,D=(T.getBoundingClientRect().x-n.getBoundingClientRect().x)*(n.clientWidth/(n.clientWidth*v))+p,z=(T.getBoundingClientRect().y-n.getBoundingClientRect().y)*(n.clientHeight/(n.clientHeight*v))+p,W=f(D,z,j,O,g,"other"),$+=W,H.push(W)}),o?H.forEach((M,I)=>{m[E].children[I].setAttributeNS(null,"d",M)}):m[E].children[0].setAttributeNS(null,"d",$)}});const b=i.querySelectorAll("."+s);Object.keys(b).map(function(E,q){if(b[E].querySelector(".point")===null){var L=i.querySelector("#"+t),R=b[E].classList[2].replace("node_out_",""),F=i.querySelector("#"+R).querySelectorAll("."+b[E].classList[3])[0],K=F.offsetWidth/2+(F.getBoundingClientRect().x-n.getBoundingClientRect().x)*a,Y=F.offsetHeight/2+(F.getBoundingClientRect().y-n.getBoundingClientRect().y)*C,st=(L=L.querySelectorAll("."+b[E].classList[4])[0]).offsetWidth/2+(L.getBoundingClientRect().x-n.getBoundingClientRect().x)*a,nt=L.offsetHeight/2+(L.getBoundingClientRect().y-n.getBoundingClientRect().y)*C;const Z=f(K,Y,st,nt,d,"openclose");b[E].children[0].setAttributeNS(null,"d",Z)}else{const Z=b[E].querySelectorAll(".point");let P="";const $=[];Z.forEach((H,M)=>{if(M===0&&Z.length-1==0){var I=i.querySelector("#"+t),T=((tt=H).getBoundingClientRect().x-n.getBoundingClientRect().x)*a+p,j=(tt.getBoundingClientRect().y-n.getBoundingClientRect().y)*C+p,O=(Q=I.querySelectorAll("."+H.parentElement.classList[4])[0]).offsetWidth/2+(Q.getBoundingClientRect().x-n.getBoundingClientRect().x)*a,D=Q.offsetHeight/2+(Q.getBoundingClientRect().y-n.getBoundingClientRect().y)*C,z=f(T,j,O,D,h,"close");P+=z,$.push(z),I=H;var W=H.parentElement.classList[2].replace("node_out_",""),tt=(J=i.querySelector("#"+W)).querySelectorAll("."+H.parentElement.classList[3])[0];T=(V=J.querySelectorAll("."+H.parentElement.classList[3])[0]).offsetWidth/2+(V.getBoundingClientRect().x-n.getBoundingClientRect().x)*a,j=V.offsetHeight/2+(V.getBoundingClientRect().y-n.getBoundingClientRect().y)*C,O=(I.getBoundingClientRect().x-n.getBoundingClientRect().x)*a+p,D=(I.getBoundingClientRect().y-n.getBoundingClientRect().y)*C+p,z=f(T,j,O,D,h,"open"),P+=z,$.push(z)}else if(M===0){var V;I=H,W=H.parentElement.classList[2].replace("node_out_",""),tt=(J=i.querySelector("#"+W)).querySelectorAll("."+H.parentElement.classList[3])[0],T=(V=J.querySelectorAll("."+H.parentElement.classList[3])[0]).offsetWidth/2+(V.getBoundingClientRect().x-n.getBoundingClientRect().x)*a,j=V.offsetHeight/2+(V.getBoundingClientRect().y-n.getBoundingClientRect().y)*C,O=(I.getBoundingClientRect().x-n.getBoundingClientRect().x)*a+p,D=(I.getBoundingClientRect().y-n.getBoundingClientRect().y)*C+p,z=f(T,j,O,D,h,"open"),P+=z,$.push(z),I=H,O=((tt=Z[M+1]).getBoundingClientRect().x-n.getBoundingClientRect().x)*a+p,D=(tt.getBoundingClientRect().y-n.getBoundingClientRect().y)*C+p,T=(I.getBoundingClientRect().x-n.getBoundingClientRect().x)*a+p,j=(I.getBoundingClientRect().y-n.getBoundingClientRect().y)*C+p,z=f(T,j,O,D,g,"other"),P+=z,$.push(z)}else if(M===Z.length-1){var J,Q;I=H,W=H.parentElement.classList[1].replace("node_in_",""),tt=(J=i.querySelector("#"+W)).querySelectorAll("."+H.parentElement.classList[4])[0],O=(Q=J.querySelectorAll("."+H.parentElement.classList[4])[0]).offsetWidth/2+(Q.getBoundingClientRect().x-n.getBoundingClientRect().x)*a,D=Q.offsetHeight/2+(Q.getBoundingClientRect().y-n.getBoundingClientRect().y)*C,T=(I.getBoundingClientRect().x-n.getBoundingClientRect().x)*a+p,j=(I.getBoundingClientRect().y-n.getBoundingClientRect().y)*C+p,z=f(T,j,O,D,h,"close"),P+=z,$.push(z)}else I=H,O=((tt=Z[M+1]).getBoundingClientRect().x-n.getBoundingClientRect().x)*a+p,D=(tt.getBoundingClientRect().y-n.getBoundingClientRect().y)*C+p,T=(I.getBoundingClientRect().x-n.getBoundingClientRect().x)*a+p,j=(I.getBoundingClientRect().y-n.getBoundingClientRect().y)*C+p,z=f(T,j,O,D,g,"other"),P+=z,$.push(z)}),o?$.forEach((H,M)=>{b[E].children[M].setAttributeNS(null,"d",H)}):b[E].children[0].setAttributeNS(null,"d",P)}})}dblclick(t){this.connection_selected!=null&&this.reroute&&this.createReroutePoint(this.connection_selected),t.target.classList[0]==="point"&&this.removeReroutePoint(t.target)}createReroutePoint(t){this.connection_selected.classList.remove("selected");const s=this.connection_selected.parentElement.classList[2].slice(9),e=this.connection_selected.parentElement.classList[1].slice(13),i=this.connection_selected.parentElement.classList[3],n=this.connection_selected.parentElement.classList[4];this.connection_selected=null;const d=document.createElementNS("http://www.w3.org/2000/svg","circle");d.classList.add("point");var f=this.pos_x*(this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom))-this.precanvas.getBoundingClientRect().x*(this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom)),g=this.pos_y*(this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom))-this.precanvas.getBoundingClientRect().y*(this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom));d.setAttributeNS(null,"cx",f),d.setAttributeNS(null,"cy",g),d.setAttributeNS(null,"r",this.reroute_width);let h=0;if(this.reroute_fix_curvature){const a=t.parentElement.querySelectorAll(".main-path").length;var o=document.createElementNS("http://www.w3.org/2000/svg","path");if(o.classList.add("main-path"),o.setAttributeNS(null,"d",""),t.parentElement.insertBefore(o,t.parentElement.children[a]),a===1)t.parentElement.appendChild(d);else{const C=Array.from(t.parentElement.children).indexOf(t);h=C,t.parentElement.insertBefore(d,t.parentElement.children[C+a+1])}}else t.parentElement.appendChild(d);const p=s.slice(5),v=this.drawflow.drawflow[this.module].data[p].outputs[i].connections.findIndex(function(a,C){return a.node===e&&a.output===n});this.drawflow.drawflow[this.module].data[p].outputs[i].connections[v].points===void 0&&(this.drawflow.drawflow[this.module].data[p].outputs[i].connections[v].points=[]),this.reroute_fix_curvature?(h>0||this.drawflow.drawflow[this.module].data[p].outputs[i].connections[v].points!==[]?this.drawflow.drawflow[this.module].data[p].outputs[i].connections[v].points.splice(h,0,{pos_x:f,pos_y:g}):this.drawflow.drawflow[this.module].data[p].outputs[i].connections[v].points.push({pos_x:f,pos_y:g}),t.parentElement.querySelectorAll(".main-path").forEach((a,C)=>{a.classList.remove("selected")})):this.drawflow.drawflow[this.module].data[p].outputs[i].connections[v].points.push({pos_x:f,pos_y:g}),this.dispatch("addReroute",p),this.updateConnectionNodes(s)}removeReroutePoint(t){const s=t.parentElement.classList[2].slice(9),e=t.parentElement.classList[1].slice(13),i=t.parentElement.classList[3],n=t.parentElement.classList[4];let d=Array.from(t.parentElement.children).indexOf(t);const f=s.slice(5),g=this.drawflow.drawflow[this.module].data[f].outputs[i].connections.findIndex(function(h,o){return h.node===e&&h.output===n});if(this.reroute_fix_curvature){const h=t.parentElement.querySelectorAll(".main-path").length;t.parentElement.children[h-1].remove(),d-=h,d<0&&(d=0)}else d--;this.drawflow.drawflow[this.module].data[f].outputs[i].connections[g].points.splice(d,1),t.remove(),this.dispatch("removeReroute",f),this.updateConnectionNodes(s)}registerNode(t,s,e=null,i=null){this.noderegister[t]={html:s,props:e,options:i}}getNodeFromId(t){var s=this.getModuleFromNodeId(t);return JSON.parse(JSON.stringify(this.drawflow.drawflow[s].data[t]))}getNodesFromName(t){var s=[];const e=this.drawflow.drawflow;return Object.keys(e).map(function(i,n){for(var d in e[i].data)e[i].data[d].name==t&&s.push(e[i].data[d].id)}),s}addNode(t,s,e,i,n,d,f,g,h=!1){if(this.useuuid)var o=this.getUuid();else o=this.nodeId;const p=document.createElement("div");p.classList.add("parent-node");const v=document.createElement("div");v.innerHTML="",v.setAttribute("id","node-"+o),v.classList.add("drawflow-node"),d!=""&&v.classList.add(...d.split(" "));const a=document.createElement("div");a.classList.add("inputs");const C=document.createElement("div");C.classList.add("outputs");const m={};for(var b=0;b<s;b++){const R=document.createElement("div");R.classList.add("input"),R.classList.add("input_"+(b+1)),m["input_"+(b+1)]={connections:[]},a.appendChild(R)}const E={};for(b=0;b<e;b++){const R=document.createElement("div");R.classList.add("output"),R.classList.add("output_"+(b+1)),E["output_"+(b+1)]={connections:[]},C.appendChild(R)}const q=document.createElement("div");if(q.classList.add("drawflow_content_node"),h===!1)q.innerHTML=g;else if(h===!0)q.appendChild(this.noderegister[g].html.cloneNode(!0));else if(parseInt(this.render.version)===3){let R=this.render.h(this.noderegister[g].html,this.noderegister[g].props,this.noderegister[g].options);R.appContext=this.parent,this.render.render(R,q)}else{let R=new this.render({parent:this.parent,render:F=>F(this.noderegister[g].html,{props:this.noderegister[g].props}),...this.noderegister[g].options}).$mount();q.appendChild(R.$el)}Object.entries(f).forEach(function(R,F){if(typeof R[1]=="object")(function st(nt,Z,P){nt===null?nt=f[Z]:nt=nt[Z],nt!==null&&Object.entries(nt).forEach(function($,H){if(typeof $[1]=="object")st(nt,$[0],P+"-"+$[0]);else for(var M=q.querySelectorAll("[df-"+P+"-"+$[0]+"]"),I=0;I<M.length;I++)M[I].value=$[1],M[I].isContentEditable&&(M[I].innerText=$[1])})})(null,R[0],R[0]);else for(var K=q.querySelectorAll("[df-"+R[0]+"]"),Y=0;Y<K.length;Y++)K[Y].value=R[1],K[Y].isContentEditable&&(K[Y].innerText=R[1])}),v.appendChild(a),v.appendChild(q),v.appendChild(C),v.style.top=n+"px",v.style.left=i+"px",p.appendChild(v),this.precanvas.appendChild(p);var L={id:o,name:t,data:f,class:d,html:g,typenode:h,inputs:m,outputs:E,pos_x:i,pos_y:n};return this.drawflow.drawflow[this.module].data[o]=L,this.dispatch("nodeCreated",o),this.useuuid||this.nodeId++,o}addNodeImport(t,s){const e=document.createElement("div");e.classList.add("parent-node");const i=document.createElement("div");i.innerHTML="",i.setAttribute("id","node-"+t.id),i.classList.add("drawflow-node"),t.class!=""&&i.classList.add(...t.class.split(" "));const n=document.createElement("div");n.classList.add("inputs");const d=document.createElement("div");d.classList.add("outputs"),Object.keys(t.inputs).map(function(h,o){const p=document.createElement("div");p.classList.add("input"),p.classList.add(h),n.appendChild(p),Object.keys(t.inputs[h].connections).map(function(v,a){var C=document.createElementNS("http://www.w3.org/2000/svg","svg"),m=document.createElementNS("http://www.w3.org/2000/svg","path");m.classList.add("main-path"),m.setAttributeNS(null,"d",""),C.classList.add("connection"),C.classList.add("node_in_node-"+t.id),C.classList.add("node_out_node-"+t.inputs[h].connections[v].node),C.classList.add(t.inputs[h].connections[v].input),C.classList.add(h),C.appendChild(m),s.appendChild(C)})});for(var f=0;f<Object.keys(t.outputs).length;f++){const h=document.createElement("div");h.classList.add("output"),h.classList.add("output_"+(f+1)),d.appendChild(h)}const g=document.createElement("div");if(g.classList.add("drawflow_content_node"),t.typenode===!1)g.innerHTML=t.html;else if(t.typenode===!0)g.appendChild(this.noderegister[t.html].html.cloneNode(!0));else if(parseInt(this.render.version)===3){let h=this.render.h(this.noderegister[t.html].html,this.noderegister[t.html].props,this.noderegister[t.html].options);h.appContext=this.parent,this.render.render(h,g)}else{let h=new this.render({parent:this.parent,render:o=>o(this.noderegister[t.html].html,{props:this.noderegister[t.html].props}),...this.noderegister[t.html].options}).$mount();g.appendChild(h.$el)}Object.entries(t.data).forEach(function(h,o){if(typeof h[1]=="object")(function a(C,m,b){C===null?C=t.data[m]:C=C[m],C!==null&&Object.entries(C).forEach(function(E,q){if(typeof E[1]=="object")a(C,E[0],b+"-"+E[0]);else for(var L=g.querySelectorAll("[df-"+b+"-"+E[0]+"]"),R=0;R<L.length;R++)L[R].value=E[1],L[R].isContentEditable&&(L[R].innerText=E[1])})})(null,h[0],h[0]);else for(var p=g.querySelectorAll("[df-"+h[0]+"]"),v=0;v<p.length;v++)p[v].value=h[1],p[v].isContentEditable&&(p[v].innerText=h[1])}),i.appendChild(n),i.appendChild(g),i.appendChild(d),i.style.top=t.pos_y+"px",i.style.left=t.pos_x+"px",e.appendChild(i),this.precanvas.appendChild(e)}addRerouteImport(t){const s=this.reroute_width,e=this.reroute_fix_curvature,i=this.container;Object.keys(t.outputs).map(function(n,d){Object.keys(t.outputs[n].connections).map(function(f,g){const h=t.outputs[n].connections[f].points;h!==void 0&&h.forEach((o,p)=>{const v=t.outputs[n].connections[f].node,a=t.outputs[n].connections[f].output,C=i.querySelector(".connection.node_in_node-"+v+".node_out_node-"+t.id+"."+n+"."+a);if(e&&p===0)for(var m=0;m<h.length;m++){var b=document.createElementNS("http://www.w3.org/2000/svg","path");b.classList.add("main-path"),b.setAttributeNS(null,"d",""),C.appendChild(b)}const E=document.createElementNS("http://www.w3.org/2000/svg","circle");E.classList.add("point");var q=o.pos_x,L=o.pos_y;E.setAttributeNS(null,"cx",q),E.setAttributeNS(null,"cy",L),E.setAttributeNS(null,"r",s),C.appendChild(E)})})})}updateNodeValue(t){for(var s=t.target.attributes,e=0;e<s.length;e++)if(s[e].nodeName.startsWith("df-")){for(var i=s[e].nodeName.slice(3).split("-"),n=this.drawflow.drawflow[this.module].data[t.target.closest(".drawflow_content_node").parentElement.id.slice(5)].data,d=0;d<i.length-1;d+=1)n[i[d]]==null&&(n[i[d]]={}),n=n[i[d]];n[i[i.length-1]]=t.target.value,t.target.isContentEditable&&(n[i[i.length-1]]=t.target.innerText),this.dispatch("nodeDataChanged",t.target.closest(".drawflow_content_node").parentElement.id.slice(5))}}updateNodeDataFromId(t,s){var e=this.getModuleFromNodeId(t);if(this.drawflow.drawflow[e].data[t].data=s,this.module===e){const i=this.container.querySelector("#node-"+t);Object.entries(s).forEach(function(n,d){if(typeof n[1]=="object")(function h(o,p,v){o===null?o=s[p]:o=o[p],o!==null&&Object.entries(o).forEach(function(a,C){if(typeof a[1]=="object")h(o,a[0],v+"-"+a[0]);else for(var m=i.querySelectorAll("[df-"+v+"-"+a[0]+"]"),b=0;b<m.length;b++)m[b].value=a[1],m[b].isContentEditable&&(m[b].innerText=a[1])})})(null,n[0],n[0]);else for(var f=i.querySelectorAll("[df-"+n[0]+"]"),g=0;g<f.length;g++)f[g].value=n[1],f[g].isContentEditable&&(f[g].innerText=n[1])})}}addNodeInput(t){var s=this.getModuleFromNodeId(t);const e=this.getNodeFromId(t),i=Object.keys(e.inputs).length;if(this.module===s){const n=document.createElement("div");n.classList.add("input"),n.classList.add("input_"+(i+1)),this.container.querySelector("#node-"+t+" .inputs").appendChild(n),this.updateConnectionNodes("node-"+t)}this.drawflow.drawflow[s].data[t].inputs["input_"+(i+1)]={connections:[]}}addNodeOutput(t){var s=this.getModuleFromNodeId(t);const e=this.getNodeFromId(t),i=Object.keys(e.outputs).length;if(this.module===s){const n=document.createElement("div");n.classList.add("output"),n.classList.add("output_"+(i+1)),this.container.querySelector("#node-"+t+" .outputs").appendChild(n),this.updateConnectionNodes("node-"+t)}this.drawflow.drawflow[s].data[t].outputs["output_"+(i+1)]={connections:[]}}removeNodeInput(t,s){var e=this.getModuleFromNodeId(t);const i=this.getNodeFromId(t);this.module===e&&this.container.querySelector("#node-"+t+" .inputs .input."+s).remove();const n=[];Object.keys(i.inputs[s].connections).map(function(o,p){const v=i.inputs[s].connections[p].node,a=i.inputs[s].connections[p].input;n.push({id_output:v,id:t,output_class:a,input_class:s})}),n.forEach((o,p)=>{this.removeSingleConnection(o.id_output,o.id,o.output_class,o.input_class)}),delete this.drawflow.drawflow[e].data[t].inputs[s];const d=[],f=this.drawflow.drawflow[e].data[t].inputs;Object.keys(f).map(function(o,p){d.push(f[o])}),this.drawflow.drawflow[e].data[t].inputs={};const g=s.slice(6);let h=[];d.forEach((o,p)=>{o.connections.forEach((v,a)=>{h.push(v)}),this.drawflow.drawflow[e].data[t].inputs["input_"+(p+1)]=o}),h=new Set(h.map(o=>JSON.stringify(o))),h=Array.from(h).map(o=>JSON.parse(o)),this.module===e&&this.container.querySelectorAll("#node-"+t+" .inputs .input").forEach((o,p)=>{const v=o.classList[1].slice(6);parseInt(g)<parseInt(v)&&(o.classList.remove("input_"+v),o.classList.add("input_"+(v-1)))}),h.forEach((o,p)=>{this.drawflow.drawflow[e].data[o.node].outputs[o.input].connections.forEach((v,a)=>{if(v.node==t){const C=v.output.slice(6);if(parseInt(g)<parseInt(C)){if(this.module===e){const m=this.container.querySelector(".connection.node_in_node-"+t+".node_out_node-"+o.node+"."+o.input+".input_"+C);m.classList.remove("input_"+C),m.classList.add("input_"+(C-1))}v.points?this.drawflow.drawflow[e].data[o.node].outputs[o.input].connections[a]={node:v.node,output:"input_"+(C-1),points:v.points}:this.drawflow.drawflow[e].data[o.node].outputs[o.input].connections[a]={node:v.node,output:"input_"+(C-1)}}}})}),this.updateConnectionNodes("node-"+t)}removeNodeOutput(t,s){var e=this.getModuleFromNodeId(t);const i=this.getNodeFromId(t);this.module===e&&this.container.querySelector("#node-"+t+" .outputs .output."+s).remove();const n=[];Object.keys(i.outputs[s].connections).map(function(o,p){const v=i.outputs[s].connections[p].node,a=i.outputs[s].connections[p].output;n.push({id:t,id_input:v,output_class:s,input_class:a})}),n.forEach((o,p)=>{this.removeSingleConnection(o.id,o.id_input,o.output_class,o.input_class)}),delete this.drawflow.drawflow[e].data[t].outputs[s];const d=[],f=this.drawflow.drawflow[e].data[t].outputs;Object.keys(f).map(function(o,p){d.push(f[o])}),this.drawflow.drawflow[e].data[t].outputs={};const g=s.slice(7);let h=[];d.forEach((o,p)=>{o.connections.forEach((v,a)=>{h.push({node:v.node,output:v.output})}),this.drawflow.drawflow[e].data[t].outputs["output_"+(p+1)]=o}),h=new Set(h.map(o=>JSON.stringify(o))),h=Array.from(h).map(o=>JSON.parse(o)),this.module===e&&this.container.querySelectorAll("#node-"+t+" .outputs .output").forEach((o,p)=>{const v=o.classList[1].slice(7);parseInt(g)<parseInt(v)&&(o.classList.remove("output_"+v),o.classList.add("output_"+(v-1)))}),h.forEach((o,p)=>{this.drawflow.drawflow[e].data[o.node].inputs[o.output].connections.forEach((v,a)=>{if(v.node==t){const C=v.input.slice(7);if(parseInt(g)<parseInt(C)){if(this.module===e){const m=this.container.querySelector(".connection.node_in_node-"+o.node+".node_out_node-"+t+".output_"+C+"."+o.output);m.classList.remove("output_"+C),m.classList.remove(o.output),m.classList.add("output_"+(C-1)),m.classList.add(o.output)}v.points?this.drawflow.drawflow[e].data[o.node].inputs[o.output].connections[a]={node:v.node,input:"output_"+(C-1),points:v.points}:this.drawflow.drawflow[e].data[o.node].inputs[o.output].connections[a]={node:v.node,input:"output_"+(C-1)}}}})}),this.updateConnectionNodes("node-"+t)}removeNodeId(t){this.removeConnectionNodeId(t);var s=this.getModuleFromNodeId(t.slice(5));this.module===s&&this.container.querySelector("#"+t).remove(),delete this.drawflow.drawflow[s].data[t.slice(5)],this.dispatch("nodeRemoved",t.slice(5))}removeConnection(){if(this.connection_selected!=null){var t=this.connection_selected.parentElement.classList;this.connection_selected.parentElement.remove();var s=this.drawflow.drawflow[this.module].data[t[2].slice(14)].outputs[t[3]].connections.findIndex(function(i,n){return i.node===t[1].slice(13)&&i.output===t[4]});this.drawflow.drawflow[this.module].data[t[2].slice(14)].outputs[t[3]].connections.splice(s,1);var e=this.drawflow.drawflow[this.module].data[t[1].slice(13)].inputs[t[4]].connections.findIndex(function(i,n){return i.node===t[2].slice(14)&&i.input===t[3]});this.drawflow.drawflow[this.module].data[t[1].slice(13)].inputs[t[4]].connections.splice(e,1),this.dispatch("connectionRemoved",{output_id:t[2].slice(14),input_id:t[1].slice(13),output_class:t[3],input_class:t[4]}),this.connection_selected=null}}removeSingleConnection(t,s,e,i){var n=this.getModuleFromNodeId(t);if(n===this.getModuleFromNodeId(s)){if(this.drawflow.drawflow[n].data[t].outputs[e].connections.findIndex(function(g,h){return g.node==s&&g.output===i})>-1){this.module===n&&this.container.querySelector(".connection.node_in_node-"+s+".node_out_node-"+t+"."+e+"."+i).remove();var d=this.drawflow.drawflow[n].data[t].outputs[e].connections.findIndex(function(g,h){return g.node==s&&g.output===i});this.drawflow.drawflow[n].data[t].outputs[e].connections.splice(d,1);var f=this.drawflow.drawflow[n].data[s].inputs[i].connections.findIndex(function(g,h){return g.node==t&&g.input===e});return this.drawflow.drawflow[n].data[s].inputs[i].connections.splice(f,1),this.dispatch("connectionRemoved",{output_id:t,input_id:s,output_class:e,input_class:i}),!0}return!1}return!1}removeConnectionNodeId(t){const s="node_in_"+t,e="node_out_"+t,i=this.container.querySelectorAll("."+e);for(var n=i.length-1;n>=0;n--){var d=i[n].classList,f=this.drawflow.drawflow[this.module].data[d[1].slice(13)].inputs[d[4]].connections.findIndex(function(o,p){return o.node===d[2].slice(14)&&o.input===d[3]});this.drawflow.drawflow[this.module].data[d[1].slice(13)].inputs[d[4]].connections.splice(f,1);var g=this.drawflow.drawflow[this.module].data[d[2].slice(14)].outputs[d[3]].connections.findIndex(function(o,p){return o.node===d[1].slice(13)&&o.output===d[4]});this.drawflow.drawflow[this.module].data[d[2].slice(14)].outputs[d[3]].connections.splice(g,1),i[n].remove(),this.dispatch("connectionRemoved",{output_id:d[2].slice(14),input_id:d[1].slice(13),output_class:d[3],input_class:d[4]})}const h=this.container.querySelectorAll("."+s);for(n=h.length-1;n>=0;n--)d=h[n].classList,g=this.drawflow.drawflow[this.module].data[d[2].slice(14)].outputs[d[3]].connections.findIndex(function(o,p){return o.node===d[1].slice(13)&&o.output===d[4]}),this.drawflow.drawflow[this.module].data[d[2].slice(14)].outputs[d[3]].connections.splice(g,1),f=this.drawflow.drawflow[this.module].data[d[1].slice(13)].inputs[d[4]].connections.findIndex(function(o,p){return o.node===d[2].slice(14)&&o.input===d[3]}),this.drawflow.drawflow[this.module].data[d[1].slice(13)].inputs[d[4]].connections.splice(f,1),h[n].remove(),this.dispatch("connectionRemoved",{output_id:d[2].slice(14),input_id:d[1].slice(13),output_class:d[3],input_class:d[4]})}getModuleFromNodeId(t){var s;const e=this.drawflow.drawflow;return Object.keys(e).map(function(i,n){Object.keys(e[i].data).map(function(d,f){d==t&&(s=i)})}),s}addModule(t){this.drawflow.drawflow[t]={data:{}},this.dispatch("moduleCreated",t)}changeModule(t){this.dispatch("moduleChanged",t),this.module=t,this.precanvas.innerHTML="",this.canvas_x=0,this.canvas_y=0,this.pos_x=0,this.pos_y=0,this.mouse_x=0,this.mouse_y=0,this.zoom=1,this.zoom_last_value=1,this.precanvas.style.transform="",this.import(this.drawflow,!1)}removeModule(t){this.module===t&&this.changeModule("Home"),delete this.drawflow.drawflow[t],this.dispatch("moduleRemoved",t)}clearModuleSelected(){this.precanvas.innerHTML="",this.drawflow.drawflow[this.module]={data:{}}}clear(){this.precanvas.innerHTML="",this.drawflow={drawflow:{Home:{data:{}}}}}export(){const t=JSON.parse(JSON.stringify(this.drawflow));return this.dispatch("export",t),t}import(t,s=!0){this.clear(),this.drawflow=JSON.parse(JSON.stringify(t)),this.load(),s&&this.dispatch("import","import")}on(t,s){return typeof s!="function"?(console.error("The listener callback must be a function, the given type is "+typeof s),!1):typeof t!="string"?(console.error("The event name must be a string, the given type is "+typeof t),!1):(this.events[t]===void 0&&(this.events[t]={listeners:[]}),void this.events[t].listeners.push(s))}removeListener(t,s){if(!this.events[t])return!1;const e=this.events[t].listeners,i=e.indexOf(s);i>-1&&e.splice(i,1)}dispatch(t,s){if(this.events[t]===void 0)return!1;this.events[t].listeners.forEach(e=>{e(s)})}getUuid(){for(var t=[],s=0;s<36;s++)t[s]="0123456789abcdef".substr(Math.floor(16*Math.random()),1);return t[14]="4",t[19]="0123456789abcdef".substr(3&t[19]|8,1),t[8]=t[13]=t[18]=t[23]="-",t.join("")}}}]).default})})(Ft);var Zt=Ft.exports;const te=Xt(Zt);function ee(w){let l;return{c(){l=S("div"),this.h()},l(r){l=N(r,"DIV",{class:!0}),A(l).forEach(B),this.h()},h(){k(l,"class","parent-drawflow h-100 my-editor svelte-1jjj000")},m(r,c){G(r,l,c),w[1](l)},p:ot,i:ot,o:ot,d(r){r&&B(l),w[1](null)}}}function ne(w,l,r){let c;Ct(w,Lt,e=>r(3,c=e));let y,_,u=new Map,t=e=>{if(_)if(_.clear(),e.starts&&e.starts.length>0){if(console.log("drawing"),c!==void 0){console.log("using cache"),_.import(c),Object.values(e.map).map(n=>{if(n.drawId!==void 0){let d=_.getNodeFromId(n.drawId);u.set(n.id,{x:d.pos_x,y:d.pos_y})}});return}let i=Math.max(...e.ends.map(n=>e.map[n].earlyCol));for(let n=1;n<i+1;n++){let d=Object.keys(e.map).filter(f=>e.map[f].earlyCol==n);d.sort((f,g)=>e.map[f].slack>e.map[g].slack);for(let f=0;f<d.length;f++){let g=d[f],h=e.map[g],o="normal",p="bg-darkBlue";h.slack===0&&(o="critical",p="bg-darkSteel"),Number(h.progress)>=100&&(p="bg-emerald");let v=`
						<div class="heading `+p+'">'+h.name+`</div>
						<table style="width:99.9%;">
							<tr><th class="text-left third">Start</th><th>Duration</th><th class="text-right third">Finish</th></tr>
							<tr><td>`+h.es+'</td><td class="text-center va-middle" rowspan=2>'+h.expected+'</td><td class="text-right">'+h.ef+`</td></tr>
							<tr><td>`+h.ls+'</td><td class="text-right">'+h.lf+`</td></tr>
						</table>
						<hr/>
						<table style="width:99.9%;">
							<tr><th class="text-left third">Min</th><th>Likely</th><th class="text-right third">Max</th></tr>
							<tr><td>`+h.min+'</td><td class="text-center">'+h.likely+'</td><td class="text-right">'+h.max+`</td></tr>
						</table>
					`,a=u.get(h.id);a===void 0&&(a={x:20+400*(n-1),y:20+200*f});let C=40,m={x:a.x<0?-1:1,y:a.y<0?-1:1};a.x+=C/2*m.x,a.x-=Math.abs(a.x)%C*m.x,a.y+=C/2*m.y,a.y-=Math.abs(a.y)%C*m.y;let b=_.addNode(h.name,1,1,a.x,a.y,o,e.map[g],v);u.set(h.id,a),e.map[g].drawId=b,e.map[g].predecessors.map(E=>{let q=e.map[E].drawId;if(_.addConnection(q,b,"output_1","input_1"),e.map[E].slack===0&&e.map[g].slack===0){let L=document.getElementsByClassName("connection node_in_node-"+b+" node_out_node-"+q);L.length>0&&L[0].classList.add("critical")}})}}console.log("exporting to cache"),dt(Lt,c=_.export(),c)}else console.log("dont draw yet")};Pt(()=>{_=new te(y),_.draggable_inputs=!1,_.zoom_min=.2,_.start(),Yt.subscribe(e=>{setTimeout(()=>t(e),100)}),Jt.subscribe(e=>{e>0?_.zoom_in():e<0&&_.zoom_out()}),_.on("nodeMoved",function(e){dt(Lt,c=_.export(),c);let i=_.getNodeFromId(e);u.set(i.data.id,{x:i.pos_x,y:i.pos_y})})});function s(e){Vt[e?"unshift":"push"](()=>{y=e,r(0,y)})}return[y,s]}class se extends Et{constructor(l){super(),xt(this,l,ne,ee,bt,{})}}function St(w,l,r){const c=w.slice();return c[9]=l[r],c[10]=l,c[11]=r,c}function Nt(w,l,r){const c=w.slice();return c[12]=l[r],c}function kt(w,l,r){const c=w.slice();return c[9]=l[r],c[15]=l,c[16]=r,c}function It(w,l,r){const c=w.slice();return c[17]=l[r],c}function At(w){let l,r=w[17]+"",c;return{c(){l=S("th"),c=ht(r)},l(y){l=N(y,"TH",{});var _=A(l);c=ut(_,r),_.forEach(B)},m(y,_){G(y,l,_),x(l,c)},p(y,_){_&4&&r!==(r=y[17]+"")&&pt(c,r)},d(y){y&&B(l)}}}function Mt(w){let l,r,c,y;function _(){w[7].call(r,w[15],w[16])}return{c(){l=S("td"),r=S("input"),this.h()},l(u){l=N(u,"TD",{class:!0});var t=A(l);r=N(t,"INPUT",{type:!0,class:!0}),t.forEach(B),this.h()},h(){k(r,"type","text"),k(r,"class","metro-input svelte-1jpgd8u"),k(l,"class","svelte-1jpgd8u")},m(u,t){G(u,l,t),x(l,r),ct(r,w[9]),c||(y=[lt(r,"input",_),lt(r,"paste",w[4])],c=!0)},p(u,t){w=u,t&4&&r.value!==w[9]&&ct(r,w[9])},d(u){u&&B(l),c=!1,Rt(y)}}}function zt(w){let l,r,c='<span class="mif-cross-light"></span>',y,_=et(w[2].getRow(w[12])),u=[];for(let t=0;t<_.length;t+=1)u[t]=Mt(kt(w,_,t));return{c(){l=S("tr"),r=S("td"),r.innerHTML=c,y=U();for(let t=0;t<u.length;t+=1)u[t].c();this.h()},l(t){l=N(t,"TR",{});var s=A(l);r=N(s,"TD",{class:!0,"data-svelte-h":!0}),ft(r)!=="svelte-1fn4jfg"&&(r.innerHTML=c),y=X(s);for(let e=0;e<u.length;e+=1)u[e].l(s);s.forEach(B),this.h()},h(){k(r,"class","svelte-1jpgd8u")},m(t,s){G(t,l,s),x(l,r),x(l,y);for(let e=0;e<u.length;e+=1)u[e]&&u[e].m(l,null)},p(t,s){if(s&20){_=et(t[2].getRow(t[12]));let e;for(e=0;e<_.length;e+=1){const i=kt(t,_,e);u[e]?u[e].p(i,s):(u[e]=Mt(i),u[e].c(),u[e].m(l,null))}for(;e<u.length;e+=1)u[e].d(1);u.length=_.length}},d(t){t&&B(l),at(u,t)}}}function Ht(w){let l,r,c,y;function _(){w[8].call(r,w[10],w[11])}return{c(){l=S("td"),r=S("input"),this.h()},l(u){l=N(u,"TD",{class:!0});var t=A(l);r=N(t,"INPUT",{type:!0,class:!0}),t.forEach(B),this.h()},h(){k(r,"type","text"),k(r,"class","metro-input svelte-1jpgd8u"),k(l,"class","svelte-1jpgd8u")},m(u,t){G(u,l,t),x(l,r),ct(r,w[9]),c||(y=[lt(r,"input",_),lt(r,"paste",w[4]),lt(r,"blur",w[5])],c=!0)},p(u,t){w=u,t&2&&r.value!==w[9]&&ct(r,w[9])},d(u){u&&B(l),c=!1,Rt(y)}}}function ie(w){let l,r,c,y,_,u,t,s,e,i,n='<span class="mif-chevron-thin-right"></span>',d,f=et(w[2].getHeader()),g=[];for(let a=0;a<f.length;a+=1)g[a]=At(It(w,f,a));let h=et(w[2].getAllIds()),o=[];for(let a=0;a<h.length;a+=1)o[a]=zt(Nt(w,h,a));let p=et(w[1]),v=[];for(let a=0;a<p.length;a+=1)v[a]=Ht(St(w,p,a));return{c(){l=S("table"),r=S("thead"),c=S("tr"),y=S("th"),_=U();for(let a=0;a<g.length;a+=1)g[a].c();u=U(),t=S("tbody");for(let a=0;a<o.length;a+=1)o[a].c();s=U(),e=S("tr"),i=S("td"),i.innerHTML=n,d=U();for(let a=0;a<v.length;a+=1)v[a].c();this.h()},l(a){l=N(a,"TABLE",{class:!0});var C=A(l);r=N(C,"THEAD",{});var m=A(r);c=N(m,"TR",{});var b=A(c);y=N(b,"TH",{}),A(y).forEach(B),_=X(b);for(let L=0;L<g.length;L+=1)g[L].l(b);b.forEach(B),m.forEach(B),u=X(C),t=N(C,"TBODY",{});var E=A(t);for(let L=0;L<o.length;L+=1)o[L].l(E);s=X(E),e=N(E,"TR",{});var q=A(e);i=N(q,"TD",{class:!0,"data-svelte-h":!0}),ft(i)!=="svelte-qk2oid"&&(i.innerHTML=n),d=X(q);for(let L=0;L<v.length;L+=1)v[L].l(q);q.forEach(B),E.forEach(B),C.forEach(B),this.h()},h(){k(i,"class","svelte-1jpgd8u"),k(l,"class","table subcompact table-border cell-border striped")},m(a,C){G(a,l,C),x(l,r),x(r,c),x(c,y),x(c,_);for(let m=0;m<g.length;m+=1)g[m]&&g[m].m(c,null);x(l,u),x(l,t);for(let m=0;m<o.length;m+=1)o[m]&&o[m].m(t,null);x(t,s),x(t,e),x(e,i),x(e,d);for(let m=0;m<v.length;m+=1)v[m]&&v[m].m(e,null)},p(a,[C]){if(C&4){f=et(a[2].getHeader());let m;for(m=0;m<f.length;m+=1){const b=It(a,f,m);g[m]?g[m].p(b,C):(g[m]=At(b),g[m].c(),g[m].m(c,null))}for(;m<g.length;m+=1)g[m].d(1);g.length=f.length}if(C&20){h=et(a[2].getAllIds());let m;for(m=0;m<h.length;m+=1){const b=Nt(a,h,m);o[m]?o[m].p(b,C):(o[m]=zt(b),o[m].c(),o[m].m(t,s))}for(;m<o.length;m+=1)o[m].d(1);o.length=h.length}if(C&50){p=et(a[1]);let m;for(m=0;m<p.length;m+=1){const b=St(a,p,m);v[m]?v[m].p(b,C):(v[m]=Ht(b),v[m].c(),v[m].m(e,null))}for(;m<v.length;m+=1)v[m].d(1);v.length=p.length}},i:ot,o:ot,d(a){a&&B(l),at(g,a),at(o,a),at(v,a)}}}function oe(w,l,r){let c,y,{name:_}=l,u=Gt(_);Ct(w,u,d=>r(2,y=d));let t=Qt(Array(y.getHeader().length).fill(""));Ct(w,t,d=>r(1,c=d)),t.reset=()=>t.update(d=>Array(y.getHeader().length).fill(""));function s(d){d.preventDefault();let g=(d.clipboardData||window.clipboardData).getData("text").split(/\n|\r/).filter(h=>h.length).map(h=>h.split(/\t/));u.update(h=>{let o=new Kt(g[0]);return g.slice(1).forEach(p=>{o.add_or_replace_row(p[0],p)}),o}),t.reset()}function e(){if(c.join("")===""){console.log("empty buffer, skipping");return}u.update(d=>(d.add_or_replace_row(c[0],c),d)),t.reset()}function i(d,f){d[f]=this.value}function n(d,f){d[f]=this.value,t.set(c)}return w.$$set=d=>{"name"in d&&r(6,_=d.name)},[t,c,y,u,s,e,_,i,n]}class Tt extends Et{constructor(l){super(),xt(this,l,oe,ie,bt,{name:6})}}function qt(w,l,r){const c=w.slice();return c[6]=l[r],c[7]=l,c[8]=r,c}function jt(w,l,r){const c=w.slice();c[9]=l[r];const y=re(c[9]);return c[10]=y,c}function Ot(w){let l,r,c,y,_,u,t,s,e=w[6].isEditing?"Save":"Edit",i,n,d,f='<span class="mif-bin"></span>',g,h,o,p,v;function a(L,R){if(L[6].isEditing)return ae;if(L[6].content)return le}let C=a(w),m=C&&C(w),b=w[6].tool_calls&&w[6].tool_calls.length>0&&Dt(w);function E(){return w[4](w[8])}function q(){return w[5](w[8])}return{c(){l=S("div"),r=S("div"),m&&m.c(),c=U(),b&&b.c(),y=U(),_=S("div"),u=S("button"),t=S("span"),s=U(),i=ht(e),n=U(),d=S("button"),d.innerHTML=f,h=U(),this.h()},l(L){l=N(L,"DIV",{class:!0});var R=A(l);r=N(R,"DIV",{class:!0});var F=A(r);m&&m.l(F),c=X(F),b&&b.l(F),y=X(F),_=N(F,"DIV",{class:!0});var K=A(_);u=N(K,"BUTTON",{class:!0});var Y=A(u);t=N(Y,"SPAN",{class:!0}),A(t).forEach(B),s=X(Y),i=ut(Y,e),Y.forEach(B),n=X(K),d=N(K,"BUTTON",{class:!0,"data-svelte-h":!0}),ft(d)!=="svelte-vji6vz"&&(d.innerHTML=f),K.forEach(B),F.forEach(B),h=X(R),R.forEach(B),this.h()},h(){k(t,"class","mif-pencil"),k(u,"class","button small"),k(d,"class","button small alert"),k(_,"class","message-actions svelte-om5vl5"),k(r,"class",g="message-content "+(w[6].role==="user"?"bg-darkBlue fg-white":"bg-lightGray")+" svelte-om5vl5"),k(l,"class",o="message "+w[6].role+" svelte-om5vl5")},m(L,R){G(L,l,R),x(l,r),m&&m.m(r,null),x(r,c),b&&b.m(r,null),x(r,y),x(r,_),x(_,u),x(u,t),x(u,s),x(u,i),x(_,n),x(_,d),x(l,h),p||(v=[lt(u,"click",E),lt(d,"click",q)],p=!0)},p(L,R){w=L,C===(C=a(w))&&m?m.p(w,R):(m&&m.d(1),m=C&&C(w),m&&(m.c(),m.m(r,c))),w[6].tool_calls&&w[6].tool_calls.length>0?b?b.p(w,R):(b=Dt(w),b.c(),b.m(r,y)):b&&(b.d(1),b=null),R&1&&e!==(e=w[6].isEditing?"Save":"Edit")&&pt(i,e),R&1&&g!==(g="message-content "+(w[6].role==="user"?"bg-darkBlue fg-white":"bg-lightGray")+" svelte-om5vl5")&&k(r,"class",g),R&1&&o!==(o="message "+w[6].role+" svelte-om5vl5")&&k(l,"class",o)},d(L){L&&B(l),m&&m.d(),b&&b.d(),p=!1,Rt(v)}}}function le(w){let l,r=w[6].content+"",c;return{c(){l=S("div"),c=ht(r)},l(y){l=N(y,"DIV",{});var _=A(l);c=ut(_,r),_.forEach(B)},m(y,_){G(y,l,_),x(l,c)},p(y,_){_&1&&r!==(r=y[6].content+"")&&pt(c,r)},d(y){y&&B(l)}}}function ae(w){let l,r,c;function y(){w[3].call(l,w[7],w[8])}return{c(){l=S("textarea"),this.h()},l(_){l=N(_,"TEXTAREA",{"data-role":!0,class:!0}),A(l).forEach(B),this.h()},h(){k(l,"data-role","textarea"),k(l,"class","w-100")},m(_,u){G(_,l,u),ct(l,w[6].content),r||(c=lt(l,"input",y),r=!0)},p(_,u){w=_,u&1&&ct(l,w[6].content)},d(_){_&&B(l),r=!1,c()}}}function Dt(w){let l,r,c="Tool Calls:",y,_=et(w[6].tool_calls),u=[];for(let t=0;t<_.length;t+=1)u[t]=Wt(jt(w,_,t));return{c(){l=S("div"),r=S("strong"),r.textContent=c,y=U();for(let t=0;t<u.length;t+=1)u[t].c();this.h()},l(t){l=N(t,"DIV",{class:!0});var s=A(l);r=N(s,"STRONG",{"data-svelte-h":!0}),ft(r)!=="svelte-lg2hf7"&&(r.textContent=c),y=X(s);for(let e=0;e<u.length;e+=1)u[e].l(s);s.forEach(B),this.h()},h(){k(l,"class","tool-usage svelte-om5vl5")},m(t,s){G(t,l,s),x(l,r),x(l,y);for(let e=0;e<u.length;e+=1)u[e]&&u[e].m(l,null)},p(t,s){if(s&1){_=et(t[6].tool_calls);let e;for(e=0;e<_.length;e+=1){const i=jt(t,_,e);u[e]?u[e].p(i,s):(u[e]=Wt(i),u[e].c(),u[e].m(l,null))}for(;e<u.length;e+=1)u[e].d(1);u.length=_.length}},d(t){t&&B(l),at(u,t)}}}function Wt(w){let l,r,c=w[10].name+"",y,_,u,t=w[10].args+"",s,e;return{c(){l=S("div"),r=S("span"),y=ht(c),_=U(),u=S("div"),s=ht(t),e=U(),this.h()},l(i){l=N(i,"DIV",{class:!0});var n=A(l);r=N(n,"SPAN",{class:!0});var d=A(r);y=ut(d,c),d.forEach(B),_=X(n),u=N(n,"DIV",{class:!0});var f=A(u);s=ut(f,t),f.forEach(B),e=X(n),n.forEach(B),this.h()},h(){k(r,"class","tool-name svelte-om5vl5"),k(u,"class","tool-args"),k(l,"class","tool-call svelte-om5vl5")},m(i,n){G(i,l,n),x(l,r),x(r,y),x(l,_),x(l,u),x(u,s),x(l,e)},p(i,n){n&1&&c!==(c=i[10].name+"")&&pt(y,c),n&1&&t!==(t=i[10].args+"")&&pt(s,t)},d(i){i&&B(l)}}}function $t(w){let l,r=w[6].role!=="developer"&&w[6].role!=="tool"&&Ot(w);return{c(){r&&r.c(),l=Bt()},l(c){r&&r.l(c),l=Bt()},m(c,y){r&&r.m(c,y),G(c,l,y)},p(c,y){c[6].role!=="developer"&&c[6].role!=="tool"?r?r.p(c,y):(r=Ot(c),r.c(),r.m(l.parentNode,l)):r&&(r.d(1),r=null)},d(c){c&&B(l),r&&r.d(c)}}}function ce(w){let l,r=et(w[0]),c=[];for(let y=0;y<r.length;y+=1)c[y]=$t(qt(w,r,y));return{c(){l=S("div");for(let y=0;y<c.length;y+=1)c[y].c();this.h()},l(y){l=N(y,"DIV",{class:!0});var _=A(l);for(let u=0;u<c.length;u+=1)c[u].l(_);_.forEach(B),this.h()},h(){k(l,"class","chat-container svelte-om5vl5")},m(y,_){G(y,l,_);for(let u=0;u<c.length;u+=1)c[u]&&c[u].m(l,null)},p(y,[_]){if(_&7){r=et(y[0]);let u;for(u=0;u<r.length;u+=1){const t=qt(y,r,u);c[u]?c[u].p(t,_):(c[u]=$t(t),c[u].c(),c[u].m(l,null))}for(;u<c.length;u+=1)c[u].d(1);c.length=r.length}},i:ot,o:ot,d(y){y&&B(l),at(c,y)}}}function re(w){if(!w.function)return"";const l=JSON.parse(w.function.arguments||"{}");return{name:w.function.name,args:JSON.stringify(l,null,2)}}function de(w,l,r){let c;Ct(w,rt,e=>r(0,c=e));function y(e){dt(rt,c=c.filter((i,n)=>n!==e),c)}function _(e){dt(rt,c[e].isEditing=!c[e].isEditing,c),dt(rt,c=[...c],c)}function u(e,i){e[i].content=this.value,rt.set(c)}return[c,y,_,u,e=>_(e),e=>y(e)]}class he extends Et{constructor(l){super(),xt(this,l,de,ce,bt,{})}}function ue(w){let l,r,c,y='<li><a href="#_target_1">Tasks</a></li> <li><a href="#_target_2">Resources</a></li> <li><a href="#_target_3">Instructions</a></li>',_,u,t,s,e,i,n,d,f,g,h,o,p,v;return s=new Tt({props:{name:"tasks"}}),n=new Tt({props:{name:"resources"}}),g=new he({}),p=new se({}),{c(){l=S("div"),r=S("div"),c=S("ul"),c.innerHTML=y,_=U(),u=S("div"),t=S("div"),_t(s.$$.fragment),e=U(),i=S("div"),_t(n.$$.fragment),d=U(),f=S("div"),_t(g.$$.fragment),h=U(),o=S("div"),_t(p.$$.fragment),this.h()},l(a){l=N(a,"DIV",{"data-role":!0,class:!0,"data-split-sizes":!0});var C=A(l);r=N(C,"DIV",{class:!0});var m=A(r);c=N(m,"UL",{"data-role":!0,"data-expand":!0,"data-svelte-h":!0}),ft(c)!=="svelte-1wsnr9t"&&(c.innerHTML=y),_=X(m),u=N(m,"DIV",{class:!0});var b=A(u);t=N(b,"DIV",{id:!0});var E=A(t);mt(s.$$.fragment,E),E.forEach(B),e=X(b),i=N(b,"DIV",{id:!0});var q=A(i);mt(n.$$.fragment,q),q.forEach(B),d=X(b),f=N(b,"DIV",{id:!0});var L=A(f);mt(g.$$.fragment,L),L.forEach(B),b.forEach(B),m.forEach(B),h=X(C),o=N(C,"DIV",{class:!0});var R=A(o);mt(p.$$.fragment,R),R.forEach(B),C.forEach(B),this.h()},h(){k(c,"data-role","tabs"),k(c,"data-expand","true"),k(t,"id","_target_1"),k(i,"id","_target_2"),k(f,"id","_target_3"),k(u,"class","border bd-default no-border-top p-2 scrollable svelte-95hlbm"),k(r,"class",""),k(o,"class","d-flex flex-justify-center flex-align-center"),k(l,"data-role","splitter"),k(l,"class","h-100"),k(l,"data-split-sizes","30, 70")},m(a,C){G(a,l,C),x(l,r),x(r,c),x(r,_),x(r,u),x(u,t),gt(s,t,null),x(u,e),x(u,i),gt(n,i,null),x(u,d),x(u,f),gt(g,f,null),x(l,h),x(l,o),gt(p,o,null),v=!0},p:ot,i(a){v||(vt(s.$$.fragment,a),vt(n.$$.fragment,a),vt(g.$$.fragment,a),vt(p.$$.fragment,a),v=!0)},o(a){wt(s.$$.fragment,a),wt(n.$$.fragment,a),wt(g.$$.fragment,a),wt(p.$$.fragment,a),v=!1},d(a){a&&B(l),yt(s),yt(n),yt(g),yt(p)}}}class Ce extends Et{constructor(l){super(),xt(this,l,null,ue,bt,{})}}export{Ce as component};
