import{s as bt,n as it,e as ot,o as Xt,f as Ct,b as Yt,r as St}from"../chunks/scheduler.2c88ebef.js";import{S as Et,i as xt,g as S,h as B,j as I,f as x,k,a as X,s as V,c as P,x as ut,y as E,A as rt,m as ct,n as dt,o as ht,B as pt,z as at,e as Bt,r as ft,u as _t,v as gt,d as mt,t as vt,w as wt}from"../chunks/index.60426481.js";import{c as Gt,g as Kt,z as Qt}from"../chunks/drawflow.store.ae844c71.js";import{d as Lt,c as Ut}from"../chunks/criticalPath.store.e631524e.js";import{e as Q}from"../chunks/each.e59479a4.js";import{g as Rt,T as Zt}from"../chunks/tables.store.a680fdc0.js";import{w as te}from"../chunks/index.0f227f4a.js";import{c as yt,a as ee}from"../chunks/assistant.store.01cff713.js";import{p as ne}from"../chunks/projectCharter.store.fdb056df.js";var Jt={exports:{}};(function(g,i){(function(a,l){g.exports=l()})(typeof self<"u"?self:Gt,function(){return function(a){var l={};function f(h){if(l[h])return l[h].exports;var r=l[h]={i:h,l:!1,exports:{}};return a[h].call(r.exports,r,r.exports,f),r.l=!0,r.exports}return f.m=a,f.c=l,f.d=function(h,r,t){f.o(h,r)||Object.defineProperty(h,r,{enumerable:!0,get:t})},f.r=function(h){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(h,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(h,"__esModule",{value:!0})},f.t=function(h,r){if(1&r&&(h=f(h)),8&r||4&r&&typeof h=="object"&&h&&h.__esModule)return h;var t=Object.create(null);if(f.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:h}),2&r&&typeof h!="string")for(var s in h)f.d(t,s,(function(e){return h[e]}).bind(null,s));return t},f.n=function(h){var r=h&&h.__esModule?function(){return h.default}:function(){return h};return f.d(r,"a",r),r},f.o=function(h,r){return Object.prototype.hasOwnProperty.call(h,r)},f.p="",f(f.s=0)}([function(a,l,f){f.r(l),f.d(l,"default",function(){return h});class h{constructor(t,s=null,e=null){this.events={},this.container=t,this.precanvas=null,this.nodeId=1,this.ele_selected=null,this.node_selected=null,this.drag=!1,this.reroute=!1,this.reroute_fix_curvature=!1,this.curvature=.5,this.reroute_curvature_start_end=.5,this.reroute_curvature=.5,this.reroute_width=6,this.drag_point=!1,this.editor_selected=!1,this.connection=!1,this.connection_ele=null,this.connection_selected=null,this.canvas_x=0,this.canvas_y=0,this.pos_x=0,this.pos_x_start=0,this.pos_y=0,this.pos_y_start=0,this.mouse_x=0,this.mouse_y=0,this.line_path=5,this.first_click=null,this.force_first_input=!1,this.draggable_inputs=!0,this.useuuid=!1,this.parent=e,this.noderegister={},this.render=s,this.drawflow={drawflow:{Home:{data:{}}}},this.module="Home",this.editor_mode="edit",this.zoom=1,this.zoom_max=1.6,this.zoom_min=.5,this.zoom_value=.1,this.zoom_last_value=1,this.evCache=new Array,this.prevDiff=-1}start(){this.container.classList.add("parent-drawflow"),this.container.tabIndex=0,this.precanvas=document.createElement("div"),this.precanvas.classList.add("drawflow"),this.container.appendChild(this.precanvas),this.container.addEventListener("mouseup",this.dragEnd.bind(this)),this.container.addEventListener("mousemove",this.position.bind(this)),this.container.addEventListener("mousedown",this.click.bind(this)),this.container.addEventListener("touchend",this.dragEnd.bind(this)),this.container.addEventListener("touchmove",this.position.bind(this)),this.container.addEventListener("touchstart",this.click.bind(this)),this.container.addEventListener("contextmenu",this.contextmenu.bind(this)),this.container.addEventListener("keydown",this.key.bind(this)),this.container.addEventListener("wheel",this.zoom_enter.bind(this)),this.container.addEventListener("input",this.updateNodeValue.bind(this)),this.container.addEventListener("dblclick",this.dblclick.bind(this)),this.container.onpointerdown=this.pointerdown_handler.bind(this),this.container.onpointermove=this.pointermove_handler.bind(this),this.container.onpointerup=this.pointerup_handler.bind(this),this.container.onpointercancel=this.pointerup_handler.bind(this),this.container.onpointerout=this.pointerup_handler.bind(this),this.container.onpointerleave=this.pointerup_handler.bind(this),this.load()}pointerdown_handler(t){this.evCache.push(t)}pointermove_handler(t){for(var s=0;s<this.evCache.length;s++)if(t.pointerId==this.evCache[s].pointerId){this.evCache[s]=t;break}if(this.evCache.length==2){var e=Math.abs(this.evCache[0].clientX-this.evCache[1].clientX);this.prevDiff>100&&(e>this.prevDiff&&this.zoom_in(),e<this.prevDiff&&this.zoom_out()),this.prevDiff=e}}pointerup_handler(t){this.remove_event(t),this.evCache.length<2&&(this.prevDiff=-1)}remove_event(t){for(var s=0;s<this.evCache.length;s++)if(this.evCache[s].pointerId==t.pointerId){this.evCache.splice(s,1);break}}load(){for(var t in this.drawflow.drawflow[this.module].data)this.addNodeImport(this.drawflow.drawflow[this.module].data[t],this.precanvas);if(this.reroute)for(var t in this.drawflow.drawflow[this.module].data)this.addRerouteImport(this.drawflow.drawflow[this.module].data[t]);for(var t in this.drawflow.drawflow[this.module].data)this.updateConnectionNodes("node-"+t);const s=this.drawflow.drawflow;let e=1;Object.keys(s).map(function(o,n){Object.keys(s[o].data).map(function(c,_){parseInt(c)>=e&&(e=parseInt(c)+1)})}),this.nodeId=e}removeReouteConnectionSelected(){this.dispatch("connectionUnselected",!0),this.reroute_fix_curvature&&this.connection_selected.parentElement.querySelectorAll(".main-path").forEach((t,s)=>{t.classList.remove("selected")})}click(t){if(this.dispatch("click",t),this.editor_mode==="fixed"){if(t.preventDefault(),t.target.classList[0]!=="parent-drawflow"&&t.target.classList[0]!=="drawflow")return!1;this.ele_selected=t.target.closest(".parent-drawflow")}else this.editor_mode==="view"?(t.target.closest(".drawflow")!=null||t.target.matches(".parent-drawflow"))&&(this.ele_selected=t.target.closest(".parent-drawflow"),t.preventDefault()):(this.first_click=t.target,this.ele_selected=t.target,t.button===0&&this.contextmenuDel(),t.target.closest(".drawflow_content_node")!=null&&(this.ele_selected=t.target.closest(".drawflow_content_node").parentElement));switch(this.ele_selected.classList[0]){case"drawflow-node":this.node_selected!=null&&(this.node_selected.classList.remove("selected"),this.node_selected!=this.ele_selected&&this.dispatch("nodeUnselected",!0)),this.connection_selected!=null&&(this.connection_selected.classList.remove("selected"),this.removeReouteConnectionSelected(),this.connection_selected=null),this.node_selected!=this.ele_selected&&this.dispatch("nodeSelected",this.ele_selected.id.slice(5)),this.node_selected=this.ele_selected,this.node_selected.classList.add("selected"),this.draggable_inputs?t.target.tagName!=="SELECT"&&(this.drag=!0):t.target.tagName!=="INPUT"&&t.target.tagName!=="TEXTAREA"&&t.target.tagName!=="SELECT"&&t.target.hasAttribute("contenteditable")!==!0&&(this.drag=!0);break;case"output":this.connection=!0,this.node_selected!=null&&(this.node_selected.classList.remove("selected"),this.node_selected=null,this.dispatch("nodeUnselected",!0)),this.connection_selected!=null&&(this.connection_selected.classList.remove("selected"),this.removeReouteConnectionSelected(),this.connection_selected=null),this.drawConnection(t.target);break;case"parent-drawflow":case"drawflow":this.node_selected!=null&&(this.node_selected.classList.remove("selected"),this.node_selected=null,this.dispatch("nodeUnselected",!0)),this.connection_selected!=null&&(this.connection_selected.classList.remove("selected"),this.removeReouteConnectionSelected(),this.connection_selected=null),this.editor_selected=!0;break;case"main-path":this.node_selected!=null&&(this.node_selected.classList.remove("selected"),this.node_selected=null,this.dispatch("nodeUnselected",!0)),this.connection_selected!=null&&(this.connection_selected.classList.remove("selected"),this.removeReouteConnectionSelected(),this.connection_selected=null),this.connection_selected=this.ele_selected,this.connection_selected.classList.add("selected");const s=this.connection_selected.parentElement.classList;s.length>1&&(this.dispatch("connectionSelected",{output_id:s[2].slice(14),input_id:s[1].slice(13),output_class:s[3],input_class:s[4]}),this.reroute_fix_curvature&&this.connection_selected.parentElement.querySelectorAll(".main-path").forEach((e,o)=>{e.classList.add("selected")}));break;case"point":this.drag_point=!0,this.ele_selected.classList.add("selected");break;case"drawflow-delete":this.node_selected&&this.removeNodeId(this.node_selected.id),this.connection_selected&&this.removeConnection(),this.node_selected!=null&&(this.node_selected.classList.remove("selected"),this.node_selected=null,this.dispatch("nodeUnselected",!0)),this.connection_selected!=null&&(this.connection_selected.classList.remove("selected"),this.removeReouteConnectionSelected(),this.connection_selected=null)}t.type==="touchstart"?(this.pos_x=t.touches[0].clientX,this.pos_x_start=t.touches[0].clientX,this.pos_y=t.touches[0].clientY,this.pos_y_start=t.touches[0].clientY,this.mouse_x=t.touches[0].clientX,this.mouse_y=t.touches[0].clientY):(this.pos_x=t.clientX,this.pos_x_start=t.clientX,this.pos_y=t.clientY,this.pos_y_start=t.clientY),["input","output","main-path"].includes(this.ele_selected.classList[0])&&t.preventDefault(),this.dispatch("clickEnd",t)}position(t){if(t.type==="touchmove")var s=t.touches[0].clientX,e=t.touches[0].clientY;else s=t.clientX,e=t.clientY;if(this.connection&&this.updateConnection(s,e),this.editor_selected&&(o=this.canvas_x+-(this.pos_x-s),n=this.canvas_y+-(this.pos_y-e),this.dispatch("translate",{x:o,y:n}),this.precanvas.style.transform="translate("+o+"px, "+n+"px) scale("+this.zoom+")"),this.drag){t.preventDefault();var o=(this.pos_x-s)*this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom),n=(this.pos_y-e)*this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom);this.pos_x=s,this.pos_y=e,this.ele_selected.style.top=this.ele_selected.offsetTop-n+"px",this.ele_selected.style.left=this.ele_selected.offsetLeft-o+"px",this.drawflow.drawflow[this.module].data[this.ele_selected.id.slice(5)].pos_x=this.ele_selected.offsetLeft-o,this.drawflow.drawflow[this.module].data[this.ele_selected.id.slice(5)].pos_y=this.ele_selected.offsetTop-n,this.updateConnectionNodes(this.ele_selected.id)}if(this.drag_point){o=(this.pos_x-s)*this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom),n=(this.pos_y-e)*this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom),this.pos_x=s,this.pos_y=e;var c=this.pos_x*(this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom))-this.precanvas.getBoundingClientRect().x*(this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom)),_=this.pos_y*(this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom))-this.precanvas.getBoundingClientRect().y*(this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom));this.ele_selected.setAttributeNS(null,"cx",c),this.ele_selected.setAttributeNS(null,"cy",_);const w=this.ele_selected.parentElement.classList[2].slice(9),p=this.ele_selected.parentElement.classList[1].slice(13),d=this.ele_selected.parentElement.classList[3],m=this.ele_selected.parentElement.classList[4];let y=Array.from(this.ele_selected.parentElement.children).indexOf(this.ele_selected)-1;this.reroute_fix_curvature&&(y-=this.ele_selected.parentElement.querySelectorAll(".main-path").length-1,y<0&&(y=0));const u=w.slice(5),C=this.drawflow.drawflow[this.module].data[u].outputs[d].connections.findIndex(function(b,L){return b.node===p&&b.output===m});this.drawflow.drawflow[this.module].data[u].outputs[d].connections[C].points[y]={pos_x:c,pos_y:_};const v=this.ele_selected.parentElement.classList[2].slice(9);this.updateConnectionNodes(v)}t.type==="touchmove"&&(this.mouse_x=s,this.mouse_y=e),this.dispatch("mouseMove",{x:s,y:e})}dragEnd(t){if(t.type==="touchend")var s=this.mouse_x,e=this.mouse_y,o=document.elementFromPoint(s,e);else s=t.clientX,e=t.clientY,o=t.target;if(this.drag&&(this.pos_x_start==s&&this.pos_y_start==e||this.dispatch("nodeMoved",this.ele_selected.id.slice(5))),this.drag_point&&(this.ele_selected.classList.remove("selected"),this.pos_x_start==s&&this.pos_y_start==e||this.dispatch("rerouteMoved",this.ele_selected.parentElement.classList[2].slice(14))),this.editor_selected&&(this.canvas_x=this.canvas_x+-(this.pos_x-s),this.canvas_y=this.canvas_y+-(this.pos_y-e),this.editor_selected=!1),this.connection===!0)if(o.classList[0]==="input"||this.force_first_input&&(o.closest(".drawflow_content_node")!=null||o.classList[0]==="drawflow-node")){if(!this.force_first_input||o.closest(".drawflow_content_node")==null&&o.classList[0]!=="drawflow-node")n=o.parentElement.parentElement.id,c=o.classList[1];else{if(o.closest(".drawflow_content_node")!=null)var n=o.closest(".drawflow_content_node").parentElement.id;else var n=o.id;if(Object.keys(this.getNodeFromId(n.slice(5)).inputs).length===0)var c=!1;else var c="input_1"}var _=this.ele_selected.parentElement.parentElement.id,w=this.ele_selected.classList[1];if(_!==n&&c!==!1){if(this.container.querySelectorAll(".connection.node_in_"+n+".node_out_"+_+"."+w+"."+c).length===0){this.connection_ele.classList.add("node_in_"+n),this.connection_ele.classList.add("node_out_"+_),this.connection_ele.classList.add(w),this.connection_ele.classList.add(c);var p=n.slice(5),d=_.slice(5);this.drawflow.drawflow[this.module].data[d].outputs[w].connections.push({node:p,output:c}),this.drawflow.drawflow[this.module].data[p].inputs[c].connections.push({node:d,input:w}),this.updateConnectionNodes("node-"+d),this.updateConnectionNodes("node-"+p),this.dispatch("connectionCreated",{output_id:d,input_id:p,output_class:w,input_class:c})}else this.dispatch("connectionCancel",!0),this.connection_ele.remove();this.connection_ele=null}else this.dispatch("connectionCancel",!0),this.connection_ele.remove(),this.connection_ele=null}else this.dispatch("connectionCancel",!0),this.connection_ele.remove(),this.connection_ele=null;this.drag=!1,this.drag_point=!1,this.connection=!1,this.ele_selected=null,this.editor_selected=!1,this.dispatch("mouseUp",t)}contextmenu(t){if(this.dispatch("contextmenu",t),t.preventDefault(),this.editor_mode==="fixed"||this.editor_mode==="view")return!1;if(this.precanvas.getElementsByClassName("drawflow-delete").length&&this.precanvas.getElementsByClassName("drawflow-delete")[0].remove(),this.node_selected||this.connection_selected){var s=document.createElement("div");s.classList.add("drawflow-delete"),s.innerHTML="x",this.node_selected&&this.node_selected.appendChild(s),this.connection_selected&&this.connection_selected.parentElement.classList.length>1&&(s.style.top=t.clientY*(this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom))-this.precanvas.getBoundingClientRect().y*(this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom))+"px",s.style.left=t.clientX*(this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom))-this.precanvas.getBoundingClientRect().x*(this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom))+"px",this.precanvas.appendChild(s))}}contextmenuDel(){this.precanvas.getElementsByClassName("drawflow-delete").length&&this.precanvas.getElementsByClassName("drawflow-delete")[0].remove()}key(t){if(this.dispatch("keydown",t),this.editor_mode==="fixed"||this.editor_mode==="view")return!1;(t.key==="Delete"||t.key==="Backspace"&&t.metaKey)&&(this.node_selected!=null&&this.first_click.tagName!=="INPUT"&&this.first_click.tagName!=="TEXTAREA"&&this.first_click.hasAttribute("contenteditable")!==!0&&this.removeNodeId(this.node_selected.id),this.connection_selected!=null&&this.removeConnection())}zoom_enter(t,s){t.ctrlKey&&(t.preventDefault(),t.deltaY>0?this.zoom_out():this.zoom_in())}zoom_refresh(){this.dispatch("zoom",this.zoom),this.canvas_x=this.canvas_x/this.zoom_last_value*this.zoom,this.canvas_y=this.canvas_y/this.zoom_last_value*this.zoom,this.zoom_last_value=this.zoom,this.precanvas.style.transform="translate("+this.canvas_x+"px, "+this.canvas_y+"px) scale("+this.zoom+")"}zoom_in(){this.zoom<this.zoom_max&&(this.zoom+=this.zoom_value,this.zoom_refresh())}zoom_out(){this.zoom>this.zoom_min&&(this.zoom-=this.zoom_value,this.zoom_refresh())}zoom_reset(){this.zoom!=1&&(this.zoom=1,this.zoom_refresh())}createCurvature(t,s,e,o,n,c){var _=t,w=s,p=e,d=o,m=n;switch(c){case"open":if(t>=e)var y=_+Math.abs(p-_)*m,u=p-Math.abs(p-_)*(-1*m);else y=_+Math.abs(p-_)*m,u=p-Math.abs(p-_)*m;return" M "+_+" "+w+" C "+y+" "+w+" "+u+" "+d+" "+p+"  "+d;case"close":return t>=e?(y=_+Math.abs(p-_)*(-1*m),u=p-Math.abs(p-_)*m):(y=_+Math.abs(p-_)*m,u=p-Math.abs(p-_)*m)," M "+_+" "+w+" C "+y+" "+w+" "+u+" "+d+" "+p+"  "+d;case"other":return t>=e?(y=_+Math.abs(p-_)*(-1*m),u=p-Math.abs(p-_)*(-1*m)):(y=_+Math.abs(p-_)*m,u=p-Math.abs(p-_)*m)," M "+_+" "+w+" C "+y+" "+w+" "+u+" "+d+" "+p+"  "+d;default:return" M "+_+" "+w+" C "+(y=_+Math.abs(p-_)*m)+" "+w+" "+(u=p-Math.abs(p-_)*m)+" "+d+" "+p+"  "+d}}drawConnection(t){var s=document.createElementNS("http://www.w3.org/2000/svg","svg");this.connection_ele=s;var e=document.createElementNS("http://www.w3.org/2000/svg","path");e.classList.add("main-path"),e.setAttributeNS(null,"d",""),s.classList.add("connection"),s.appendChild(e),this.precanvas.appendChild(s);var o=t.parentElement.parentElement.id.slice(5),n=t.classList[1];this.dispatch("connectionStart",{output_id:o,output_class:n})}updateConnection(t,s){const e=this.precanvas,o=this.zoom;let n=e.clientWidth/(e.clientWidth*o);n=n||0;let c=e.clientHeight/(e.clientHeight*o);c=c||0;var _=this.connection_ele.children[0],w=this.ele_selected.offsetWidth/2+(this.ele_selected.getBoundingClientRect().x-e.getBoundingClientRect().x)*n,p=this.ele_selected.offsetHeight/2+(this.ele_selected.getBoundingClientRect().y-e.getBoundingClientRect().y)*c,d=t*(this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom))-this.precanvas.getBoundingClientRect().x*(this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom)),m=s*(this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom))-this.precanvas.getBoundingClientRect().y*(this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom)),y=this.curvature,u=this.createCurvature(w,p,d,m,y,"openclose");_.setAttributeNS(null,"d",u)}addConnection(t,s,e,o){var n=this.getModuleFromNodeId(t);if(n===this.getModuleFromNodeId(s)){var c=this.getNodeFromId(t),_=!1;for(var w in c.outputs[e].connections){var p=c.outputs[e].connections[w];p.node==s&&p.output==o&&(_=!0)}if(_===!1){if(this.drawflow.drawflow[n].data[t].outputs[e].connections.push({node:s.toString(),output:o}),this.drawflow.drawflow[n].data[s].inputs[o].connections.push({node:t.toString(),input:e}),this.module===n){var d=document.createElementNS("http://www.w3.org/2000/svg","svg"),m=document.createElementNS("http://www.w3.org/2000/svg","path");m.classList.add("main-path"),m.setAttributeNS(null,"d",""),d.classList.add("connection"),d.classList.add("node_in_node-"+s),d.classList.add("node_out_node-"+t),d.classList.add(e),d.classList.add(o),d.appendChild(m),this.precanvas.appendChild(d),this.updateConnectionNodes("node-"+t),this.updateConnectionNodes("node-"+s)}this.dispatch("connectionCreated",{output_id:t,input_id:s,output_class:e,input_class:o})}}}updateConnectionNodes(t){const s="node_in_"+t,e="node_out_"+t;this.line_path;const o=this.container,n=this.precanvas,c=this.curvature,_=this.createCurvature,w=this.reroute_curvature,p=this.reroute_curvature_start_end,d=this.reroute_fix_curvature,m=this.reroute_width,y=this.zoom;let u=n.clientWidth/(n.clientWidth*y);u=u||0;let C=n.clientHeight/(n.clientHeight*y);C=C||0;const v=o.querySelectorAll("."+e);Object.keys(v).map(function(L,z){if(v[L].querySelector(".point")===null){var R=o.querySelector("#"+t),N=v[L].classList[1].replace("node_in_",""),$=o.querySelector("#"+N).querySelectorAll("."+v[L].classList[4])[0],G=$.offsetWidth/2+($.getBoundingClientRect().x-n.getBoundingClientRect().x)*u,Y=$.offsetHeight/2+($.getBoundingClientRect().y-n.getBoundingClientRect().y)*C,nt=R.querySelectorAll("."+v[L].classList[3])[0],st=nt.offsetWidth/2+(nt.getBoundingClientRect().x-n.getBoundingClientRect().x)*u,tt=nt.offsetHeight/2+(nt.getBoundingClientRect().y-n.getBoundingClientRect().y)*C;const U=_(st,tt,G,Y,c,"openclose");v[L].children[0].setAttributeNS(null,"d",U)}else{const U=v[L].querySelectorAll(".point");let F="";const T=[];U.forEach((M,A)=>{if(A===0&&U.length-1==0){var j=o.querySelector("#"+t),q=((J=M).getBoundingClientRect().x-n.getBoundingClientRect().x)*u+m,D=(J.getBoundingClientRect().y-n.getBoundingClientRect().y)*C+m,O=(K=j.querySelectorAll("."+M.parentElement.classList[3])[0]).offsetWidth/2+(K.getBoundingClientRect().x-n.getBoundingClientRect().x)*u,H=K.offsetHeight/2+(K.getBoundingClientRect().y-n.getBoundingClientRect().y)*C,W=_(O,H,q,D,p,"open");F+=W,T.push(W),j=M;var et=M.parentElement.classList[1].replace("node_in_",""),J=(Z=o.querySelector("#"+et)).querySelectorAll("."+M.parentElement.classList[4])[0];q=(lt=Z.querySelectorAll("."+M.parentElement.classList[4])[0]).offsetWidth/2+(lt.getBoundingClientRect().x-n.getBoundingClientRect().x)*u,D=lt.offsetHeight/2+(lt.getBoundingClientRect().y-n.getBoundingClientRect().y)*C,O=(j.getBoundingClientRect().x-n.getBoundingClientRect().x)*u+m,H=(j.getBoundingClientRect().y-n.getBoundingClientRect().y)*C+m,W=_(O,H,q,D,p,"close"),F+=W,T.push(W)}else if(A===0){var K;j=o.querySelector("#"+t),q=((J=M).getBoundingClientRect().x-n.getBoundingClientRect().x)*u+m,D=(J.getBoundingClientRect().y-n.getBoundingClientRect().y)*C+m,O=(K=j.querySelectorAll("."+M.parentElement.classList[3])[0]).offsetWidth/2+(K.getBoundingClientRect().x-n.getBoundingClientRect().x)*u,H=K.offsetHeight/2+(K.getBoundingClientRect().y-n.getBoundingClientRect().y)*C,W=_(O,H,q,D,p,"open"),F+=W,T.push(W),j=M,q=((J=U[A+1]).getBoundingClientRect().x-n.getBoundingClientRect().x)*u+m,D=(J.getBoundingClientRect().y-n.getBoundingClientRect().y)*C+m,O=(j.getBoundingClientRect().x-n.getBoundingClientRect().x)*u+m,H=(j.getBoundingClientRect().y-n.getBoundingClientRect().y)*C+m,W=_(O,H,q,D,w,"other"),F+=W,T.push(W)}else if(A===U.length-1){var Z,lt;j=M,et=M.parentElement.classList[1].replace("node_in_",""),J=(Z=o.querySelector("#"+et)).querySelectorAll("."+M.parentElement.classList[4])[0],q=(lt=Z.querySelectorAll("."+M.parentElement.classList[4])[0]).offsetWidth/2+(lt.getBoundingClientRect().x-n.getBoundingClientRect().x)*u,D=lt.offsetHeight/2+(lt.getBoundingClientRect().y-n.getBoundingClientRect().y)*C,O=(j.getBoundingClientRect().x-n.getBoundingClientRect().x)*(n.clientWidth/(n.clientWidth*y))+m,H=(j.getBoundingClientRect().y-n.getBoundingClientRect().y)*(n.clientHeight/(n.clientHeight*y))+m,W=_(O,H,q,D,p,"close"),F+=W,T.push(W)}else j=M,q=((J=U[A+1]).getBoundingClientRect().x-n.getBoundingClientRect().x)*(n.clientWidth/(n.clientWidth*y))+m,D=(J.getBoundingClientRect().y-n.getBoundingClientRect().y)*(n.clientHeight/(n.clientHeight*y))+m,O=(j.getBoundingClientRect().x-n.getBoundingClientRect().x)*(n.clientWidth/(n.clientWidth*y))+m,H=(j.getBoundingClientRect().y-n.getBoundingClientRect().y)*(n.clientHeight/(n.clientHeight*y))+m,W=_(O,H,q,D,w,"other"),F+=W,T.push(W)}),d?T.forEach((M,A)=>{v[L].children[A].setAttributeNS(null,"d",M)}):v[L].children[0].setAttributeNS(null,"d",F)}});const b=o.querySelectorAll("."+s);Object.keys(b).map(function(L,z){if(b[L].querySelector(".point")===null){var R=o.querySelector("#"+t),N=b[L].classList[2].replace("node_out_",""),$=o.querySelector("#"+N).querySelectorAll("."+b[L].classList[3])[0],G=$.offsetWidth/2+($.getBoundingClientRect().x-n.getBoundingClientRect().x)*u,Y=$.offsetHeight/2+($.getBoundingClientRect().y-n.getBoundingClientRect().y)*C,nt=(R=R.querySelectorAll("."+b[L].classList[4])[0]).offsetWidth/2+(R.getBoundingClientRect().x-n.getBoundingClientRect().x)*u,st=R.offsetHeight/2+(R.getBoundingClientRect().y-n.getBoundingClientRect().y)*C;const tt=_(G,Y,nt,st,c,"openclose");b[L].children[0].setAttributeNS(null,"d",tt)}else{const tt=b[L].querySelectorAll(".point");let U="";const F=[];tt.forEach((T,M)=>{if(M===0&&tt.length-1==0){var A=o.querySelector("#"+t),j=((et=T).getBoundingClientRect().x-n.getBoundingClientRect().x)*u+m,q=(et.getBoundingClientRect().y-n.getBoundingClientRect().y)*C+m,D=(Z=A.querySelectorAll("."+T.parentElement.classList[4])[0]).offsetWidth/2+(Z.getBoundingClientRect().x-n.getBoundingClientRect().x)*u,O=Z.offsetHeight/2+(Z.getBoundingClientRect().y-n.getBoundingClientRect().y)*C,H=_(j,q,D,O,p,"close");U+=H,F.push(H),A=T;var W=T.parentElement.classList[2].replace("node_out_",""),et=(K=o.querySelector("#"+W)).querySelectorAll("."+T.parentElement.classList[3])[0];j=(J=K.querySelectorAll("."+T.parentElement.classList[3])[0]).offsetWidth/2+(J.getBoundingClientRect().x-n.getBoundingClientRect().x)*u,q=J.offsetHeight/2+(J.getBoundingClientRect().y-n.getBoundingClientRect().y)*C,D=(A.getBoundingClientRect().x-n.getBoundingClientRect().x)*u+m,O=(A.getBoundingClientRect().y-n.getBoundingClientRect().y)*C+m,H=_(j,q,D,O,p,"open"),U+=H,F.push(H)}else if(M===0){var J;A=T,W=T.parentElement.classList[2].replace("node_out_",""),et=(K=o.querySelector("#"+W)).querySelectorAll("."+T.parentElement.classList[3])[0],j=(J=K.querySelectorAll("."+T.parentElement.classList[3])[0]).offsetWidth/2+(J.getBoundingClientRect().x-n.getBoundingClientRect().x)*u,q=J.offsetHeight/2+(J.getBoundingClientRect().y-n.getBoundingClientRect().y)*C,D=(A.getBoundingClientRect().x-n.getBoundingClientRect().x)*u+m,O=(A.getBoundingClientRect().y-n.getBoundingClientRect().y)*C+m,H=_(j,q,D,O,p,"open"),U+=H,F.push(H),A=T,D=((et=tt[M+1]).getBoundingClientRect().x-n.getBoundingClientRect().x)*u+m,O=(et.getBoundingClientRect().y-n.getBoundingClientRect().y)*C+m,j=(A.getBoundingClientRect().x-n.getBoundingClientRect().x)*u+m,q=(A.getBoundingClientRect().y-n.getBoundingClientRect().y)*C+m,H=_(j,q,D,O,w,"other"),U+=H,F.push(H)}else if(M===tt.length-1){var K,Z;A=T,W=T.parentElement.classList[1].replace("node_in_",""),et=(K=o.querySelector("#"+W)).querySelectorAll("."+T.parentElement.classList[4])[0],D=(Z=K.querySelectorAll("."+T.parentElement.classList[4])[0]).offsetWidth/2+(Z.getBoundingClientRect().x-n.getBoundingClientRect().x)*u,O=Z.offsetHeight/2+(Z.getBoundingClientRect().y-n.getBoundingClientRect().y)*C,j=(A.getBoundingClientRect().x-n.getBoundingClientRect().x)*u+m,q=(A.getBoundingClientRect().y-n.getBoundingClientRect().y)*C+m,H=_(j,q,D,O,p,"close"),U+=H,F.push(H)}else A=T,D=((et=tt[M+1]).getBoundingClientRect().x-n.getBoundingClientRect().x)*u+m,O=(et.getBoundingClientRect().y-n.getBoundingClientRect().y)*C+m,j=(A.getBoundingClientRect().x-n.getBoundingClientRect().x)*u+m,q=(A.getBoundingClientRect().y-n.getBoundingClientRect().y)*C+m,H=_(j,q,D,O,w,"other"),U+=H,F.push(H)}),d?F.forEach((T,M)=>{b[L].children[M].setAttributeNS(null,"d",T)}):b[L].children[0].setAttributeNS(null,"d",U)}})}dblclick(t){this.connection_selected!=null&&this.reroute&&this.createReroutePoint(this.connection_selected),t.target.classList[0]==="point"&&this.removeReroutePoint(t.target)}createReroutePoint(t){this.connection_selected.classList.remove("selected");const s=this.connection_selected.parentElement.classList[2].slice(9),e=this.connection_selected.parentElement.classList[1].slice(13),o=this.connection_selected.parentElement.classList[3],n=this.connection_selected.parentElement.classList[4];this.connection_selected=null;const c=document.createElementNS("http://www.w3.org/2000/svg","circle");c.classList.add("point");var _=this.pos_x*(this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom))-this.precanvas.getBoundingClientRect().x*(this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom)),w=this.pos_y*(this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom))-this.precanvas.getBoundingClientRect().y*(this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom));c.setAttributeNS(null,"cx",_),c.setAttributeNS(null,"cy",w),c.setAttributeNS(null,"r",this.reroute_width);let p=0;if(this.reroute_fix_curvature){const u=t.parentElement.querySelectorAll(".main-path").length;var d=document.createElementNS("http://www.w3.org/2000/svg","path");if(d.classList.add("main-path"),d.setAttributeNS(null,"d",""),t.parentElement.insertBefore(d,t.parentElement.children[u]),u===1)t.parentElement.appendChild(c);else{const C=Array.from(t.parentElement.children).indexOf(t);p=C,t.parentElement.insertBefore(c,t.parentElement.children[C+u+1])}}else t.parentElement.appendChild(c);const m=s.slice(5),y=this.drawflow.drawflow[this.module].data[m].outputs[o].connections.findIndex(function(u,C){return u.node===e&&u.output===n});this.drawflow.drawflow[this.module].data[m].outputs[o].connections[y].points===void 0&&(this.drawflow.drawflow[this.module].data[m].outputs[o].connections[y].points=[]),this.reroute_fix_curvature?(p>0||this.drawflow.drawflow[this.module].data[m].outputs[o].connections[y].points!==[]?this.drawflow.drawflow[this.module].data[m].outputs[o].connections[y].points.splice(p,0,{pos_x:_,pos_y:w}):this.drawflow.drawflow[this.module].data[m].outputs[o].connections[y].points.push({pos_x:_,pos_y:w}),t.parentElement.querySelectorAll(".main-path").forEach((u,C)=>{u.classList.remove("selected")})):this.drawflow.drawflow[this.module].data[m].outputs[o].connections[y].points.push({pos_x:_,pos_y:w}),this.dispatch("addReroute",m),this.updateConnectionNodes(s)}removeReroutePoint(t){const s=t.parentElement.classList[2].slice(9),e=t.parentElement.classList[1].slice(13),o=t.parentElement.classList[3],n=t.parentElement.classList[4];let c=Array.from(t.parentElement.children).indexOf(t);const _=s.slice(5),w=this.drawflow.drawflow[this.module].data[_].outputs[o].connections.findIndex(function(p,d){return p.node===e&&p.output===n});if(this.reroute_fix_curvature){const p=t.parentElement.querySelectorAll(".main-path").length;t.parentElement.children[p-1].remove(),c-=p,c<0&&(c=0)}else c--;this.drawflow.drawflow[this.module].data[_].outputs[o].connections[w].points.splice(c,1),t.remove(),this.dispatch("removeReroute",_),this.updateConnectionNodes(s)}registerNode(t,s,e=null,o=null){this.noderegister[t]={html:s,props:e,options:o}}getNodeFromId(t){var s=this.getModuleFromNodeId(t);return JSON.parse(JSON.stringify(this.drawflow.drawflow[s].data[t]))}getNodesFromName(t){var s=[];const e=this.drawflow.drawflow;return Object.keys(e).map(function(o,n){for(var c in e[o].data)e[o].data[c].name==t&&s.push(e[o].data[c].id)}),s}addNode(t,s,e,o,n,c,_,w,p=!1){if(this.useuuid)var d=this.getUuid();else d=this.nodeId;const m=document.createElement("div");m.classList.add("parent-node");const y=document.createElement("div");y.innerHTML="",y.setAttribute("id","node-"+d),y.classList.add("drawflow-node"),c!=""&&y.classList.add(...c.split(" "));const u=document.createElement("div");u.classList.add("inputs");const C=document.createElement("div");C.classList.add("outputs");const v={};for(var b=0;b<s;b++){const N=document.createElement("div");N.classList.add("input"),N.classList.add("input_"+(b+1)),v["input_"+(b+1)]={connections:[]},u.appendChild(N)}const L={};for(b=0;b<e;b++){const N=document.createElement("div");N.classList.add("output"),N.classList.add("output_"+(b+1)),L["output_"+(b+1)]={connections:[]},C.appendChild(N)}const z=document.createElement("div");if(z.classList.add("drawflow_content_node"),p===!1)z.innerHTML=w;else if(p===!0)z.appendChild(this.noderegister[w].html.cloneNode(!0));else if(parseInt(this.render.version)===3){let N=this.render.h(this.noderegister[w].html,this.noderegister[w].props,this.noderegister[w].options);N.appContext=this.parent,this.render.render(N,z)}else{let N=new this.render({parent:this.parent,render:$=>$(this.noderegister[w].html,{props:this.noderegister[w].props}),...this.noderegister[w].options}).$mount();z.appendChild(N.$el)}Object.entries(_).forEach(function(N,$){if(typeof N[1]=="object")(function nt(st,tt,U){st===null?st=_[tt]:st=st[tt],st!==null&&Object.entries(st).forEach(function(F,T){if(typeof F[1]=="object")nt(st,F[0],U+"-"+F[0]);else for(var M=z.querySelectorAll("[df-"+U+"-"+F[0]+"]"),A=0;A<M.length;A++)M[A].value=F[1],M[A].isContentEditable&&(M[A].innerText=F[1])})})(null,N[0],N[0]);else for(var G=z.querySelectorAll("[df-"+N[0]+"]"),Y=0;Y<G.length;Y++)G[Y].value=N[1],G[Y].isContentEditable&&(G[Y].innerText=N[1])}),y.appendChild(u),y.appendChild(z),y.appendChild(C),y.style.top=n+"px",y.style.left=o+"px",m.appendChild(y),this.precanvas.appendChild(m);var R={id:d,name:t,data:_,class:c,html:w,typenode:p,inputs:v,outputs:L,pos_x:o,pos_y:n};return this.drawflow.drawflow[this.module].data[d]=R,this.dispatch("nodeCreated",d),this.useuuid||this.nodeId++,d}addNodeImport(t,s){const e=document.createElement("div");e.classList.add("parent-node");const o=document.createElement("div");o.innerHTML="",o.setAttribute("id","node-"+t.id),o.classList.add("drawflow-node"),t.class!=""&&o.classList.add(...t.class.split(" "));const n=document.createElement("div");n.classList.add("inputs");const c=document.createElement("div");c.classList.add("outputs"),Object.keys(t.inputs).map(function(p,d){const m=document.createElement("div");m.classList.add("input"),m.classList.add(p),n.appendChild(m),Object.keys(t.inputs[p].connections).map(function(y,u){var C=document.createElementNS("http://www.w3.org/2000/svg","svg"),v=document.createElementNS("http://www.w3.org/2000/svg","path");v.classList.add("main-path"),v.setAttributeNS(null,"d",""),C.classList.add("connection"),C.classList.add("node_in_node-"+t.id),C.classList.add("node_out_node-"+t.inputs[p].connections[y].node),C.classList.add(t.inputs[p].connections[y].input),C.classList.add(p),C.appendChild(v),s.appendChild(C)})});for(var _=0;_<Object.keys(t.outputs).length;_++){const p=document.createElement("div");p.classList.add("output"),p.classList.add("output_"+(_+1)),c.appendChild(p)}const w=document.createElement("div");if(w.classList.add("drawflow_content_node"),t.typenode===!1)w.innerHTML=t.html;else if(t.typenode===!0)w.appendChild(this.noderegister[t.html].html.cloneNode(!0));else if(parseInt(this.render.version)===3){let p=this.render.h(this.noderegister[t.html].html,this.noderegister[t.html].props,this.noderegister[t.html].options);p.appContext=this.parent,this.render.render(p,w)}else{let p=new this.render({parent:this.parent,render:d=>d(this.noderegister[t.html].html,{props:this.noderegister[t.html].props}),...this.noderegister[t.html].options}).$mount();w.appendChild(p.$el)}Object.entries(t.data).forEach(function(p,d){if(typeof p[1]=="object")(function u(C,v,b){C===null?C=t.data[v]:C=C[v],C!==null&&Object.entries(C).forEach(function(L,z){if(typeof L[1]=="object")u(C,L[0],b+"-"+L[0]);else for(var R=w.querySelectorAll("[df-"+b+"-"+L[0]+"]"),N=0;N<R.length;N++)R[N].value=L[1],R[N].isContentEditable&&(R[N].innerText=L[1])})})(null,p[0],p[0]);else for(var m=w.querySelectorAll("[df-"+p[0]+"]"),y=0;y<m.length;y++)m[y].value=p[1],m[y].isContentEditable&&(m[y].innerText=p[1])}),o.appendChild(n),o.appendChild(w),o.appendChild(c),o.style.top=t.pos_y+"px",o.style.left=t.pos_x+"px",e.appendChild(o),this.precanvas.appendChild(e)}addRerouteImport(t){const s=this.reroute_width,e=this.reroute_fix_curvature,o=this.container;Object.keys(t.outputs).map(function(n,c){Object.keys(t.outputs[n].connections).map(function(_,w){const p=t.outputs[n].connections[_].points;p!==void 0&&p.forEach((d,m)=>{const y=t.outputs[n].connections[_].node,u=t.outputs[n].connections[_].output,C=o.querySelector(".connection.node_in_node-"+y+".node_out_node-"+t.id+"."+n+"."+u);if(e&&m===0)for(var v=0;v<p.length;v++){var b=document.createElementNS("http://www.w3.org/2000/svg","path");b.classList.add("main-path"),b.setAttributeNS(null,"d",""),C.appendChild(b)}const L=document.createElementNS("http://www.w3.org/2000/svg","circle");L.classList.add("point");var z=d.pos_x,R=d.pos_y;L.setAttributeNS(null,"cx",z),L.setAttributeNS(null,"cy",R),L.setAttributeNS(null,"r",s),C.appendChild(L)})})})}updateNodeValue(t){for(var s=t.target.attributes,e=0;e<s.length;e++)if(s[e].nodeName.startsWith("df-")){for(var o=s[e].nodeName.slice(3).split("-"),n=this.drawflow.drawflow[this.module].data[t.target.closest(".drawflow_content_node").parentElement.id.slice(5)].data,c=0;c<o.length-1;c+=1)n[o[c]]==null&&(n[o[c]]={}),n=n[o[c]];n[o[o.length-1]]=t.target.value,t.target.isContentEditable&&(n[o[o.length-1]]=t.target.innerText),this.dispatch("nodeDataChanged",t.target.closest(".drawflow_content_node").parentElement.id.slice(5))}}updateNodeDataFromId(t,s){var e=this.getModuleFromNodeId(t);if(this.drawflow.drawflow[e].data[t].data=s,this.module===e){const o=this.container.querySelector("#node-"+t);Object.entries(s).forEach(function(n,c){if(typeof n[1]=="object")(function p(d,m,y){d===null?d=s[m]:d=d[m],d!==null&&Object.entries(d).forEach(function(u,C){if(typeof u[1]=="object")p(d,u[0],y+"-"+u[0]);else for(var v=o.querySelectorAll("[df-"+y+"-"+u[0]+"]"),b=0;b<v.length;b++)v[b].value=u[1],v[b].isContentEditable&&(v[b].innerText=u[1])})})(null,n[0],n[0]);else for(var _=o.querySelectorAll("[df-"+n[0]+"]"),w=0;w<_.length;w++)_[w].value=n[1],_[w].isContentEditable&&(_[w].innerText=n[1])})}}addNodeInput(t){var s=this.getModuleFromNodeId(t);const e=this.getNodeFromId(t),o=Object.keys(e.inputs).length;if(this.module===s){const n=document.createElement("div");n.classList.add("input"),n.classList.add("input_"+(o+1)),this.container.querySelector("#node-"+t+" .inputs").appendChild(n),this.updateConnectionNodes("node-"+t)}this.drawflow.drawflow[s].data[t].inputs["input_"+(o+1)]={connections:[]}}addNodeOutput(t){var s=this.getModuleFromNodeId(t);const e=this.getNodeFromId(t),o=Object.keys(e.outputs).length;if(this.module===s){const n=document.createElement("div");n.classList.add("output"),n.classList.add("output_"+(o+1)),this.container.querySelector("#node-"+t+" .outputs").appendChild(n),this.updateConnectionNodes("node-"+t)}this.drawflow.drawflow[s].data[t].outputs["output_"+(o+1)]={connections:[]}}removeNodeInput(t,s){var e=this.getModuleFromNodeId(t);const o=this.getNodeFromId(t);this.module===e&&this.container.querySelector("#node-"+t+" .inputs .input."+s).remove();const n=[];Object.keys(o.inputs[s].connections).map(function(d,m){const y=o.inputs[s].connections[m].node,u=o.inputs[s].connections[m].input;n.push({id_output:y,id:t,output_class:u,input_class:s})}),n.forEach((d,m)=>{this.removeSingleConnection(d.id_output,d.id,d.output_class,d.input_class)}),delete this.drawflow.drawflow[e].data[t].inputs[s];const c=[],_=this.drawflow.drawflow[e].data[t].inputs;Object.keys(_).map(function(d,m){c.push(_[d])}),this.drawflow.drawflow[e].data[t].inputs={};const w=s.slice(6);let p=[];c.forEach((d,m)=>{d.connections.forEach((y,u)=>{p.push(y)}),this.drawflow.drawflow[e].data[t].inputs["input_"+(m+1)]=d}),p=new Set(p.map(d=>JSON.stringify(d))),p=Array.from(p).map(d=>JSON.parse(d)),this.module===e&&this.container.querySelectorAll("#node-"+t+" .inputs .input").forEach((d,m)=>{const y=d.classList[1].slice(6);parseInt(w)<parseInt(y)&&(d.classList.remove("input_"+y),d.classList.add("input_"+(y-1)))}),p.forEach((d,m)=>{this.drawflow.drawflow[e].data[d.node].outputs[d.input].connections.forEach((y,u)=>{if(y.node==t){const C=y.output.slice(6);if(parseInt(w)<parseInt(C)){if(this.module===e){const v=this.container.querySelector(".connection.node_in_node-"+t+".node_out_node-"+d.node+"."+d.input+".input_"+C);v.classList.remove("input_"+C),v.classList.add("input_"+(C-1))}y.points?this.drawflow.drawflow[e].data[d.node].outputs[d.input].connections[u]={node:y.node,output:"input_"+(C-1),points:y.points}:this.drawflow.drawflow[e].data[d.node].outputs[d.input].connections[u]={node:y.node,output:"input_"+(C-1)}}}})}),this.updateConnectionNodes("node-"+t)}removeNodeOutput(t,s){var e=this.getModuleFromNodeId(t);const o=this.getNodeFromId(t);this.module===e&&this.container.querySelector("#node-"+t+" .outputs .output."+s).remove();const n=[];Object.keys(o.outputs[s].connections).map(function(d,m){const y=o.outputs[s].connections[m].node,u=o.outputs[s].connections[m].output;n.push({id:t,id_input:y,output_class:s,input_class:u})}),n.forEach((d,m)=>{this.removeSingleConnection(d.id,d.id_input,d.output_class,d.input_class)}),delete this.drawflow.drawflow[e].data[t].outputs[s];const c=[],_=this.drawflow.drawflow[e].data[t].outputs;Object.keys(_).map(function(d,m){c.push(_[d])}),this.drawflow.drawflow[e].data[t].outputs={};const w=s.slice(7);let p=[];c.forEach((d,m)=>{d.connections.forEach((y,u)=>{p.push({node:y.node,output:y.output})}),this.drawflow.drawflow[e].data[t].outputs["output_"+(m+1)]=d}),p=new Set(p.map(d=>JSON.stringify(d))),p=Array.from(p).map(d=>JSON.parse(d)),this.module===e&&this.container.querySelectorAll("#node-"+t+" .outputs .output").forEach((d,m)=>{const y=d.classList[1].slice(7);parseInt(w)<parseInt(y)&&(d.classList.remove("output_"+y),d.classList.add("output_"+(y-1)))}),p.forEach((d,m)=>{this.drawflow.drawflow[e].data[d.node].inputs[d.output].connections.forEach((y,u)=>{if(y.node==t){const C=y.input.slice(7);if(parseInt(w)<parseInt(C)){if(this.module===e){const v=this.container.querySelector(".connection.node_in_node-"+d.node+".node_out_node-"+t+".output_"+C+"."+d.output);v.classList.remove("output_"+C),v.classList.remove(d.output),v.classList.add("output_"+(C-1)),v.classList.add(d.output)}y.points?this.drawflow.drawflow[e].data[d.node].inputs[d.output].connections[u]={node:y.node,input:"output_"+(C-1),points:y.points}:this.drawflow.drawflow[e].data[d.node].inputs[d.output].connections[u]={node:y.node,input:"output_"+(C-1)}}}})}),this.updateConnectionNodes("node-"+t)}removeNodeId(t){this.removeConnectionNodeId(t);var s=this.getModuleFromNodeId(t.slice(5));this.module===s&&this.container.querySelector("#"+t).remove(),delete this.drawflow.drawflow[s].data[t.slice(5)],this.dispatch("nodeRemoved",t.slice(5))}removeConnection(){if(this.connection_selected!=null){var t=this.connection_selected.parentElement.classList;this.connection_selected.parentElement.remove();var s=this.drawflow.drawflow[this.module].data[t[2].slice(14)].outputs[t[3]].connections.findIndex(function(o,n){return o.node===t[1].slice(13)&&o.output===t[4]});this.drawflow.drawflow[this.module].data[t[2].slice(14)].outputs[t[3]].connections.splice(s,1);var e=this.drawflow.drawflow[this.module].data[t[1].slice(13)].inputs[t[4]].connections.findIndex(function(o,n){return o.node===t[2].slice(14)&&o.input===t[3]});this.drawflow.drawflow[this.module].data[t[1].slice(13)].inputs[t[4]].connections.splice(e,1),this.dispatch("connectionRemoved",{output_id:t[2].slice(14),input_id:t[1].slice(13),output_class:t[3],input_class:t[4]}),this.connection_selected=null}}removeSingleConnection(t,s,e,o){var n=this.getModuleFromNodeId(t);if(n===this.getModuleFromNodeId(s)){if(this.drawflow.drawflow[n].data[t].outputs[e].connections.findIndex(function(w,p){return w.node==s&&w.output===o})>-1){this.module===n&&this.container.querySelector(".connection.node_in_node-"+s+".node_out_node-"+t+"."+e+"."+o).remove();var c=this.drawflow.drawflow[n].data[t].outputs[e].connections.findIndex(function(w,p){return w.node==s&&w.output===o});this.drawflow.drawflow[n].data[t].outputs[e].connections.splice(c,1);var _=this.drawflow.drawflow[n].data[s].inputs[o].connections.findIndex(function(w,p){return w.node==t&&w.input===e});return this.drawflow.drawflow[n].data[s].inputs[o].connections.splice(_,1),this.dispatch("connectionRemoved",{output_id:t,input_id:s,output_class:e,input_class:o}),!0}return!1}return!1}removeConnectionNodeId(t){const s="node_in_"+t,e="node_out_"+t,o=this.container.querySelectorAll("."+e);for(var n=o.length-1;n>=0;n--){var c=o[n].classList,_=this.drawflow.drawflow[this.module].data[c[1].slice(13)].inputs[c[4]].connections.findIndex(function(d,m){return d.node===c[2].slice(14)&&d.input===c[3]});this.drawflow.drawflow[this.module].data[c[1].slice(13)].inputs[c[4]].connections.splice(_,1);var w=this.drawflow.drawflow[this.module].data[c[2].slice(14)].outputs[c[3]].connections.findIndex(function(d,m){return d.node===c[1].slice(13)&&d.output===c[4]});this.drawflow.drawflow[this.module].data[c[2].slice(14)].outputs[c[3]].connections.splice(w,1),o[n].remove(),this.dispatch("connectionRemoved",{output_id:c[2].slice(14),input_id:c[1].slice(13),output_class:c[3],input_class:c[4]})}const p=this.container.querySelectorAll("."+s);for(n=p.length-1;n>=0;n--)c=p[n].classList,w=this.drawflow.drawflow[this.module].data[c[2].slice(14)].outputs[c[3]].connections.findIndex(function(d,m){return d.node===c[1].slice(13)&&d.output===c[4]}),this.drawflow.drawflow[this.module].data[c[2].slice(14)].outputs[c[3]].connections.splice(w,1),_=this.drawflow.drawflow[this.module].data[c[1].slice(13)].inputs[c[4]].connections.findIndex(function(d,m){return d.node===c[2].slice(14)&&d.input===c[3]}),this.drawflow.drawflow[this.module].data[c[1].slice(13)].inputs[c[4]].connections.splice(_,1),p[n].remove(),this.dispatch("connectionRemoved",{output_id:c[2].slice(14),input_id:c[1].slice(13),output_class:c[3],input_class:c[4]})}getModuleFromNodeId(t){var s;const e=this.drawflow.drawflow;return Object.keys(e).map(function(o,n){Object.keys(e[o].data).map(function(c,_){c==t&&(s=o)})}),s}addModule(t){this.drawflow.drawflow[t]={data:{}},this.dispatch("moduleCreated",t)}changeModule(t){this.dispatch("moduleChanged",t),this.module=t,this.precanvas.innerHTML="",this.canvas_x=0,this.canvas_y=0,this.pos_x=0,this.pos_y=0,this.mouse_x=0,this.mouse_y=0,this.zoom=1,this.zoom_last_value=1,this.precanvas.style.transform="",this.import(this.drawflow,!1)}removeModule(t){this.module===t&&this.changeModule("Home"),delete this.drawflow.drawflow[t],this.dispatch("moduleRemoved",t)}clearModuleSelected(){this.precanvas.innerHTML="",this.drawflow.drawflow[this.module]={data:{}}}clear(){this.precanvas.innerHTML="",this.drawflow={drawflow:{Home:{data:{}}}}}export(){const t=JSON.parse(JSON.stringify(this.drawflow));return this.dispatch("export",t),t}import(t,s=!0){this.clear(),this.drawflow=JSON.parse(JSON.stringify(t)),this.load(),s&&this.dispatch("import","import")}on(t,s){return typeof s!="function"?(console.error("The listener callback must be a function, the given type is "+typeof s),!1):typeof t!="string"?(console.error("The event name must be a string, the given type is "+typeof t),!1):(this.events[t]===void 0&&(this.events[t]={listeners:[]}),void this.events[t].listeners.push(s))}removeListener(t,s){if(!this.events[t])return!1;const e=this.events[t].listeners,o=e.indexOf(s);o>-1&&e.splice(o,1)}dispatch(t,s){if(this.events[t]===void 0)return!1;this.events[t].listeners.forEach(e=>{e(s)})}getUuid(){for(var t=[],s=0;s<36;s++)t[s]="0123456789abcdef".substr(Math.floor(16*Math.random()),1);return t[14]="4",t[19]="0123456789abcdef".substr(3&t[19]|8,1),t[8]=t[13]=t[18]=t[23]="-",t.join("")}}}]).default})})(Jt);var se=Jt.exports;const ie=Kt(se);function oe(g){let i;return{c(){i=S("div"),this.h()},l(a){i=B(a,"DIV",{class:!0}),I(i).forEach(x),this.h()},h(){k(i,"class","parent-drawflow h-100 my-editor svelte-1jjj000")},m(a,l){X(a,i,l),g[1](i)},p:it,i:it,o:it,d(a){a&&x(i),g[1](null)}}}function le(g,i,a){let l;ot(g,Lt,e=>a(3,l=e));let f,h,r=new Map,t=e=>{if(h)if(h.clear(),e.starts&&e.starts.length>0){if(console.log("drawing"),l!==void 0){console.log("using cache"),h.import(l),Object.values(e.map).map(n=>{if(n.drawId!==void 0){let c=h.getNodeFromId(n.drawId);r.set(n.id,{x:c.pos_x,y:c.pos_y})}});return}let o=Math.max(...e.ends.map(n=>e.map[n].earlyCol));for(let n=1;n<o+1;n++){let c=Object.keys(e.map).filter(_=>e.map[_].earlyCol==n);c.sort((_,w)=>e.map[_].slack>e.map[w].slack);for(let _=0;_<c.length;_++){let w=c[_],p=e.map[w],d="normal",m="bg-darkBlue";p.slack===0&&(d="critical",m="bg-darkSteel"),Number(p.progress)>=100&&(m="bg-emerald");let y=`
						<div class="heading `+m+'">'+p.name+`</div>
						<table style="width:99.9%;">
							<tr><th class="text-left third">Start</th><th>Duration</th><th class="text-right third">Finish</th></tr>
							<tr><td>`+p.es+'</td><td class="text-center va-middle" rowspan=2>'+p.expected+'</td><td class="text-right">'+p.ef+`</td></tr>
							<tr><td>`+p.ls+'</td><td class="text-right">'+p.lf+`</td></tr>
						</table>
						<hr/>
						<table style="width:99.9%;">
							<tr><th class="text-left third">Min</th><th>Likely</th><th class="text-right third">Max</th></tr>
							<tr><td>`+p.min+'</td><td class="text-center">'+p.likely+'</td><td class="text-right">'+p.max+`</td></tr>
						</table>
					`,u=r.get(p.id);u===void 0&&(u={x:20+400*(n-1),y:20+200*_});let C=40,v={x:u.x<0?-1:1,y:u.y<0?-1:1};u.x+=C/2*v.x,u.x-=Math.abs(u.x)%C*v.x,u.y+=C/2*v.y,u.y-=Math.abs(u.y)%C*v.y;let b=h.addNode(p.name,1,1,u.x,u.y,d,e.map[w],y);r.set(p.id,u),e.map[w].drawId=b,e.map[w].predecessors.map(L=>{let z=e.map[L].drawId;if(h.addConnection(z,b,"output_1","input_1"),e.map[L].slack===0&&e.map[w].slack===0){let R=document.getElementsByClassName("connection node_in_node-"+b+" node_out_node-"+z);R.length>0&&R[0].classList.add("critical")}})}}console.log("exporting to cache"),Ct(Lt,l=h.export(),l)}else console.log("dont draw yet")};Xt(()=>{h=new ie(f),h.draggable_inputs=!1,h.zoom_min=.2,h.start(),Ut.subscribe(e=>{setTimeout(()=>t(e),100)}),Qt.subscribe(e=>{e>0?h.zoom_in():e<0&&h.zoom_out()}),h.on("nodeMoved",function(e){Ct(Lt,l=h.export(),l);let o=h.getNodeFromId(e);r.set(o.data.id,{x:o.pos_x,y:o.pos_y})})});function s(e){Yt[e?"unshift":"push"](()=>{f=e,a(0,f)})}return[f,s]}class ae extends Et{constructor(i){super(),xt(this,i,le,oe,bt,{})}}function Nt(g,i,a){const l=g.slice();return l[9]=i[a],l[10]=i,l[11]=a,l}function kt(g,i,a){const l=g.slice();return l[12]=i[a],l}function It(g,i,a){const l=g.slice();return l[9]=i[a],l[15]=i,l[16]=a,l}function At(g,i,a){const l=g.slice();return l[17]=i[a],l}function Mt(g){let i,a=g[17]+"",l;return{c(){i=S("th"),l=ct(a)},l(f){i=B(f,"TH",{});var h=I(i);l=dt(h,a),h.forEach(x)},m(f,h){X(f,i,h),E(i,l)},p(f,h){h&4&&a!==(a=f[17]+"")&&ht(l,a)},d(f){f&&x(i)}}}function Ht(g){let i,a,l,f;function h(){g[7].call(a,g[15],g[16])}return{c(){i=S("td"),a=S("input"),this.h()},l(r){i=B(r,"TD",{class:!0});var t=I(i);a=B(t,"INPUT",{type:!0,class:!0}),t.forEach(x),this.h()},h(){k(a,"type","text"),k(a,"class","metro-input svelte-1jpgd8u"),k(i,"class","svelte-1jpgd8u")},m(r,t){X(r,i,t),E(i,a),pt(a,g[9]),l||(f=[at(a,"input",h),at(a,"paste",g[4])],l=!0)},p(r,t){g=r,t&4&&a.value!==g[9]&&pt(a,g[9])},d(r){r&&x(i),l=!1,St(f)}}}function zt(g){let i,a,l='<span class="mif-cross-light"></span>',f,h=Q(g[2].getRow(g[12])),r=[];for(let t=0;t<h.length;t+=1)r[t]=Ht(It(g,h,t));return{c(){i=S("tr"),a=S("td"),a.innerHTML=l,f=V();for(let t=0;t<r.length;t+=1)r[t].c();this.h()},l(t){i=B(t,"TR",{});var s=I(i);a=B(s,"TD",{class:!0,"data-svelte-h":!0}),ut(a)!=="svelte-1fn4jfg"&&(a.innerHTML=l),f=P(s);for(let e=0;e<r.length;e+=1)r[e].l(s);s.forEach(x),this.h()},h(){k(a,"class","svelte-1jpgd8u")},m(t,s){X(t,i,s),E(i,a),E(i,f);for(let e=0;e<r.length;e+=1)r[e]&&r[e].m(i,null)},p(t,s){if(s&20){h=Q(t[2].getRow(t[12]));let e;for(e=0;e<h.length;e+=1){const o=It(t,h,e);r[e]?r[e].p(o,s):(r[e]=Ht(o),r[e].c(),r[e].m(i,null))}for(;e<r.length;e+=1)r[e].d(1);r.length=h.length}},d(t){t&&x(i),rt(r,t)}}}function Tt(g){let i,a,l,f;function h(){g[8].call(a,g[10],g[11])}return{c(){i=S("td"),a=S("input"),this.h()},l(r){i=B(r,"TD",{class:!0});var t=I(i);a=B(t,"INPUT",{type:!0,class:!0}),t.forEach(x),this.h()},h(){k(a,"type","text"),k(a,"class","metro-input svelte-1jpgd8u"),k(i,"class","svelte-1jpgd8u")},m(r,t){X(r,i,t),E(i,a),pt(a,g[9]),l||(f=[at(a,"input",h),at(a,"paste",g[4]),at(a,"blur",g[5])],l=!0)},p(r,t){g=r,t&2&&a.value!==g[9]&&pt(a,g[9])},d(r){r&&x(i),l=!1,St(f)}}}function re(g){let i,a,l,f,h,r,t,s,e,o,n='<span class="mif-chevron-thin-right"></span>',c,_=Q(g[2].getHeader()),w=[];for(let u=0;u<_.length;u+=1)w[u]=Mt(At(g,_,u));let p=Q(g[2].getAllIds()),d=[];for(let u=0;u<p.length;u+=1)d[u]=zt(kt(g,p,u));let m=Q(g[1]),y=[];for(let u=0;u<m.length;u+=1)y[u]=Tt(Nt(g,m,u));return{c(){i=S("table"),a=S("thead"),l=S("tr"),f=S("th"),h=V();for(let u=0;u<w.length;u+=1)w[u].c();r=V(),t=S("tbody");for(let u=0;u<d.length;u+=1)d[u].c();s=V(),e=S("tr"),o=S("td"),o.innerHTML=n,c=V();for(let u=0;u<y.length;u+=1)y[u].c();this.h()},l(u){i=B(u,"TABLE",{class:!0});var C=I(i);a=B(C,"THEAD",{});var v=I(a);l=B(v,"TR",{});var b=I(l);f=B(b,"TH",{}),I(f).forEach(x),h=P(b);for(let R=0;R<w.length;R+=1)w[R].l(b);b.forEach(x),v.forEach(x),r=P(C),t=B(C,"TBODY",{});var L=I(t);for(let R=0;R<d.length;R+=1)d[R].l(L);s=P(L),e=B(L,"TR",{});var z=I(e);o=B(z,"TD",{class:!0,"data-svelte-h":!0}),ut(o)!=="svelte-qk2oid"&&(o.innerHTML=n),c=P(z);for(let R=0;R<y.length;R+=1)y[R].l(z);z.forEach(x),L.forEach(x),C.forEach(x),this.h()},h(){k(o,"class","svelte-1jpgd8u"),k(i,"class","table subcompact table-border cell-border striped")},m(u,C){X(u,i,C),E(i,a),E(a,l),E(l,f),E(l,h);for(let v=0;v<w.length;v+=1)w[v]&&w[v].m(l,null);E(i,r),E(i,t);for(let v=0;v<d.length;v+=1)d[v]&&d[v].m(t,null);E(t,s),E(t,e),E(e,o),E(e,c);for(let v=0;v<y.length;v+=1)y[v]&&y[v].m(e,null)},p(u,[C]){if(C&4){_=Q(u[2].getHeader());let v;for(v=0;v<_.length;v+=1){const b=At(u,_,v);w[v]?w[v].p(b,C):(w[v]=Mt(b),w[v].c(),w[v].m(l,null))}for(;v<w.length;v+=1)w[v].d(1);w.length=_.length}if(C&20){p=Q(u[2].getAllIds());let v;for(v=0;v<p.length;v+=1){const b=kt(u,p,v);d[v]?d[v].p(b,C):(d[v]=zt(b),d[v].c(),d[v].m(t,s))}for(;v<d.length;v+=1)d[v].d(1);d.length=p.length}if(C&50){m=Q(u[1]);let v;for(v=0;v<m.length;v+=1){const b=Nt(u,m,v);y[v]?y[v].p(b,C):(y[v]=Tt(b),y[v].c(),y[v].m(e,null))}for(;v<y.length;v+=1)y[v].d(1);y.length=m.length}},i:it,o:it,d(u){u&&x(i),rt(w,u),rt(d,u),rt(y,u)}}}function ce(g,i,a){let l,f,{name:h}=i,r=Rt(h);ot(g,r,c=>a(2,f=c));let t=te(Array(f.getHeader().length).fill(""));ot(g,t,c=>a(1,l=c)),t.reset=()=>t.update(c=>Array(f.getHeader().length).fill(""));function s(c){c.preventDefault();let w=(c.clipboardData||window.clipboardData).getData("text").split(/\n|\r/).filter(p=>p.length).map(p=>p.split(/\t/));r.update(p=>{let d=new Zt(w[0]);return w.slice(1).forEach(m=>{d.add_or_replace_row(m[0],m)}),d}),t.reset()}function e(){if(l.join("")===""){console.log("empty buffer, skipping");return}r.update(c=>(c.add_or_replace_row(l[0],l),c)),t.reset()}function o(c,_){c[_]=this.value}function n(c,_){c[_]=this.value,t.set(l)}return g.$$set=c=>{"name"in c&&a(6,h=c.name)},[t,l,f,r,s,e,h,o,n]}class jt extends Et{constructor(i){super(),xt(this,i,ce,re,bt,{name:6})}}function qt(g,i,a){const l=g.slice();return l[6]=i[a],l[7]=i,l[8]=a,l}function Dt(g,i,a){const l=g.slice();l[9]=i[a];const f=pe(l[9]);return l[10]=f,l}function Ot(g){let i,a,l,f,h,r,t,s,e=g[6].isEditing?"Save":"Edit",o,n,c,_='<span class="mif-bin"></span>',w,p,d,m,y;function u(R,N){if(R[6].isEditing)return he;if(R[6].content)return de}let C=u(g),v=C&&C(g),b=g[6].tool_calls&&g[6].tool_calls.length>0&&Wt(g);function L(){return g[4](g[8])}function z(){return g[5](g[8])}return{c(){i=S("div"),a=S("div"),v&&v.c(),l=V(),b&&b.c(),f=V(),h=S("div"),r=S("button"),t=S("span"),s=V(),o=ct(e),n=V(),c=S("button"),c.innerHTML=_,p=V(),this.h()},l(R){i=B(R,"DIV",{class:!0});var N=I(i);a=B(N,"DIV",{class:!0});var $=I(a);v&&v.l($),l=P($),b&&b.l($),f=P($),h=B($,"DIV",{class:!0});var G=I(h);r=B(G,"BUTTON",{class:!0});var Y=I(r);t=B(Y,"SPAN",{class:!0}),I(t).forEach(x),s=P(Y),o=dt(Y,e),Y.forEach(x),n=P(G),c=B(G,"BUTTON",{class:!0,"data-svelte-h":!0}),ut(c)!=="svelte-vji6vz"&&(c.innerHTML=_),G.forEach(x),$.forEach(x),p=P(N),N.forEach(x),this.h()},h(){k(t,"class","mif-pencil"),k(r,"class","button small"),k(c,"class","button small alert"),k(h,"class","message-actions svelte-om5vl5"),k(a,"class",w="message-content "+(g[6].role==="user"?"bg-darkBlue fg-white":"bg-lightGray")+" svelte-om5vl5"),k(i,"class",d="message "+g[6].role+" svelte-om5vl5")},m(R,N){X(R,i,N),E(i,a),v&&v.m(a,null),E(a,l),b&&b.m(a,null),E(a,f),E(a,h),E(h,r),E(r,t),E(r,s),E(r,o),E(h,n),E(h,c),E(i,p),m||(y=[at(r,"click",L),at(c,"click",z)],m=!0)},p(R,N){g=R,C===(C=u(g))&&v?v.p(g,N):(v&&v.d(1),v=C&&C(g),v&&(v.c(),v.m(a,l))),g[6].tool_calls&&g[6].tool_calls.length>0?b?b.p(g,N):(b=Wt(g),b.c(),b.m(a,f)):b&&(b.d(1),b=null),N&1&&e!==(e=g[6].isEditing?"Save":"Edit")&&ht(o,e),N&1&&w!==(w="message-content "+(g[6].role==="user"?"bg-darkBlue fg-white":"bg-lightGray")+" svelte-om5vl5")&&k(a,"class",w),N&1&&d!==(d="message "+g[6].role+" svelte-om5vl5")&&k(i,"class",d)},d(R){R&&x(i),v&&v.d(),b&&b.d(),m=!1,St(y)}}}function de(g){let i,a=g[6].content+"",l;return{c(){i=S("div"),l=ct(a)},l(f){i=B(f,"DIV",{});var h=I(i);l=dt(h,a),h.forEach(x)},m(f,h){X(f,i,h),E(i,l)},p(f,h){h&1&&a!==(a=f[6].content+"")&&ht(l,a)},d(f){f&&x(i)}}}function he(g){let i,a,l;function f(){g[3].call(i,g[7],g[8])}return{c(){i=S("textarea"),this.h()},l(h){i=B(h,"TEXTAREA",{"data-role":!0,class:!0}),I(i).forEach(x),this.h()},h(){k(i,"data-role","textarea"),k(i,"class","w-100")},m(h,r){X(h,i,r),pt(i,g[6].content),a||(l=at(i,"input",f),a=!0)},p(h,r){g=h,r&1&&pt(i,g[6].content)},d(h){h&&x(i),a=!1,l()}}}function Wt(g){let i,a,l="Tool Calls:",f,h=Q(g[6].tool_calls),r=[];for(let t=0;t<h.length;t+=1)r[t]=$t(Dt(g,h,t));return{c(){i=S("div"),a=S("strong"),a.textContent=l,f=V();for(let t=0;t<r.length;t+=1)r[t].c();this.h()},l(t){i=B(t,"DIV",{class:!0});var s=I(i);a=B(s,"STRONG",{"data-svelte-h":!0}),ut(a)!=="svelte-lg2hf7"&&(a.textContent=l),f=P(s);for(let e=0;e<r.length;e+=1)r[e].l(s);s.forEach(x),this.h()},h(){k(i,"class","tool-usage svelte-om5vl5")},m(t,s){X(t,i,s),E(i,a),E(i,f);for(let e=0;e<r.length;e+=1)r[e]&&r[e].m(i,null)},p(t,s){if(s&1){h=Q(t[6].tool_calls);let e;for(e=0;e<h.length;e+=1){const o=Dt(t,h,e);r[e]?r[e].p(o,s):(r[e]=$t(o),r[e].c(),r[e].m(i,null))}for(;e<r.length;e+=1)r[e].d(1);r.length=h.length}},d(t){t&&x(i),rt(r,t)}}}function $t(g){let i,a,l=g[10].name+"",f,h,r,t=g[10].args+"",s,e;return{c(){i=S("div"),a=S("span"),f=ct(l),h=V(),r=S("div"),s=ct(t),e=V(),this.h()},l(o){i=B(o,"DIV",{class:!0});var n=I(i);a=B(n,"SPAN",{class:!0});var c=I(a);f=dt(c,l),c.forEach(x),h=P(n),r=B(n,"DIV",{class:!0});var _=I(r);s=dt(_,t),_.forEach(x),e=P(n),n.forEach(x),this.h()},h(){k(a,"class","tool-name svelte-om5vl5"),k(r,"class","tool-args"),k(i,"class","tool-call svelte-om5vl5")},m(o,n){X(o,i,n),E(i,a),E(a,f),E(i,h),E(i,r),E(r,s),E(i,e)},p(o,n){n&1&&l!==(l=o[10].name+"")&&ht(f,l),n&1&&t!==(t=o[10].args+"")&&ht(s,t)},d(o){o&&x(i)}}}function Ft(g){let i,a=g[6].role!=="developer"&&g[6].role!=="tool"&&Ot(g);return{c(){a&&a.c(),i=Bt()},l(l){a&&a.l(l),i=Bt()},m(l,f){a&&a.m(l,f),X(l,i,f)},p(l,f){l[6].role!=="developer"&&l[6].role!=="tool"?a?a.p(l,f):(a=Ot(l),a.c(),a.m(i.parentNode,i)):a&&(a.d(1),a=null)},d(l){l&&x(i),a&&a.d(l)}}}function ue(g){let i,a=Q(g[0]),l=[];for(let f=0;f<a.length;f+=1)l[f]=Ft(qt(g,a,f));return{c(){i=S("div");for(let f=0;f<l.length;f+=1)l[f].c();this.h()},l(f){i=B(f,"DIV",{class:!0});var h=I(i);for(let r=0;r<l.length;r+=1)l[r].l(h);h.forEach(x),this.h()},h(){k(i,"class","chat-container svelte-om5vl5")},m(f,h){X(f,i,h);for(let r=0;r<l.length;r+=1)l[r]&&l[r].m(i,null)},p(f,[h]){if(h&7){a=Q(f[0]);let r;for(r=0;r<a.length;r+=1){const t=qt(f,a,r);l[r]?l[r].p(t,h):(l[r]=Ft(t),l[r].c(),l[r].m(i,null))}for(;r<l.length;r+=1)l[r].d(1);l.length=a.length}},i:it,o:it,d(f){f&&x(i),rt(l,f)}}}function pe(g){if(!g.function)return"";const i=JSON.parse(g.function.arguments||"{}");return{name:g.function.name,args:JSON.stringify(i,null,2)}}function fe(g,i,a){let l;ot(g,yt,e=>a(0,l=e));function f(e){Ct(yt,l=l.filter((o,n)=>n!==e),l)}function h(e){Ct(yt,l[e].isEditing=!l[e].isEditing,l),Ct(yt,l=[...l],l)}function r(e,o){e[o].content=this.value,yt.set(l)}return[l,f,h,r,e=>h(e),e=>f(e)]}class _e extends Et{constructor(i){super(),xt(this,i,fe,ue,bt,{})}}function Vt(g,i,a){const l=g.slice();return l[9]=i[a],l}function ge(g){let i,a=`<span class="mif-checkmark fg-green mr-2"></span>
                No suggestions at this time - your project planning looks good!`;return{c(){i=S("div"),i.innerHTML=a,this.h()},l(l){i=B(l,"DIV",{class:!0,"data-svelte-h":!0}),ut(i)!=="svelte-8agedn"&&(i.innerHTML=a),this.h()},h(){k(i,"class","text-muted")},m(l,f){X(l,i,f)},p:it,d(l){l&&x(i)}}}function me(g){let i,a=Q(g[0]),l=[];for(let f=0;f<a.length;f+=1)l[f]=Pt(Vt(g,a,f));return{c(){i=S("ul");for(let f=0;f<l.length;f+=1)l[f].c();this.h()},l(f){i=B(f,"UL",{class:!0});var h=I(i);for(let r=0;r<l.length;r+=1)l[r].l(h);h.forEach(x),this.h()},h(){k(i,"class","mt-0 mb-0")},m(f,h){X(f,i,h);for(let r=0;r<l.length;r+=1)l[r]&&l[r].m(i,null)},p(f,h){if(h&1){a=Q(f[0]);let r;for(r=0;r<a.length;r+=1){const t=Vt(f,a,r);l[r]?l[r].p(t,h):(l[r]=Pt(t),l[r].c(),l[r].m(i,null))}for(;r<l.length;r+=1)l[r].d(1);l.length=a.length}},d(f){f&&x(i),rt(l,f)}}}function Pt(g){let i,a,l,f=g[9].text+"",h,r,t,s=new Date(g[9].timestamp).toLocaleString()+"",e,o;return{c(){i=S("li"),a=S("span"),l=V(),h=ct(f),r=V(),t=S("small"),e=ct(s),o=V(),this.h()},l(n){i=B(n,"LI",{class:!0});var c=I(i);a=B(c,"SPAN",{class:!0}),I(a).forEach(x),l=P(c),h=dt(c,f),r=P(c),t=B(c,"SMALL",{class:!0});var _=I(t);e=dt(_,s),_.forEach(x),o=P(c),c.forEach(x),this.h()},h(){k(a,"class","mif-lightbulb fg-amber mr-2"),k(t,"class","text-muted ml-2"),k(i,"class","mt-1")},m(n,c){X(n,i,c),E(i,a),E(i,l),E(i,h),E(i,r),E(i,t),E(t,e),E(i,o)},p(n,c){c&1&&f!==(f=n[9].text+"")&&ht(h,f),c&1&&s!==(s=new Date(n[9].timestamp).toLocaleString()+"")&&ht(e,s)},d(n){n&&x(i)}}}function ve(g){let i,a,l="AI Suggestions",f,h;function r(e,o){return e[0].length>0?me:ge}let t=r(g),s=t(g);return{c(){i=S("div"),a=S("div"),a.textContent=l,f=V(),h=S("div"),s.c(),this.h()},l(e){i=B(e,"DIV",{class:!0});var o=I(i);a=B(o,"DIV",{class:!0,"data-svelte-h":!0}),ut(a)!=="svelte-r0c7jt"&&(a.textContent=l),f=P(o),h=B(o,"DIV",{class:!0});var n=I(h);s.l(n),n.forEach(x),o.forEach(x),this.h()},h(){k(a,"class","text-leader"),k(h,"class","border bd-default p-2 mt-2"),k(i,"class","p-2")},m(e,o){X(e,i,o),E(i,a),E(i,f),E(i,h),s.m(h,null)},p(e,[o]){t===(t=r(e))&&s?s.p(e,o):(s.d(1),s=t(e),s&&(s.c(),s.m(h,null)))},i:it,o:it,d(e){e&&x(i),s.d()}}}function we(g,i,a){let l,f,h,r,t;ot(g,Ut,n=>a(4,l=n)),ot(g,ne,n=>a(7,r=n)),ot(g,ee,n=>a(0,t=n));const s=Rt("tasks");ot(g,s,n=>a(6,h=n));const e=Rt("resources");ot(g,e,n=>a(5,f=n));function o(){const n=[],c=r;if(c!=null&&c.projectName||n.push("Define a project name in the Project Charter"),(!(c!=null&&c.startDate)||!(c!=null&&c.endDate))&&n.push("Set project start and end dates in the Project Charter"),!h||h.toJSON().length<=1)n.push("Start by adding some initial tasks to your project");else{const _=h.toJSON().slice(1);_.filter(d=>!d[6]).length>0&&n.push("Review tasks without dependencies to ensure proper sequencing"),_.filter(d=>!d[5]).length>0&&n.push("Assign resources to tasks that currently have none")}return(!f||f.toJSON().length<=1)&&n.push("Add resource availability information to enable proper resource planning"),l!=null&&l.length||n.push("Calculate the critical path to identify crucial project tasks"),n}return o(),[t,s,e]}class ye extends Et{constructor(i){super(),xt(this,i,we,ve,bt,{})}}function Ce(g){let i,a,l,f='<li><a href="#_target_1">Tasks</a></li> <li><a href="#_target_2">Resources</a></li> <li><a href="#_target_3">Instructions</a></li> <li><a href="#_target_4">Suggestions</a></li>',h,r,t,s,e,o,n,c,_,w,p,d,m,y,u,C,v;return s=new jt({props:{name:"tasks"}}),n=new jt({props:{name:"resources"}}),w=new _e({}),m=new ye({}),C=new ae({}),{c(){i=S("div"),a=S("div"),l=S("ul"),l.innerHTML=f,h=V(),r=S("div"),t=S("div"),ft(s.$$.fragment),e=V(),o=S("div"),ft(n.$$.fragment),c=V(),_=S("div"),ft(w.$$.fragment),p=V(),d=S("div"),ft(m.$$.fragment),y=V(),u=S("div"),ft(C.$$.fragment),this.h()},l(b){i=B(b,"DIV",{"data-role":!0,class:!0,"data-split-sizes":!0});var L=I(i);a=B(L,"DIV",{class:!0});var z=I(a);l=B(z,"UL",{"data-role":!0,"data-expand":!0,"data-svelte-h":!0}),ut(l)!=="svelte-13li787"&&(l.innerHTML=f),h=P(z),r=B(z,"DIV",{class:!0});var R=I(r);t=B(R,"DIV",{id:!0});var N=I(t);_t(s.$$.fragment,N),N.forEach(x),e=P(R),o=B(R,"DIV",{id:!0});var $=I(o);_t(n.$$.fragment,$),$.forEach(x),c=P(R),_=B(R,"DIV",{id:!0});var G=I(_);_t(w.$$.fragment,G),G.forEach(x),p=P(R),d=B(R,"DIV",{id:!0});var Y=I(d);_t(m.$$.fragment,Y),Y.forEach(x),R.forEach(x),z.forEach(x),y=P(L),u=B(L,"DIV",{class:!0});var nt=I(u);_t(C.$$.fragment,nt),nt.forEach(x),L.forEach(x),this.h()},h(){k(l,"data-role","tabs"),k(l,"data-expand","true"),k(t,"id","_target_1"),k(o,"id","_target_2"),k(_,"id","_target_3"),k(d,"id","_target_4"),k(r,"class","border bd-default no-border-top p-2 scrollable svelte-zgnndq"),k(a,"class",""),k(u,"class","d-flex flex-justify-center flex-align-center"),k(i,"data-role","splitter"),k(i,"class","h-100"),k(i,"data-split-sizes","30, 70")},m(b,L){X(b,i,L),E(i,a),E(a,l),E(a,h),E(a,r),E(r,t),gt(s,t,null),E(r,e),E(r,o),gt(n,o,null),E(r,c),E(r,_),gt(w,_,null),E(r,p),E(r,d),gt(m,d,null),E(i,y),E(i,u),gt(C,u,null),v=!0},p:it,i(b){v||(mt(s.$$.fragment,b),mt(n.$$.fragment,b),mt(w.$$.fragment,b),mt(m.$$.fragment,b),mt(C.$$.fragment,b),v=!0)},o(b){vt(s.$$.fragment,b),vt(n.$$.fragment,b),vt(w.$$.fragment,b),vt(m.$$.fragment,b),vt(C.$$.fragment,b),v=!1},d(b){b&&x(i),wt(s),wt(n),wt(w),wt(m),wt(C)}}}class Ie extends Et{constructor(i){super(),xt(this,i,null,Ce,bt,{})}}export{Ie as component};
